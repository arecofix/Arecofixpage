<div class="drawer lg:drawer-open">
  <input id="admin-drawer" type="checkbox" class="drawer-toggle" />

  <div class="drawer-content flex flex-col bg-base-200 min-h-screen text-base-content"
    [ngClass]="[(preferencesService.highContrast$ | async) ? 'high-contrast' : '']"
    [style.font-size.px]="(preferencesService.fontSize$ | async)">
    <!-- Navbar -->
    <div class="w-full navbar bg-base-100 border-b border-base-300 lg:hidden text-base-content">
      <div class="flex-none">
        <label for="admin-drawer" aria-label="open sidebar" class="btn btn-square btn-ghost text-base-content">
          <i class="fas fa-bars text-xl"></i>
        </label>
      </div>
      <div class="flex-1 px-2 mx-2 font-bold text-lg">Arecofix Admin</div>
    </div>

    <!-- Page Content -->
    <main class="flex-1 p-6 overflow-y-auto">
      <router-outlet></router-outlet>
    </main>
  </div>

  <!-- Sidebar -->
  <div class="drawer-side z-20">
    <label for="admin-drawer" aria-label="close sidebar" class="drawer-overlay"></label>
    <ul class="menu p-4 w-64 min-h-full bg-gray-900 text-green-400 gap-2">
      <!-- Logo -->
      <li class="mb-6">
        <a class="flex items-center gap-3 px-2 hover:bg-transparent cursor-pointer" [routerLink]="['/']">
          <img src="assets/img/brands/logo/logo-normal.PNG" alt="Arecofix Logo" class="h-8 w-auto" height="32" />
          <span class="text-xl font-bold text-white">Arecofix</span>
        </a>
      </li>
      <!-- Menu Items -->
      @for (item of menuItems; track item.path) {
      <li>
        @if (item.children) {
        <div class="flex items-center gap-1">
          <a [routerLink]="item.path" routerLinkActive="bg-green-800 text-white"
            class="flex-1 flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-800 hover:text-green-300 transition-colors">
            <i class="fas {{item.icon}} w-5 text-center"></i>
            <span class="font-medium">{{item.title}}</span>
          </a>
          <button (click)="toggleMenu(item)"
            class="px-3 py-3 rounded-lg hover:bg-gray-800 transition-colors text-green-400 hover:text-green-300">
            <i class="fas fa-chevron-down transition-transform duration-200" [class.rotate-180]="item.expanded"></i>
          </button>
        </div>

        @if (item.expanded) {
        <ul class="pl-4 mt-1 space-y-1 border-l border-gray-700 ml-6">
          @for (child of item.children; track child.path) {
          <li>
            <a [routerLink]="child.path" routerLinkActive="text-green-300 font-bold"
              class="flex items-center gap-3 px-4 py-2 rounded-lg hover:bg-gray-800 transition-colors text-sm text-green-500 hover:text-green-300">
              <i class="fas {{child.icon}} w-4 text-center"></i>
              <span>{{child.title}}</span>
            </a>
          </li>
          }
        </ul>
        }
        } @else {
        <a [routerLink]="item.path" routerLinkActive="bg-green-800 text-white"
          class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-800 hover:text-green-300 transition-colors">
          <i class="fas {{item.icon}} w-5 text-center"></i>
          <span class="font-medium">{{item.title}}</span>
        </a>
        }
      </li>
      }

      <div class="divider divider-neutral my-4"></div>

      <!-- User & Logout -->
      <li>
        <a routerLink="/perfil" class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-gray-800 hover:text-green-300">
          <i class="fas fa-user-circle w-5 text-center"></i>
          <span>Mi Perfil</span>
        </a>
      </li>
      <li>
        <button (click)="logout()"
          class="flex items-center gap-3 px-4 py-3 rounded-lg hover:bg-red-900/30 text-red-400 hover:text-red-300">
          <i class="fas fa-sign-out-alt w-5 text-center"></i>
          <span>Cerrar Sesi√≥n</span>
        </button>
      </li>
    </ul>
  </div>
</div>

<app-accessibility-sidebar></app-accessibility-sidebar>