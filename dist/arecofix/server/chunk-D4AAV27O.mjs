import './polyfills.server.mjs';
import{a as d}from"./chunk-H4CPJVNC.mjs";import{e as D}from"./chunk-BDXJUVVV.mjs";import"./chunk-RBOCUYI6.mjs";import"./chunk-6FAII6YG.mjs";import"./chunk-C5GT56EO.mjs";import{m as w,n as A,r as I}from"./chunk-R44Y3TM4.mjs";import{$b as S,Bb as v,Cb as h,Hb as i,Ib as t,Jb as l,Lb as b,Qb as _,Ra as u,W as f,Wa as r,Xb as U,Zb as o,_b as c,ac as P,ib as E,ma as m,pc as p,qc as C,rc as y,xb as g,yb as x}from"./chunk-CUO5BU3F.mjs";import"./chunk-N7QBYMCK.mjs";var R=(a,n)=>n.id;function T(a,n){a&1&&(i(0,"tr")(1,"td",6),o(2,"Cargando..."),t()())}function O(a,n){a&1&&(i(0,"tr")(1,"td",6),o(2,"No hay usuarios registrados."),t()())}function k(a,n){if(a&1&&(i(0,"tr")(1,"td")(2,"div",7)(3,"div",8)(4,"div",9),l(5,"img",10),t()(),i(6,"div")(7,"div",11),o(8),t(),i(9,"div",12),o(10),t()()()(),i(11,"td")(12,"div",13),o(13),p(14,"uppercase"),t()(),i(15,"td"),o(16),p(17,"date"),t(),l(18,"td"),t()),a&2){let e=n.$implicit;r(5),b("src",e.avatar_url||"https://ui-avatars.com/api/?name="+e.first_name+"+"+e.last_name,u),r(3),P("",e.first_name," ",e.last_name),r(2),c(e.email),r(2),U("badge-primary",e.role==="admin")("badge-secondary",e.role==="staff")("badge-ghost",e.role==="user"),r(),S(" ",C(14,12,e.role)," "),r(3),c(y(17,14,e.created_at,"short"))}}function F(a,n){if(a&1&&v(0,k,19,17,"tr",null,R),a&2){let e=_();h(e.users())}}var M=class a{auth=f(D);users=m([]);loading=m(!0);async ngOnInit(){await this.loadUsers()}async loadUsers(){this.loading.set(!0);let n=this.auth.getSupabaseClient(),{data:e,error:s}=await n.from("profiles").select("*").order("created_at",{ascending:!1});!s&&e&&this.users.set(e),this.loading.set(!1)}async toggleRole(n){let e=n.role===d.ADMIN?d.USER:d.ADMIN,s=this.auth.getSupabaseClient(),{error:N}=await s.from("profiles").update({role:e}).eq("id",n.id);N||await this.loadUsers()}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=E({type:a,selectors:[["app-admin-users-page"]],decls:20,vars:1,consts:[[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-green-600"],[1,"bg-base-100","rounded-lg","shadow","overflow-hidden","text-base-content"],[1,"overflow-x-auto"],[1,"table","w-full"],[1,"text-base-content"],["colspan","4",1,"text-center","py-4"],[1,"flex","items-center","gap-3"],[1,"avatar"],[1,"mask","mask-squircle","w-12","h-12"],["alt","Avatar",3,"src"],[1,"font-bold"],[1,"text-sm","opacity-50"],[1,"badge"]],template:function(e,s){e&1&&(i(0,"div",0)(1,"h1",1),o(2,"Usuarios"),t()(),i(3,"div",2)(4,"div",3)(5,"table",4)(6,"thead")(7,"tr",5)(8,"th"),o(9,"Usuario"),t(),i(10,"th"),o(11,"Rol"),t(),i(12,"th"),o(13,"Fecha Registro"),t(),i(14,"th"),o(15,"Acciones"),t()()(),i(16,"tbody"),g(17,T,3,0,"tr")(18,O,3,0,"tr")(19,F,2,0),t()()()()),e&2&&(r(17),x(s.loading()?17:s.users().length===0?18:19))},dependencies:[I,w,A],encapsulation:2})};export{M as AdminUsersPage};
