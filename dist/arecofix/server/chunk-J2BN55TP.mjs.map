{
  "version": 3,
  "sources": ["src/app/core/services/contact.service.ts"],
  "sourcesContent": ["import { Injectable, inject } from '@angular/core';\r\nimport { AuthService } from './auth.service';\r\nimport { SupabaseClient, PostgrestError } from '@supabase/supabase-js';\r\nimport { LoggerService } from './logger.service';\r\nimport { TenantService } from './tenant.service';\r\n\r\nexport interface CreateMessageDto {\r\n    name: string;\r\n    email: string;\r\n    phone?: string;\r\n    subject?: string;\r\n    message: string;\r\n}\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class ContactService {\r\n    private authService = inject(AuthService);\r\n    private logger = inject(LoggerService);\r\n    private tenantService = inject(TenantService);\r\n    private supabase: SupabaseClient;\r\n\r\n    constructor() {\r\n        this.supabase = this.authService.getSupabaseClient();\r\n    }\r\n\r\n    async createMessage(msg: CreateMessageDto): Promise<{ error: PostgrestError | null }> {\r\n        try {\r\n            const payload = { \r\n                name: msg.name,\r\n                email: msg.email,\r\n                phone: msg.phone || null,\r\n                subject: msg.subject || null,\r\n                message: msg.message,\r\n                is_read: false,\r\n                tenant_id: this.tenantService.getTenantId()\r\n            };\r\n\r\n            const { error } = await this.supabase\r\n                .from('contact_messages' as any)\r\n                .insert(payload);\r\n            \r\n            if (error) {\r\n                this.logger.error('Supabase ContactService Error:', error);\r\n            }\r\n\r\n            return { error };\r\n        } catch (e: unknown) {\r\n            this.logger.error('ContactService Exception:', e);\r\n            const errorMessage = e instanceof Error ? e.message : 'Unknown error';\r\n            \r\n            const pgError: PostgrestError = {\r\n                message: errorMessage,\r\n                details: '',\r\n                hint: '',\r\n                code: 'UNKNOWN',\r\n                name: 'PostgrestError'\r\n            };\r\n            return { error: pgError };\r\n        }\r\n    }\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;AAiBM,IAAO,iBAAP,MAAO,gBAAc;EACf,cAAc,OAAO,WAAW;EAChC,SAAS,OAAO,aAAa;EAC7B,gBAAgB,OAAO,aAAa;EACpC;EAER,cAAA;AACI,SAAK,WAAW,KAAK,YAAY,kBAAiB;EACtD;EAEA,MAAM,cAAc,KAAqB;AACrC,QAAI;AACA,YAAM,UAAU;QACZ,MAAM,IAAI;QACV,OAAO,IAAI;QACX,OAAO,IAAI,SAAS;QACpB,SAAS,IAAI,WAAW;QACxB,SAAS,IAAI;QACb,SAAS;QACT,WAAW,KAAK,cAAc,YAAW;;AAG7C,YAAM,EAAE,MAAK,IAAK,MAAM,KAAK,SACxB,KAAK,kBAAyB,EAC9B,OAAO,OAAO;AAEnB,UAAI,OAAO;AACP,aAAK,OAAO,MAAM,kCAAkC,KAAK;MAC7D;AAEA,aAAO,EAAE,MAAK;IAClB,SAAS,GAAY;AACjB,WAAK,OAAO,MAAM,6BAA6B,CAAC;AAChD,YAAM,eAAe,aAAa,QAAQ,EAAE,UAAU;AAEtD,YAAM,UAA0B;QAC5B,SAAS;QACT,SAAS;QACT,MAAM;QACN,MAAM;QACN,MAAM;;AAEV,aAAO,EAAE,OAAO,QAAO;IAC3B;EACJ;;qCA5CS,iBAAc;EAAA;4EAAd,iBAAc,SAAd,gBAAc,WAAA,YAFX,OAAM,CAAA;;;sEAET,gBAAc,CAAA;UAH1B;WAAW;MACR,YAAY;KACf;;;",
  "names": []
}
