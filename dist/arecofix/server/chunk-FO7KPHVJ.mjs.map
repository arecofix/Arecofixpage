{
  "version": 3,
  "sources": ["src/app/admin/messages/admin-messages-page.ts", "src/app/admin/messages/admin-messages-page.html"],
  "sourcesContent": ["import { Component, inject, OnInit, signal } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { AuthService } from '@app/core/services/auth.service';\r\nimport { TenantService } from '@app/core/services/tenant.service';\r\nimport { Message } from '@app/features/customers/domain/entities/message.entity';\r\n\r\n@Component({\r\n  selector: 'app-admin-messages-page',\r\n  standalone: true,\r\n  imports: [CommonModule],\r\n  templateUrl: './admin-messages-page.html',\r\n})\r\nexport class AdminMessagesPage implements OnInit {\r\n  private auth = inject(AuthService);\r\n  private tenantService = inject(TenantService);\r\n  messages = signal<Message[]>([]);\r\n  loading = signal(true);\r\n\r\n  async ngOnInit() {\r\n    await this.loadMessages();\r\n  }\r\n\r\n  async loadMessages() {\r\n    this.loading.set(true);\r\n    const supabase = this.auth.getSupabaseClient();\r\n    const { data, error } = await supabase\r\n      .from('contact_messages')\r\n      .select('*')\r\n      .eq('tenant_id', this.tenantService.getTenantId())\r\n      .order('created_at', { ascending: false });\r\n\r\n    if (data) {\r\n      this.messages.set(data);\r\n    }\r\n    this.loading.set(false);\r\n  }\r\n\r\n  async markAsRead(id: string) {\r\n    const supabase = this.auth.getSupabaseClient();\r\n    const { error } = await supabase\r\n      .from('contact_messages')\r\n      .update({ is_read: true })\r\n      .eq('id', id)\r\n      .eq('tenant_id', this.tenantService.getTenantId());\r\n\r\n    if (!error) {\r\n      this.messages.update(msgs =>\r\n        msgs.map(m => m.id === id ? { ...m, is_read: true } : m)\r\n      );\r\n    }\r\n  }\r\n\r\n  async deleteMessage(id: string) {\r\n    if (!confirm('¿Estás seguro de eliminar este mensaje?')) return;\r\n\r\n    const supabase = this.auth.getSupabaseClient();\r\n    const { error } = await supabase.from('contact_messages')\r\n      .delete()\r\n      .eq('id', id)\r\n      .eq('tenant_id', this.tenantService.getTenantId());\r\n\r\n    if (!error) {\r\n      this.messages.update(msgs => msgs.filter(m => m.id !== id));\r\n    } else {\r\n      alert('Error al eliminar el mensaje');\r\n    }\r\n  }\r\n}\r\n", "<div class=\"flex justify-between items-center mb-6\">\r\n    <h1 class=\"text-2xl font-bold text-green-600\">Mensajes de Contacto</h1>\r\n</div>\r\n\r\n<div class=\"grid gap-4\">\r\n    @if (loading()) {\r\n    <div class=\"flex justify-center py-8\">\r\n        <span class=\"loading loading-spinner loading-lg\"></span>\r\n    </div>\r\n    } @else if (messages().length === 0) {\r\n    <div class=\"alert alert-info\">\r\n        <i class=\"fas fa-info-circle\"></i>\r\n        <span>No hay mensajes nuevos.</span>\r\n    </div>\r\n    } @else {\r\n    @for (msg of messages(); track msg.id) {\r\n    <div class=\"card bg-base-100 shadow hover:shadow-md transition-shadow text-base-content\" [class.border-l-4]=\"!msg.is_read\"\r\n        [class.border-primary]=\"!msg.is_read\">\r\n        <div class=\"card-body p-6\">\r\n            <div class=\"flex justify-between items-start gap-4\">\r\n                <div class=\"flex-1\">\r\n                    <div class=\"flex items-center gap-2 mb-2\">\r\n                        <h3 class=\"font-bold text-lg\">{{ msg.name }}</h3>\r\n                        @if (!msg.is_read) {\r\n                        <span class=\"badge badge-primary badge-sm\">Nuevo</span>\r\n                        }\r\n                        <span class=\"text-sm text-gray-500\">{{ msg.created_at | date:'medium' }}</span>\r\n                    </div>\r\n\r\n                    <div class=\"text-sm text-gray-600 mb-2\">\r\n                        <div class=\"flex items-center gap-4\">\r\n                            <span><i class=\"fas fa-envelope mr-1\"></i> {{ msg.email }}</span>\r\n                            @if (msg.phone) {\r\n                            <span><i class=\"fas fa-phone mr-1\"></i> {{ msg.phone }}</span>\r\n                            }\r\n                        </div>\r\n                    </div>\r\n\r\n                    @if (msg.subject) {\r\n                    <div class=\"font-medium mb-2\">Asunto: {{ msg.subject }}</div>\r\n                    }\r\n\r\n                    <p class=\"text-gray-700 whitespace-pre-wrap\">{{ msg.message }}</p>\r\n                </div>\r\n\r\n                <div class=\"flex flex-col gap-2\">\r\n                    @if (!msg.is_read) {\r\n                    <button class=\"btn btn-sm btn-ghost\" (click)=\"markAsRead(msg.id)\" title=\"Marcar como leído\">\r\n                        <i class=\"fas fa-check text-success\"></i>\r\n                    </button>\r\n                    }\r\n                    <button class=\"btn btn-sm btn-ghost text-error\" (click)=\"deleteMessage(msg.id)\" title=\"Eliminar\">\r\n                        <i class=\"fas fa-trash\"></i>\r\n                    </button>\r\n                    <a [href]=\"'mailto:' + msg.email\" class=\"btn btn-sm btn-ghost text-info\" title=\"Responder\">\r\n                        <i class=\"fas fa-reply\"></i>\r\n                    </a>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    }\r\n    }\r\n</div>"],
  "mappings": "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",
  "names": []
}
