import './polyfills.server.mjs';
import{a as xe}from"./chunk-B5QWZIKQ.mjs";import"./chunk-OEE6LMKQ.mjs";import{a as be}from"./chunk-EZI5MAXM.mjs";import"./chunk-UQOUTD4D.mjs";import{a as fe}from"./chunk-6BKKRG3G.mjs";import{a as pe}from"./chunk-R4D4S27B.mjs";import"./chunk-QIQJ6T5Y.mjs";import"./chunk-WUMV5ZNI.mjs";import{a as me}from"./chunk-A57L63GX.mjs";import{b as ie,d as re,e as ne,f as ae,g as oe,h as le,i as ce,n as de,o as se,t as ue}from"./chunk-QBNUQKUT.mjs";import{a as ge}from"./chunk-OZCLNHZI.mjs";import{a as _e}from"./chunk-IZSWMJWO.mjs";import{b as ye}from"./chunk-AI6TUFYF.mjs";import{d as F}from"./chunk-3X5ZJVON.mjs";import"./chunk-WO5P5INO.mjs";import"./chunk-35OYAJOP.mjs";import"./chunk-HT57LKWA.mjs";import{p as Y,s as Z,t as ee,x as te}from"./chunk-BLYQXFN2.mjs";import{p as W,r as X}from"./chunk-VF3MFHMJ.mjs";import{$ as f,$b as S,Ab as U,Bb as P,C as O,Cb as w,Db as m,E as A,Eb as n,Fb as a,G as L,Gb as s,Kb as h,L as I,N as $,Ob as p,Qb as u,Ra as z,W as y,Wa as c,Xb as G,Zb as o,_b as v,aa as b,d as q,ib as H,kc as J,l as V,lc as K,ma as x,pc as T,qc as D,r as j,s as B,xb as g,yb as _,zc as R}from"./chunk-PUXVFRR7.mjs";import{d as Q}from"./chunk-DGJQU3KY.mjs";var Se=()=>[1,2,3,4,5,6],ke=i=>["/productos/categoria",i],ve=(i,t)=>t.id;function Ee(i,t){if(i&1&&(o(0," Mostrando "),n(1,"span",52),o(2),a(),o(3," resultados ")),i&2){let e,r=u();c(2),v((e=r.productsRs.value())==null?null:e.items)}}function Me(i,t){i&1&&o(0," Cargando cat\xE1logo... ")}function Ve(i,t){i&1&&s(0,"div",53)}function Be(i,t){i&1&&(n(0,"div",30),P(1,Ve,1,0,"div",53,U),a()),i&2&&(c(),w(J(0,Se)))}function Ie(i,t){if(i&1&&s(0,"is-error",31),i&2){let e,r=u();m("message",((e=r.productsRs.error())==null?null:e.message)||"Error al cargar categor\xEDa")}}function Te(i,t){if(i&1){let e=h();n(0,"div",54),s(1,"i",55),n(2,"h3",56),o(3,"Sin resultados en esta categor\xEDa"),a(),n(4,"button",57),p("click",function(){f(e);let l=u(2);return l.onSearch(""),l.minPriceInput.set(null),l.maxPriceInput.set(null),b(l.applyPriceFilter())}),o(5," Ver todos los productos "),a()()}}function De(i,t){if(i&1){let e=h();n(0,"product-card",61),p("quickView",function(l){f(e);let d=u(3);return b(d.openQuickView(l))}),a()}if(i&2){let e=t.$implicit,r=t.$index;m("product",e)("isPriority",r<2)}}function Re(i,t){if(i&1&&(n(0,"div",60),s(1,"pagination",62),a()),i&2){let e=u(3);c(),m("pages",e.paginationData().pages)("currentPage",e.paginationService.currentPage())}}function Fe(i,t){if(i&1&&(n(0,"div",58),P(1,De,1,2,"product-card",59,ve),a(),g(3,Re,2,2,"div",60)),i&2){let e=u(2);c(),w(e.productsRs.value().data),c(2),_(e.paginationData()?3:-1)}}function Ne(i,t){if(i&1&&g(0,Te,6,0,"div",54)(1,Fe,4,1),i&2){let e,r=u();_(((e=r.productsRs.value())==null?null:e.items)===0?0:1)}}function Qe(i,t){if(i&1&&(n(0,"li")(1,"a",63),o(2),a()()),i&2){let e,r=t.$implicit,l=u(2);c(),G("active",((e=l.currentCategory())==null?null:e.id)===r.id),m("routerLink",K(4,ke,r.slug)),c(),S(" ",r.name," ")}}function qe(i,t){if(i&1&&P(0,Qe,3,6,"li",null,ve),i&2){let e=u();w(e.categoriesListRs.value().data)}}function je(i,t){i&1&&(n(0,"span",71),o(1,"Sin Stock"),a())}function Oe(i,t){if(i&1&&(n(0,"span",77),o(1),T(2,"currency"),a()),i&2){let e=u();c(),v(D(2,1,e.regular_price))}}function Ae(i,t){if(i&1){let e=h();n(0,"div",66)(1,"div",69),s(2,"img",70),g(3,je,2,0,"span",71),a(),n(4,"div",72)(5,"div",73)(6,"h3",74),o(7),a(),n(8,"div",75)(9,"span",76),o(10),T(11,"currency"),a(),g(12,Oe,3,3,"span",77),a(),n(13,"p",78),o(14),a()(),n(15,"button",79),p("click",function(){let l=f(e),d=u(2);return b(d.addToCart(l))}),s(16,"i",80),o(17," Agregar al Carrito "),a()()()}if(i&2){let e=t;c(2),m("src",e.image_url||"assets/img/no-image.png",z)("alt",e.name),c(),_((e.stock??0)<=0?3:-1),c(4),v(e.name),c(3),v(D(11,7,e.price)),c(2),_(e.regular_price&&e.regular_price>e.price?12:-1),c(2),v(e.description||"Sin descripci\xF3n disponible.")}}function Le(i,t){if(i&1){let e=h();n(0,"div",51)(1,"div",64)(2,"button",65),p("click",function(){f(e);let l=u();return b(l.closeQuickView())}),o(3,"\u2715"),a(),g(4,Ae,18,9,"div",66),a(),n(5,"form",67)(6,"button",68),p("click",function(){f(e);let l=u();return b(l.closeQuickView())}),o(7,"close"),a()()()}if(i&2){let e,r=u();c(4),_((e=r.quickViewProduct())?4:-1,e)}}var N=class i{route=y(Y);router=y(Z);categoryService=y(xe);productService=y(fe);paginationService=y(ge);cartService=y(pe);currentCategory=x(null);minPriceInput=x(null);maxPriceInput=x(null);categoriesListRs=F({stream:()=>this.categoryService.getFeaturedData()});breadcrumbItems=R(()=>{let t=this.currentCategory(),e=[{label:"Inicio",url:"/"},{label:"Productos",url:"/productos"}];return t?e.push({label:t.name}):e.push({label:"Categor\xEDa"}),e});searchQuery=x("");searchSubject=new q;constructor(){this.searchSubject.pipe(A(400),L()).subscribe(t=>{this.updateQueryParams({q:t||null,_page:1})})}updateQueryParams(t){this.router.navigate([],{relativeTo:this.route,queryParams:t,queryParamsHandling:"merge"})}onSearch(t){this.searchQuery.set(t),this.searchSubject.next(t)}getAllDescendantIds(t,e){let r=[t],l=e.filter(d=>d.parent_id===t);for(let d of l)r=[...r,...this.getAllDescendantIds(d.id,e)];return[...new Set(r)]}productsRs=F({stream:()=>B([this.route.params.pipe(j(({categorySlug:t})=>t)),this.route.queryParams]).pipe(I(([t,e])=>B({categoryResponse:this.categoryService.getDataBySlug(t),allCategories:this.categoryService.getAll().pipe(O(()=>V([])))}).pipe($(({categoryResponse:r})=>{this.currentCategory.set(r.data?.[0]||null)}),I(({categoryResponse:r,allCategories:l})=>{let C=r.data?.[0]?.id;if(!C)return V({first:1,prev:null,next:null,last:1,pages:1,items:0,data:[]});let Ce=this.getAllDescendantIds(C,l),he=+e._page||1,Pe=e._sort,we=e._order,k=e.min_price?+e.min_price:void 0,E=e.max_price?+e.max_price:void 0,M=e.q||void 0;return this.searchQuery()!==(M||"")&&this.searchQuery.set(M||""),this.minPriceInput()===null&&k&&this.minPriceInput.set(k),this.maxPriceInput()===null&&E&&this.maxPriceInput.set(E),this.productService.getData({category_ids:Ce,_page:he,_sort:Pe,_order:we,min_price:k,max_price:E,q:M})}))))});paginationData=R(()=>{let t=this.productsRs.value();if(!t)return null;let l=t,{data:e}=l;return Q(l,["data"])});isMobileFiltersOpen=x(!1);isQuickViewOpen=x(!1);quickViewProduct=x(null);toggleMobileFilters(){this.isMobileFiltersOpen.update(t=>!t)}openQuickView(t){this.quickViewProduct.set(t),this.isQuickViewOpen.set(!0)}closeQuickView(){this.isQuickViewOpen.set(!1),this.quickViewProduct.set(null)}addToCart(t){this.cartService.addToCart(t),this.closeQuickView()}applyPriceFilter(){this.router.navigate([],{relativeTo:this.route,queryParams:{min_price:this.minPriceInput(),max_price:this.maxPriceInput(),_page:1},queryParamsHandling:"merge"}),this.isMobileFiltersOpen.set(!1)}setSort(t,e="asc"){this.router.navigate([],{relativeTo:this.route,queryParams:{_sort:t,_order:e,_page:1},queryParamsHandling:"merge"})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=H({type:i,selectors:[["products-by-category-page"]],decls:80,vars:12,consts:[[1,"drawer","lg:drawer-open"],["id","cat-filters-drawer","type","checkbox",1,"drawer-toggle"],[1,"drawer-content","flex","flex-col","min-h-screen","bg-gray-50","dark:bg-gray-900","transition-colors","duration-300"],[1,"relative","bg-gray-900","text-white","overflow-hidden","isolate"],[1,"absolute","inset-0","bg-linear-to-br","from-indigo-900","via-blue-950","to-slate-900","opacity-90","pointer-events-none"],[1,"absolute","-bottom-32","-left-32","w-96","h-96","bg-indigo-600","rounded-full","mix-blend-overlay","filter","blur-3xl","opacity-20","pointer-events-none"],[1,"absolute","top-0","right-0","w-64","h-64","bg-teal-500","rounded-full","mix-blend-overlay","filter","blur-3xl","opacity-10","pointer-events-none"],[1,"relative","container","mx-auto","px-4","py-8","lg:py-12","text-center"],[1,"flex","justify-center","mb-6"],["classes","justify-center !text-indigo-200","activeClasses","!text-white",3,"items"],[1,"text-4xl","md:text-5xl","font-black","mb-6","tracking-tight","animate-fade-in-up"],[1,"text-lg","md:text-xl","text-gray-300","max-w-2xl","mx-auto","mb-8","font-light"],[1,"flex-1","container","mx-auto","px-4","py-12"],[1,"flex","flex-col","sm:flex-row","justify-between","items-center","mb-8","pb-4","border-b","border-gray-200","dark:border-gray-800","gap-4"],[1,"w-full","sm:w-auto","flex","flex-col","sm:flex-row","items-start","sm:items-center","gap-4"],[1,"text-gray-600","dark:text-gray-400","font-medium","text-sm"],["for","cat-filters-drawer",1,"btn","btn-sm","btn-outline","rounded-full","w-full","sm:w-auto","lg:hidden"],[1,"fas","fa-sliders-h","mr-2"],[1,"flex","items-center","gap-3"],[1,"relative","hidden","md:block"],[1,"fas","fa-search","absolute","left-3","top-1/2","-translate-y-1/2","text-gray-400"],["type","text",1,"input","input-bordered","input-sm","rounded-full","pl-9","w-64","focus:ring-2","focus:ring-indigo-500","bg-white","dark:bg-gray-800",3,"input","defaultValue","placeholder"],[1,"select","select-bordered","select-sm","rounded-full","bg-white","dark:bg-gray-800","border-gray-300","dark:border-gray-700","min-w-[150px]",3,"change"],["value","created_at|desc"],["value","price|asc"],["value","price|desc"],[1,"md:hidden","mb-6"],[1,"relative"],["type","text","placeholder","Buscar en esta categor\xEDa...",1,"input","input-bordered","w-full","rounded-2xl","pl-10",3,"input","defaultValue"],[1,"min-h-[400px]"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-3","gap-6"],[3,"message"],[1,"drawer-side","z-40"],["for","cat-filters-drawer","aria-label","close sidebar",1,"drawer-overlay","backdrop-blur-sm"],[1,"menu","p-6","w-80","min-h-full","bg-white","dark:bg-gray-800","text-base-content","border-r","border-gray-200","dark:border-gray-700"],[1,"flex","justify-between","items-center","mb-8"],[1,"text-xl","font-bold","text-gray-900","dark:text-white"],["for","cat-filters-drawer",1,"btn","btn-sm","btn-circle","btn-ghost","cursor-pointer"],[1,"space-y-8"],[1,"font-bold","text-gray-900","dark:text-white","mb-4","flex","items-center","gap-2"],[1,"fas","fa-tag","text-indigo-500"],[1,"flex","flex-col","gap-3"],[1,"form-control","w-full"],[1,"label","text-xs","text-gray-500"],[1,"absolute","left-3","top-3","text-gray-400"],["type","number","placeholder","0",1,"input","input-bordered","w-full","pl-8","rounded-xl",3,"ngModelChange","ngModel"],["type","number","placeholder","Max",1,"input","input-bordered","w-full","pl-8","rounded-xl",3,"ngModelChange","ngModel"],[1,"btn","btn-primary","w-full","mt-2","rounded-xl",3,"click"],[1,"fas","fa-layer-group","text-indigo-500"],[1,"max-h-60","overflow-y-auto","custom-scrollbar"],[1,"space-y-1"],[1,"modal","modal-open","z-50","animate-fade-in"],[1,"text-gray-900","dark:text-white","font-bold"],[1,"animate-pulse","bg-gray-200","dark:bg-gray-800","rounded-3xl","h-[400px]","w-full"],[1,"text-center","py-20","bg-white","dark:bg-gray-800","rounded-3xl","shadow-sm","border","border-gray-100","dark:border-gray-700"],[1,"fas","fa-search","text-4xl","text-gray-300","mb-4"],[1,"font-bold","text-lg","text-gray-900","dark:text-white"],[1,"btn","btn-link","text-indigo-600",3,"click"],[1,"grid","grid-cols-2","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-3","gap-2","sm:gap-6"],[3,"product","isPriority"],[1,"mt-12","flex","justify-center"],[3,"quickView","product","isPriority"],[3,"pages","currentPage"],[1,"block","py-2","px-3","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-700","transition","text-sm",3,"routerLink"],[1,"modal-box","relative","max-w-4xl","bg-white","dark:bg-gray-800","rounded-3xl","p-0","overflow-hidden","shadow-2xl"],[1,"btn","btn-sm","btn-circle","btn-ghost","absolute","right-4","top-4","z-10","bg-white/50","backdrop-blur-md",3,"click"],[1,"flex","flex-col","md:flex-row","h-full"],["method","dialog",1,"modal-backdrop","bg-black/50","backdrop-blur-sm"],[3,"click"],[1,"w-full","md:w-1/2","bg-gray-50","dark:bg-gray-700/30","p-8","flex","items-center","justify-center","relative"],[1,"max-h-[300px]","object-contain","drop-shadow-xl",3,"src","alt"],[1,"absolute","top-8","left-8","badge","badge-error","text-white","font-bold","p-3"],[1,"w-full","md:w-1/2","p-8","flex","flex-col"],[1,"mb-auto"],[1,"font-black","text-2xl","md:text-3xl","mb-2","text-gray-900","dark:text-white","leading-tight"],[1,"flex","items-baseline","gap-3","mb-6"],[1,"text-4xl","font-bold","text-indigo-600","dark:text-indigo-400"],[1,"text-lg","text-gray-400","line-through"],[1,"text-gray-600","dark:text-gray-300","mb-6","leading-relaxed"],[1,"btn","btn-primary","btn-lg","w-full","rounded-2xl","shadow-xl","shadow-indigo-600/30","gap-3",3,"click"],[1,"fas","fa-shopping-cart"]],template:function(e,r){if(e&1&&(n(0,"div",0),s(1,"input",1),n(2,"div",2)(3,"header",3),s(4,"div",4)(5,"div",5)(6,"div",6),n(7,"div",7)(8,"div",8),s(9,"app-breadcrumbs",9),a(),n(10,"h1",10),o(11),a(),n(12,"p",11),o(13),a()()(),n(14,"div",12)(15,"div",13)(16,"div",14)(17,"div",15),g(18,Ee,4,1)(19,Me,1,0),a(),n(20,"label",16),s(21,"i",17),o(22," Filtros "),a()(),n(23,"div",18)(24,"div",19),s(25,"i",20),n(26,"input",21),p("input",function(d){return r.onSearch(d.target.value)}),a()(),n(27,"select",22),p("change",function(d){return r.setSort(d.target.value.split("|")[0],d.target.value.split("|")[1])}),n(28,"option",23),o(29,"M\xE1s Recientes"),a(),n(30,"option",24),o(31,"Precio: Menor a Mayor"),a(),n(32,"option",25),o(33,"Precio: Mayor a Menor"),a()()()(),n(34,"div",26)(35,"div",27),s(36,"i",20),n(37,"input",28),p("input",function(d){return r.onSearch(d.target.value)}),a()()(),n(38,"main",29),g(39,Be,3,1,"div",30)(40,Ie,1,1,"is-error",31)(41,Ne,2,1),a()()(),n(42,"div",32),s(43,"label",33),n(44,"aside",34)(45,"div",35)(46,"h3",36),o(47,"Filtros"),a(),n(48,"label",37),o(49,"\u2715"),a()(),n(50,"div",38)(51,"div")(52,"h4",39),s(53,"i",40),o(54," Precio "),a(),n(55,"div",41)(56,"div",42)(57,"label",43),o(58,"M\xEDnimo"),a(),n(59,"div",27)(60,"span",44),o(61,"$"),a(),n(62,"input",45),p("ngModelChange",function(d){return r.minPriceInput.set(d)}),a()()(),n(63,"div",42)(64,"label",43),o(65,"M\xE1ximo"),a(),n(66,"div",27)(67,"span",44),o(68,"$"),a(),n(69,"input",46),p("ngModelChange",function(d){return r.maxPriceInput.set(d)}),a()()(),n(70,"button",47),p("click",function(){return r.applyPriceFilter()}),o(71," Aplicar "),a()()(),n(72,"div")(73,"h4",39),s(74,"i",48),o(75," Otras Secciones "),a(),n(76,"div",49)(77,"ul",50),g(78,qe,2,0),a()()()()()()(),g(79,Le,8,1,"div",51)),e&2){let l,d,C;c(9),m("items",r.breadcrumbItems()),c(2),S(" ",((l=r.currentCategory())==null?null:l.name)||"Explorando Categor\xEDa"," "),c(2),S(" ",((d=r.currentCategory())==null?null:d.description)||"Encontr\xE1 los mejores productos de esta secci\xF3n con calidad garantizada."," "),c(5),_(r.productsRs.value()?18:19),c(8),m("defaultValue",r.searchQuery())("placeholder","Buscar en "+(((C=r.currentCategory())==null?null:C.name)||"esta secci\xF3n")+"..."),c(11),m("defaultValue",r.searchQuery()),c(2),_(r.productsRs.isLoading()?39:r.productsRs.error()?40:r.productsRs.value()?41:-1),c(23),m("ngModel",r.minPriceInput()),c(7),m("ngModel",r.maxPriceInput()),c(9),_(r.categoriesListRs.value()?78:-1),c(),_(r.isQuickViewOpen()?79:-1)}},dependencies:[X,ye,be,_e,te,ee,ue,le,de,se,ie,ce,re,ne,oe,ae,me,W],encapsulation:2,changeDetection:0})},pt=N;export{N as ProductsByCategoryPage,pt as default};
