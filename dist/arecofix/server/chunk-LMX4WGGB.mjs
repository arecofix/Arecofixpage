import './polyfills.server.mjs';
import{a as g}from"./chunk-IN7KSWA7.mjs";import{a as l}from"./chunk-3ZJRLAHS.mjs";import{r as m}from"./chunk-D7WVJHD7.mjs";import{Cc as d,R as u,W as o,ma as n,oa as p,xa as f}from"./chunk-IUHZUWYM.mjs";import{a as s,b as c}from"./chunk-N7QBYMCK.mjs";var I=class i{logger=o(l);toastService=o(g);platformId=o(f);cartItems=n([]);constructor(){if(m(this.platformId)){let t=localStorage.getItem("cart");if(t)try{this.cartItems.set(JSON.parse(t))}catch{this.cartItems.set([])}}p(()=>{let t=this.cartItems();m(this.platformId)&&localStorage.setItem("cart",JSON.stringify(t))})}addToCart(t){this.cartItems.update(e=>e.find(r=>r.product.id===t.id)?e.map(r=>r.product.id===t.id?c(s({},r),{quantity:r.quantity+1}):r):[...e,{product:t,quantity:1}]),this.logger.debug("Product added to cart",{productName:t.name}),this.toastService.show("Agregaste un producto al carrito","success",()=>this.openCart())}removeFromCart(t){this.cartItems.update(e=>e.filter(a=>a.product.id!==t))}updateQuantity(t,e){if(e<=0){this.removeFromCart(t);return}this.cartItems.update(a=>a.map(r=>r.product.id===t?c(s({},r),{quantity:e}):r))}clearCart(){this.cartItems.set([])}totalItems=d(()=>this.cartItems().reduce((t,e)=>t+e.quantity,0));totalPrice=d(()=>this.cartItems().reduce((t,e)=>t+e.product.price*e.quantity,0));isCartOpen=n(!1);openCart(){this.isCartOpen.set(!0)}closeCart(){this.isCartOpen.set(!1)}toggleCart(){this.isCartOpen.update(t=>!t)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=u({token:i,factory:i.\u0275fac,providedIn:"root"})};export{I as a};
