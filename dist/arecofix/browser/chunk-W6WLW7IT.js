import{a as F,b as W,d as D,e as L,f as T,g as I,h as k,l as B,m as O,n as R,p as V,r as j}from"./chunk-TXZ4IKMM.js";import{a as N}from"./chunk-FDEIW4RV.js";import"./chunk-KXBHGC7O.js";import{b as x,d as P,e as A}from"./chunk-SJUHAIWY.js";import"./chunk-2IHNZNBZ.js";import{o as E}from"./chunk-NGBKTTVY.js";import{Fa as o,Fb as r,Gb as M,Hb as w,Jb as m,Kb as d,Lb as g,Ta as C,W as c,eb as y,fb as h,kb as _,lb as t,ma as p,mb as a,nb as f,vb as b,xb as S}from"./chunk-CVZCBU36.js";import{a as v}from"./chunk-VOSPIT4N.js";function G(s,l){if(s&1&&(t(0,"div",6),f(1,"i",24),t(2,"span"),r(3),a()()),s&2){let i=S();o(3),M(i.error())}}function U(s,l){s&1&&f(0,"span",23)}var q=class s{route=c(x);router=c(P);auth=c(N);id=null;form=p({name:"",slug:"",description:"",type:"product",is_active:!0});loading=p(!0);saving=p(!1);error=p(null);async ngOnInit(){if(this.id=this.route.snapshot.paramMap.get("id"),this.id){let l=this.auth.getSupabaseClient(),{data:i,error:e}=await l.from("categories").select("*").eq("id",this.id).single();i&&this.form.set({name:i.name,slug:i.slug,description:i.description||"",type:i.type,is_active:i.is_active})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let l=this.auth.getSupabaseClient(),i=v({},this.form());i.slug||(i.slug=this.slugify(i.name));try{if(this.id){let{error:e}=await l.from("categories").update(i).eq("id",this.id);if(e)throw e}else{let{error:e}=await l.from("categories").insert(i);if(e)throw e}this.router.navigate(["/admin/categories"])}catch(e){this.error.set(e.message)}finally{this.saving.set(!1)}}slugify(l){return l.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-")}static \u0275fac=function(i){return new(i||s)};static \u0275cmp=C({type:s,selectors:[["app-admin-category-form-page"]],decls:42,vars:9,consts:[[1,"max-w-2xl","mx-auto"],[1,"flex","items-center","gap-4","mb-6"],["routerLink","/admin/categories",1,"btn","btn-circle","btn-ghost"],[1,"fas","fa-arrow-left"],[1,"text-2xl","font-bold","text-gray-800"],[1,"bg-white","rounded-lg","shadow","p-6"],[1,"alert","alert-error","mb-4"],[1,"space-y-4",3,"ngSubmit"],[1,"form-control"],[1,"label"],["type","text","name","name","required","",1,"input","input-bordered",3,"ngModelChange","ngModel"],["type","text","name","slug","placeholder","Se genera autom\xE1ticamente si se deja vac\xEDo",1,"input","input-bordered",3,"ngModelChange","ngModel"],["name","description",1,"textarea","textarea-bordered","h-24",3,"ngModelChange","ngModel"],["name","type",1,"select","select-bordered",3,"ngModelChange","ngModel"],["value","product"],["value","course"],["value","service"],[1,"label","cursor-pointer","justify-start","gap-4"],[1,"label-text"],["type","checkbox","name","is_active",1,"toggle","toggle-primary",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-4","mt-6"],["routerLink","/admin/categories",1,"btn","btn-ghost"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"loading","loading-spinner"],[1,"fas","fa-exclamation-circle"]],template:function(i,e){i&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(3,"i",3),a(),t(4,"h1",4),r(5),a()(),t(6,"div",5),y(7,G,4,1,"div",6),t(8,"form",7),b("ngSubmit",function(){return e.save()}),t(9,"div",8)(10,"label",9),r(11,"Nombre"),a(),t(12,"input",10),g("ngModelChange",function(n){return d(e.form().name,n)||(e.form().name=n),n}),a()(),t(13,"div",8)(14,"label",9),r(15,"Slug (URL)"),a(),t(16,"input",11),g("ngModelChange",function(n){return d(e.form().slug,n)||(e.form().slug=n),n}),a()(),t(17,"div",8)(18,"label",9),r(19,"Descripci\xF3n"),a(),t(20,"textarea",12),g("ngModelChange",function(n){return d(e.form().description,n)||(e.form().description=n),n}),a()(),t(21,"div",8)(22,"label",9),r(23,"Tipo"),a(),t(24,"select",13),g("ngModelChange",function(n){return d(e.form().type,n)||(e.form().type=n),n}),t(25,"option",14),r(26,"Producto"),a(),t(27,"option",15),r(28,"Curso"),a(),t(29,"option",16),r(30,"Servicio"),a()()(),t(31,"div",8)(32,"label",17)(33,"span",18),r(34,"Activo"),a(),t(35,"input",19),g("ngModelChange",function(n){return d(e.form().is_active,n)||(e.form().is_active=n),n}),a()()(),t(36,"div",20)(37,"a",21),r(38,"Cancelar"),a(),t(39,"button",22),y(40,U,1,0,"span",23),r(41," Guardar "),a()()()()()),i&2&&(o(5),w("",e.id?"Editar":"Nueva"," Categor\xEDa"),o(2),h(e.error()?7:-1),o(5),m("ngModel",e.form().name),o(4),m("ngModel",e.form().slug),o(4),m("ngModel",e.form().description),o(4),m("ngModel",e.form().type),o(11),m("ngModel",e.form().is_active),o(4),_("disabled",e.saving()),o(),h(e.saving()?40:-1))},dependencies:[E,j,k,O,R,W,F,B,D,L,V,I,T,A],encapsulation:2})};export{q as AdminCategoryFormPage};
