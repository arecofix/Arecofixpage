import{k as G,l as z}from"./chunk-GBGIQ7VE.js";import{a as T,b as W,d as D,e as I,f as L,g as q,h as j,i as k,p as B,q as R,t as O}from"./chunk-63CMMPDH.js";import"./chunk-IP3FEPB3.js";import"./chunk-SFLZ64DJ.js";import"./chunk-FEKWCP2W.js";import{l as A,n as F,o as N}from"./chunk-YNFFGNY6.js";import"./chunk-Q44XB7TV.js";import{$ as g,$b as _,Ab as i,Bb as n,Cb as c,Gb as M,Kb as V,Mb as m,Ua as l,Vb as s,W as v,Wb as E,Xb as P,Zb as u,_b as f,aa as p,gb as C,ma as x,tb as S,ub as b,zb as w}from"./chunk-DX2LKEMG.js";import{a as h,b as y}from"./chunk-C6Q5SG76.js";function J(a,d){a&1&&(i(0,"div",7),c(1,"span",9),n())}function K(a,d){if(a&1&&(i(0,"div",25),c(1,"i",29),i(2,"span"),s(3),n()()),a&2){let e=m(2);l(3),E(e.error())}}function Q(a,d){a&1&&c(0,"span",28)}function U(a,d){if(a&1){let e=M();i(0,"form",10),V("ngSubmit",function(){g(e);let t=m();return p(t.save())}),i(1,"div",11)(2,"label",12)(3,"span",13),s(4,"Nombre del Servicio"),n()(),i(5,"label",14),c(6,"i",15),i(7,"input",16),_("ngModelChange",function(t){g(e);let r=m();return f(r.form().name,t)||(r.form().name=t),p(t)}),n()()(),i(8,"div",11)(9,"label",12)(10,"span",13),s(11,"Descripci\xF3n"),n()(),i(12,"textarea",17),_("ngModelChange",function(t){g(e);let r=m();return f(r.form().description,t)||(r.form().description=t),p(t)}),n()(),i(13,"div",18)(14,"div",11)(15,"label",12)(16,"span",13),s(17,"Precio"),n()(),i(18,"label",14),c(19,"i",19),i(20,"input",20),_("ngModelChange",function(t){g(e);let r=m();return f(r.form().price,t)||(r.form().price=t),p(t)}),n()()(),i(21,"div",11)(22,"label",12)(23,"span",13),s(24,"Duraci\xF3n (minutos)"),n()(),i(25,"label",14),c(26,"i",21),i(27,"input",22),_("ngModelChange",function(t){g(e);let r=m();return f(r.form().duration_minutes,t)||(r.form().duration_minutes=t),p(t)}),n()()()(),i(28,"div",11)(29,"label",23)(30,"span",13),s(31,"Activo"),n(),i(32,"input",24),_("ngModelChange",function(t){g(e);let r=m();return f(r.form().is_active,t)||(r.form().is_active=t),p(t)}),n()()(),S(33,K,4,1,"div",25),i(34,"div",26)(35,"a",3),s(36,"Cancelar"),n(),i(37,"button",27),S(38,Q,1,0,"span",28),s(39," Guardar "),n()()()}if(a&2){let e=m();l(7),u("ngModel",e.form().name),l(5),u("ngModel",e.form().description),l(8),u("ngModel",e.form().price),l(7),u("ngModel",e.form().duration_minutes),l(5),u("ngModel",e.form().is_active),l(),b(e.error()?33:-1),l(4),w("disabled",e.saving()||!e.form().name),l(),b(e.saving()?38:-1)}}var H=class a{route=v(A);router=v(F);auth=v(z);tenantService=v(G);id=null;form=x({name:"",description:"",price:0,duration_minutes:60,is_active:!0});loading=x(!0);saving=x(!1);error=x(null);async ngOnInit(){if(this.id=this.route.snapshot.paramMap.get("id"),this.id){let d=this.auth.getSupabaseClient(),{data:e,error:o}=await d.from("services").select("*").eq("tenant_id",this.tenantService.getTenantId()).eq("id",this.id).single();e&&this.form.set({name:e.name,description:e.description||"",price:e.price||0,duration_minutes:e.duration_minutes||60,is_active:e.is_active})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let d=this.auth.getSupabaseClient(),e=this.form(),o={name:e.name,description:e.description,price:Number(e.price),duration_minutes:Number(e.duration_minutes),is_active:e.is_active};try{if(this.id){let{error:t}=await d.from("services").update(o).eq("id",this.id).eq("tenant_id",this.tenantService.getTenantId());if(t)throw t}else{let{error:t}=await d.from("services").insert(y(h({},o),{tenant_id:this.tenantService.getTenantId()}));if(t)throw t}this.router.navigate(["/admin/services"])}catch(t){console.error("Error saving service:",t),this.error.set(t.message||"Error al guardar el servicio. Verifica los datos.")}finally{this.saving.set(!1)}}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=C({type:a,selectors:[["app-admin-service-form-page"]],decls:11,vars:2,consts:[[1,"max-w-2xl","mx-auto"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-green-600"],["routerLink","/admin/services",1,"btn","btn-ghost"],[1,"fas","fa-arrow-left","mr-2"],[1,"card","bg-base-100","shadow-lg"],[1,"card-body","p-6"],[1,"flex","justify-center","py-12"],[1,"space-y-6"],[1,"loading","loading-spinner","loading-lg","text-primary"],[1,"space-y-6",3,"ngSubmit"],[1,"form-control"],[1,"label"],[1,"label-text","font-medium"],[1,"input","input-bordered","flex","items-center","gap-2"],[1,"fas","fa-tag","text-gray-400"],["type","text","name","name","required","",1,"grow",3,"ngModelChange","ngModel"],["name","description","placeholder","Describe los detalles del servicio...",1,"textarea","textarea-bordered","h-32","leading-relaxed",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"fas","fa-dollar-sign","text-gray-400"],["type","number","name","price","min","0","step","0.01",1,"grow",3,"ngModelChange","ngModel"],[1,"fas","fa-clock","text-gray-400"],["type","number","name","duration_minutes","min","0",1,"grow",3,"ngModelChange","ngModel"],[1,"label","cursor-pointer","justify-start","gap-4","p-0"],["type","checkbox","name","is_active",1,"toggle","toggle-primary",3,"ngModelChange","ngModel"],[1,"alert","alert-error","mb-6","shadow-sm"],[1,"flex","justify-end","gap-4","pt-6","border-t","border-base-200"],["type","submit",1,"btn","btn-primary","px-8",3,"disabled"],[1,"loading","loading-spinner","loading-xs"],[1,"fas","fa-exclamation-circle"]],template:function(e,o){e&1&&(i(0,"div",0)(1,"div",1)(2,"h1",2),s(3),n(),i(4,"a",3),c(5,"i",4),s(6," Volver "),n()(),i(7,"div",5)(8,"div",6),S(9,J,2,0,"div",7)(10,U,40,8,"form",8),n()()()),e&2&&(l(3),P("",o.id?"Editar":"Nuevo"," Servicio"),l(6),b(o.loading()?9:10))},dependencies:[O,j,W,k,T,D,I,R,B,q,L,N],encapsulation:2})};export{H as AdminServiceFormPage};
