import{a as F}from"./chunk-FDEIW4RV.js";import"./chunk-KXBHGC7O.js";import"./chunk-SJUHAIWY.js";import"./chunk-2IHNZNBZ.js";import{m as I,o as D}from"./chunk-NGBKTTVY.js";import{$ as u,Ca as w,Db as T,Fa as s,Fb as o,Gb as _,Hb as f,Ta as y,W as M,Wb as j,Yb as k,aa as x,eb as g,fb as p,ib as S,jb as A,ma as E,ob as n,pb as a,qb as r,rb as b,sb as P,wb as h,xb as c}from"./chunk-CVZCBU36.js";import{a as v,b as C}from"./chunk-VOSPIT4N.js";var V=(t,i)=>i.id;function $(t,i){t&1&&(n(0,"div",3),r(1,"span",5),a())}function O(t,i){t&1&&(n(0,"div",4),r(1,"i",6),n(2,"span"),o(3,"No hay mensajes nuevos."),a()())}function R(t,i){t&1&&(n(0,"span",14),o(1,"Nuevo"),a())}function q(t,i){if(t&1&&(n(0,"span"),r(1,"i",27),o(2),a()),t&2){let e=c().$implicit;s(2),f(" ",e.phone)}}function L(t,i){if(t&1&&(n(0,"div",19),o(1),a()),t&2){let e=c().$implicit;s(),f("Asunto: ",e.subject)}}function z(t,i){if(t&1){let e=b();n(0,"button",28),h("click",function(){u(e);let l=c().$implicit,m=c(2);return x(m.markAsRead(l.id))}),r(1,"i",29),a()}}function B(t,i){if(t&1){let e=b();n(0,"div",8)(1,"div",9)(2,"div",10)(3,"div",11)(4,"div",12)(5,"h3",13),o(6),a(),g(7,R,2,0,"span",14),n(8,"span",15),o(9),j(10,"date"),a()(),n(11,"div",16)(12,"div",17)(13,"span"),r(14,"i",18),o(15),a(),g(16,q,3,1,"span"),a()(),g(17,L,2,1,"div",19),n(18,"p",20),o(19),a()(),n(20,"div",21),g(21,z,2,0,"button",22),n(22,"button",23),h("click",function(){let l=u(e).$implicit,m=c(2);return x(m.deleteMessage(l.id))}),r(23,"i",24),a(),n(24,"a",25),r(25,"i",26),a()()()()()}if(t&2){let e=i.$implicit;T("border-l-4",!e.is_read)("border-primary",!e.is_read),s(6),_(e.name),s(),p(e.is_read?-1:7),s(2),_(k(10,13,e.created_at,"medium")),s(6),f(" ",e.email),s(),p(e.phone?16:-1),s(),p(e.subject?17:-1),s(2),_(e.message),s(2),p(e.is_read?-1:21),s(3),P("href","mailto:"+e.email,w)}}function U(t,i){if(t&1&&S(0,B,26,16,"div",7,V),t&2){let e=c();A(e.messages())}}var N=class t{auth=M(F);messages=E([]);loading=E(!0);async ngOnInit(){await this.loadMessages()}async loadMessages(){this.loading.set(!0);let i=this.auth.getSupabaseClient(),{data:e,error:d}=await i.from("contact_messages").select("*").order("created_at",{ascending:!1});e&&this.messages.set(e),this.loading.set(!1)}async markAsRead(i){let e=this.auth.getSupabaseClient(),{error:d}=await e.from("contact_messages").update({is_read:!0}).eq("id",i);d||this.messages.update(l=>l.map(m=>m.id===i?C(v({},m),{is_read:!0}):m))}async deleteMessage(i){if(!confirm("\xBFEst\xE1s seguro de eliminar este mensaje?"))return;let e=this.auth.getSupabaseClient(),{error:d}=await e.from("contact_messages").delete().eq("id",i);d?alert("Error al eliminar el mensaje"):this.messages.update(l=>l.filter(m=>m.id!==i))}static \u0275fac=function(e){return new(e||t)};static \u0275cmp=y({type:t,selectors:[["app-admin-messages-page"]],decls:7,vars:1,consts:[[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800"],[1,"grid","gap-4"],[1,"flex","justify-center","py-8"],[1,"alert","alert-info"],[1,"loading","loading-spinner","loading-lg"],[1,"fas","fa-info-circle"],[1,"card","bg-white","shadow","hover:shadow-md","transition-shadow",3,"border-l-4","border-primary"],[1,"card","bg-white","shadow","hover:shadow-md","transition-shadow"],[1,"card-body","p-6"],[1,"flex","justify-between","items-start","gap-4"],[1,"flex-1"],[1,"flex","items-center","gap-2","mb-2"],[1,"font-bold","text-lg"],[1,"badge","badge-primary","badge-sm"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-600","mb-2"],[1,"flex","items-center","gap-4"],[1,"fas","fa-envelope","mr-1"],[1,"font-medium","mb-2"],[1,"text-gray-700","whitespace-pre-wrap"],[1,"flex","flex-col","gap-2"],["title","Marcar como le\xEDdo",1,"btn","btn-sm","btn-ghost"],["title","Eliminar",1,"btn","btn-sm","btn-ghost","text-error",3,"click"],[1,"fas","fa-trash"],["title","Responder",1,"btn","btn-sm","btn-ghost","text-info",3,"href"],[1,"fas","fa-reply"],[1,"fas","fa-phone","mr-1"],["title","Marcar como le\xEDdo",1,"btn","btn-sm","btn-ghost",3,"click"],[1,"fas","fa-check","text-success"]],template:function(e,d){e&1&&(n(0,"div",0)(1,"h1",1),o(2,"Mensajes de Contacto"),a()(),n(3,"div",2),g(4,$,2,0,"div",3)(5,O,4,0,"div",4)(6,U,2,0),a()),e&2&&(s(4),p(d.loading()?4:d.messages().length===0?5:6))},dependencies:[D,I],encapsulation:2})};export{N as AdminMessagesPage};
