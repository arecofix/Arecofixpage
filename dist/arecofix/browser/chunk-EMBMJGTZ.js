import{a as q}from"./chunk-ZUAZKNUL.js";import{b as T,d as L,g as O,l as F,m as Q,n as $,s as j}from"./chunk-JC43VCPH.js";import"./chunk-CPI2BPDE.js";import"./chunk-NR3BVOML.js";import{h as D}from"./chunk-Z245BGFQ.js";import"./chunk-IIPDUD2U.js";import"./chunk-T7AXESXA.js";import"./chunk-L5RZOCV7.js";import{Ab as C,Bb as v,Cb as e,Cc as N,Db as i,Eb as l,Kb as M,Ob as f,Qb as b,Ra as P,Ub as A,Wa as c,Wb as S,Y as x,Yb as n,Zb as _,_b as h,ba as m,ca as p,ib as y,kc as V,oa as g,vb as k,vc as I,wb as w,zb as E}from"./chunk-SISNN44B.js";import"./chunk-VOSPIT4N.js";var R=o=>["/admin/products",o],U=(o,r)=>r.id;function B(o,r){o&1&&(e(0,"div",24),l(1,"span",27),i())}function H(o,r){if(o&1&&(e(0,"div",25),l(1,"i",28),e(2,"span"),n(3),i()()),o&2){let t=b();c(3),_(t.error())}}function K(o,r){if(o&1&&(e(0,"tr")(1,"td")(2,"div",32)(3,"div",33)(4,"div",34),l(5,"img",35),i()(),e(6,"div")(7,"div",36),n(8),i(),e(9,"div",37),n(10),i()()()(),e(11,"td",36),n(12),i(),e(13,"td")(14,"div",38),n(15),i()(),e(16,"td")(17,"span",38),n(18),i()(),e(19,"td")(20,"a",39),l(21,"i",40),n(22," Editar "),i()()()),o&2){let t=r.$implicit;c(5),v("src",t.image_url||"assets/img/no-image.png",P),c(3),_(t.name),c(2),_(t.slug),c(2),h("$",t.price),c(2),S("badge-warning",t.stock<5)("badge-success",t.stock>=5),c(),h(" ",t.stock," "),c(2),S("badge-success",t.is_active)("badge-ghost",!t.is_active),c(),h(" ",t.is_active?"Activo":"Inactivo"," "),c(2),v("routerLink",V(15,R,t.id))}}function Z(o,r){if(o&1&&(e(0,"div",26)(1,"div",29)(2,"table",30)(3,"thead")(4,"tr",31)(5,"th"),n(6,"Producto"),i(),e(7,"th"),n(8,"Precio"),i(),e(9,"th"),n(10,"Stock"),i(),e(11,"th"),n(12,"Estado"),i(),e(13,"th"),n(14,"Acciones"),i()()(),e(15,"tbody"),E(16,K,23,17,"tr",null,U),i()()()()),o&2){let t=b();c(16),C(t.filteredProducts())}}var z=class o{productService=x(q);cdr=x(N);products=g([]);searchQuery=g("");sortOrder=g("name_asc");loading=g(!0);error=g(null);filteredProducts=I(()=>{let r=this.searchQuery().toLowerCase(),t=this.products();r&&(t=t.filter(a=>a.name.toLowerCase().includes(r)||a.slug?.toLowerCase().includes(r)||a.sku?.toLowerCase().includes(r)||a.barcode?.toLowerCase().includes(r)));let s=this.sortOrder();return t.sort((a,d)=>{switch(s){case"price_asc":return a.price-d.price;case"price_desc":return d.price-a.price;case"stock_asc":return a.stock-d.stock;case"stock_desc":return d.stock-a.stock;case"name_asc":default:return a.name.localeCompare(d.name)}})});async ngOnInit(){try{let r=await this.productService.getProducts();this.products.set(r)}catch(r){this.error.set(r.message||"Error al cargar productos")}finally{this.loading.set(!1)}}async exportProducts(){try{this.loading.set(!0),await this.productService.exportProductsToCSV()}catch(r){this.error.set(r.message||"Error al exportar productos")}finally{this.loading.set(!1)}}async importProducts(r){let t=r.target.files[0];if(t)try{this.loading.set(!0);let s=await this.productService.importProductsFromCSV(t);alert(`Importaci\xF3n completada: ${s.success} productos importados/actualizados. ${s.errors} errores.`);let a=await this.productService.getProducts();this.products.set(a)}catch(s){this.error.set(s.message||"Error al importar productos")}finally{this.loading.set(!1),r.target.value=""}}updateSort(r){let t=r.target.value;this.sortOrder.set(t)}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=y({type:o,selectors:[["app-admin-products-page"]],decls:36,vars:3,consts:[["fileInput",""],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800","dark:text-green-400"],[1,"flex","gap-2"],[1,"btn","btn-outline","btn-primary",3,"click"],[1,"fas","fa-file-export","mr-2"],[1,"btn","btn-outline","btn-secondary",3,"click"],[1,"fas","fa-file-import","mr-2"],["type","file","accept",".csv",1,"hidden",3,"change"],["routerLink","/admin/products/new",1,"btn","btn-primary"],[1,"fas","fa-plus","mr-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"form-control"],[1,"input-group"],["type","text","placeholder","Buscar por nombre, SKU o c\xF3digo de barras...",1,"input","input-bordered","w-full","bg-base-100","text-base-content",3,"ngModelChange","ngModel"],[1,"btn","btn-square"],[1,"fas","fa-search"],[1,"flex","justify-end"],[1,"select","select-bordered","bg-base-100","text-base-content","max-w-xs",3,"change","ngModel"],["value","name_asc"],["value","price_asc"],["value","price_desc"],["value","stock_asc"],["value","stock_desc"],[1,"flex","justify-center","py-12"],[1,"alert","alert-error"],[1,"bg-white","rounded-lg","shadow","overflow-hidden","text-gray-800","dark:text-white","dark:bg-gray-800"],[1,"loading","loading-spinner","loading-lg"],[1,"fas","fa-exclamation-circle"],[1,"overflow-x-auto"],[1,"table","w-full"],[1,"text-gray-800","dark:text-white"],[1,"flex","items-center","gap-3"],[1,"avatar"],[1,"mask","mask-squircle","w-12","h-12"],["alt","Product",3,"src"],[1,"font-bold"],[1,"text-sm","opacity-50"],[1,"badge"],[1,"btn","btn-sm","btn-ghost",3,"routerLink"],[1,"fas","fa-edit"]],template:function(t,s){if(t&1){let a=M();e(0,"div",1)(1,"h1",2),n(2,"Productos"),i(),e(3,"div",3)(4,"button",4),f("click",function(){return m(a),p(s.exportProducts())}),l(5,"i",5),n(6," Exportar CSV "),i(),e(7,"button",6),f("click",function(){m(a);let u=A(11);return p(u.click())}),l(8,"i",7),n(9," Importar CSV "),i(),e(10,"input",8,0),f("change",function(u){return m(a),p(s.importProducts(u))}),i(),e(12,"a",9),l(13,"i",10),n(14," Nuevo Producto "),i()()(),e(15,"div",11)(16,"div",12)(17,"div",13)(18,"input",14),f("ngModelChange",function(u){return m(a),p(s.searchQuery.set(u))}),i(),e(19,"button",15),l(20,"i",16),i()()(),e(21,"div",17)(22,"select",18),f("change",function(u){return m(a),p(s.updateSort(u))}),e(23,"option",19),n(24,"Nombre (A-Z)"),i(),e(25,"option",20),n(26,"Precio: Menor a Mayor"),i(),e(27,"option",21),n(28,"Precio: Mayor a Menor"),i(),e(29,"option",22),n(30,"Stock: Menor a Mayor"),i(),e(31,"option",23),n(32,"Stock: Mayor a Menor"),i()()()(),k(33,B,2,0,"div",24)(34,H,4,1,"div",25)(35,Z,18,0,"div",26)}t&2&&(c(18),v("ngModel",s.searchQuery()),c(4),v("ngModel",s.sortOrder()),c(11),w(s.loading()?33:s.error()?34:35))},dependencies:[D,j,Q,$,T,F,L,O],encapsulation:2,changeDetection:0})};export{z as AdminProductsPage};
