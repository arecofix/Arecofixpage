import{a as c,d as _}from"./chunk-37HOYKPW.js";import{a as A}from"./chunk-MCSV4IA2.js";import{d as D,i as v}from"./chunk-BWQSVEWZ.js";import"./chunk-44RGWP63.js";import"./chunk-4CQ4C23O.js";import{m as S,n as E}from"./chunk-XV34LPXM.js";import{Db as a,Eb as l,Fa as s,Sa as b,Ub as y,Vb as C,X as x,cb as u,db as g,ib as m,jb as t,kb as e,lb as n,na as d,vb as f}from"./chunk-DPJIKM6M.js";import"./chunk-VOSPIT4N.js";function O(o,r){o&1&&(t(0,"div",2),n(1,"span",3),e())}function V(o,r){if(o&1&&(n(0,"div",45),t(1,"div",46)(2,"div",47)(3,"span",48),n(4,"i",49),t(5,"span"),a(6,"Sesi\xF3n Actual"),e()(),t(7,"span",50),a(8),e()(),t(9,"div",47)(10,"span",48),n(11,"i",51),t(12,"span"),a(13,"Usuario"),e()(),t(14,"span",52),a(15),e()(),t(16,"a",53),n(17,"i",54),a(18," Ver Dashboard Completo "),e()()),o&2){let i=f(2);s(8),l(i.analyticsStats().sessionId?"Activa":"N/A"),s(7),l(i.analyticsStats().distinctId||"An\xF3nimo")}}function k(o,r){o&1&&(t(0,"div",44),n(1,"i",55),t(2,"span"),a(3,"PostHog no est\xE1 inicializado correctamente"),e()())}function N(o,r){if(o&1&&(t(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7),n(4,"i",8),e(),t(5,"div",9),a(6,"Usuarios"),e(),t(7,"div",10),a(8),e(),t(9,"div",11),a(10,"Registrados"),e()()(),t(11,"div",5)(12,"div",6)(13,"div",12),n(14,"i",13),e(),t(15,"div",9),a(16,"Productos"),e(),t(17,"div",14),a(18),e(),t(19,"div",11),a(20,"En cat\xE1logo"),e()()(),t(21,"div",5)(22,"div",6)(23,"div",15),n(24,"i",16),e(),t(25,"div",9),a(26,"Ventas"),e(),t(27,"div",17),a(28),e(),t(29,"div",11),a(30,"Total realizadas"),e()()(),t(31,"div",5)(32,"div",6)(33,"div",18),n(34,"i",19),e(),t(35,"div",9),a(36,"Ingresos"),e(),t(37,"div",20),a(38),y(39,"currency"),e(),t(40,"div",11),a(41,"Total facturado"),e()()()(),t(42,"div",21)(43,"div",22)(44,"div",23)(45,"h2",24),a(46,"Resumen de Ventas"),e(),t(47,"div",25),n(48,"canvas",26),e()()(),t(49,"div",27)(50,"div",23)(51,"h2",24),a(52,"Productos Top"),e(),t(53,"div",28),n(54,"canvas",26),e()()(),t(55,"div",27)(56,"div",23)(57,"h2",24),a(58,"Ventas por Categor\xEDa"),e(),t(59,"div",29),n(60,"canvas",26),e()()()(),t(61,"div",30)(62,"div",27)(63,"div",23)(64,"h2",24),a(65,"Acciones R\xE1pidas"),e(),t(66,"div",31)(67,"a",32),n(68,"i",33),a(69," Nuevo Producto "),e(),t(70,"a",34),n(71,"i",35),a(72," Nueva Venta "),e(),t(73,"a",36),n(74,"i",37),a(75," Gestionar Usuarios "),e(),t(76,"a",38),n(77,"i",39),a(78," Taller "),e()()()(),t(79,"div",27)(80,"div",23)(81,"h2",24),a(82,"Analytics & Sistema"),e(),t(83,"div",40)(84,"div",41)(85,"span",42),a(86,"Base de Datos"),e(),t(87,"span",43),a(88,"Conectado"),e()(),t(89,"div",41)(90,"span",42),a(91,"Analytics (PostHog)"),e(),t(92,"span",43),a(93),e()(),u(94,V,19,2)(95,k,4,0,"div",44),e()()()()),o&2){let i=f();s(8),l(i.stats().users),s(10),l(i.stats().products),s(10),l(i.stats().sales),s(10),l(C(39,15,i.stats().revenue)),s(10),m("data",i.salesChartData)("options",i.salesChartOptions)("type",i.salesChartType),s(6),m("data",i.productsChartData)("options",i.productsChartOptions)("type",i.productsChartType),s(6),m("data",i.categoryChartData)("options",i.categoryChartOptions)("type",i.categoryChartType),s(33),l(i.posthogStatus()),s(),g(i.analyticsStats().enabled?94:95)}}var I=class o{auth=x(A);stats=d({users:0,products:0,sales:0,revenue:0},{});analyticsStats=d({enabled:!1,sessionId:"",distinctId:""},{});loading=d(!0,{});salesChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom"},title:{display:!0,text:"Ventas del A\xF1o"}}};salesChartType="line";salesChartData={labels:["Ene","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"],datasets:[{data:[65,59,80,81,56,55,40,70,90,100,110,120],label:"Ventas ($)",borderColor:"#4f46e5",backgroundColor:"rgba(79, 70, 229, 0.2)",fill:!0}]};productsChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Productos M\xE1s Vendidos"}}};productsChartType="bar";productsChartData={labels:["iPhone 11","Samsung A52","Modulo iPhone X","Cargador 20W","Funda Silicona"],datasets:[{data:[28,48,40,19,86],label:"Unidades",backgroundColor:["#ef4444","#3b82f6","#10b981","#f59e0b","#8b5cf6"]}]};categoryChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right"},title:{display:!0,text:"Ventas por Categor\xEDa"}}};categoryChartType="doughnut";categoryChartData={labels:["Repuestos","Accesorios","Servicios","Cursos"],datasets:[{data:[300,500,100,50],backgroundColor:["#3b82f6","#10b981","#f59e0b","#ef4444"]}]};async ngOnInit(){await this.loadStats(),this.loadAnalyticsInfo()}async loadStats(){this.loading.set(!0);let r=this.auth.getSupabaseClient();try{let{count:i}=await r.from("profiles").select("*",{count:"exact",head:!0}),{count:p}=await r.from("products").select("*",{count:"exact",head:!0}),{data:h}=await r.from("sales").select("total_amount, created_at"),w=h?.length||0,T=h?.reduce((P,M)=>P+(M.total_amount||0),0)||0;this.stats.set({users:i||0,products:p||0,sales:w,revenue:T})}catch(i){console.error("Error loading dashboard stats:",i)}finally{this.loading.set(!1)}}loadAnalyticsInfo(){try{v.posthogKey&&v.posthogKey!==""&&c?this.analyticsStats.set({enabled:!0,sessionId:c.get_session_id()||"",distinctId:c.get_distinct_id()||"An\xF3nimo"}):this.analyticsStats.set({enabled:!1,sessionId:"",distinctId:""})}catch(r){console.error("Error loading analytics info:",r),this.analyticsStats.set({enabled:!1,sessionId:"",distinctId:""})}}posthogStatus(){return this.analyticsStats().enabled?"Activo":"Inactivo"}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=b({type:o,selectors:[["app-admin-dashboard-page"]],decls:5,vars:1,consts:[[1,"p-6"],[1,"text-2xl","font-bold","mb-6","text-gray-800"],[1,"flex","justify-center","py-12"],[1,"loading","loading-spinner","loading-lg"],[1,"grid","grid-cols-1","md:grid-cols-2","lg:grid-cols-4","gap-6","mb-8"],[1,"stats","shadow","bg-white","text-gray-800"],[1,"stat"],[1,"stat-figure","text-primary"],[1,"fas","fa-users","text-3xl"],[1,"stat-title","text-gray-600"],[1,"stat-value","text-primary"],[1,"stat-desc","text-gray-500"],[1,"stat-figure","text-secondary"],[1,"fas","fa-box","text-3xl"],[1,"stat-value","text-secondary"],[1,"stat-figure","text-accent"],[1,"fas","fa-shopping-cart","text-3xl"],[1,"stat-value","text-accent"],[1,"stat-figure","text-success"],[1,"fas","fa-dollar-sign","text-3xl"],[1,"stat-value","text-success"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6","mb-8"],[1,"card","bg-white","shadow","text-gray-800","lg:col-span-2"],[1,"card-body"],[1,"card-title","mb-4","text-gray-800"],[1,"h-80","w-full"],["baseChart","",3,"data","options","type"],[1,"card","bg-white","shadow","text-gray-800"],[1,"h-64","w-full"],[1,"h-64","w-full","flex","justify-center"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"grid","grid-cols-2","gap-4"],["routerLink","/admin/products/new",1,"btn","btn-outline","btn-primary"],[1,"fas","fa-plus","mr-2"],["routerLink","/admin/sales",1,"btn","btn-outline","btn-accent"],[1,"fas","fa-cash-register","mr-2"],["routerLink","/admin/users",1,"btn","btn-outline"],[1,"fas","fa-user-plus","mr-2"],["routerLink","/admin/repairs",1,"btn","btn-outline","btn-secondary"],[1,"fas","fa-tools","mr-2"],[1,"space-y-4"],[1,"flex","justify-between","items-center"],[1,"text-gray-700"],[1,"badge","badge-success"],[1,"alert","alert-warning","text-xs","mt-4"],[1,"divider","my-2"],[1,"space-y-3"],[1,"flex","justify-between","items-center","text-sm"],[1,"flex","items-center","gap-2"],[1,"fas","fa-eye","text-info"],[1,"font-semibold"],[1,"fas","fa-user","text-primary"],[1,"font-semibold","text-xs"],["href","https://us.posthog.com/project/253677/dashboard/791256","target","_blank",1,"btn","btn-sm","btn-outline","btn-info","w-full","mt-2"],[1,"fas","fa-chart-line","mr-2"],[1,"fas","fa-exclamation-triangle"]],template:function(i,p){i&1&&(t(0,"div",0)(1,"h1",1),a(2,"Panel de Control"),e(),u(3,O,2,0,"div",2)(4,N,96,17),e()),i&2&&(s(3),g(p.loading()?3:4))},dependencies:[E,D,_,S],encapsulation:2})};export{I as AdminDashboardPage};
