import{b as h}from"./chunk-SUEW2WST.js";import{a as f}from"./chunk-OW7ANG2H.js";import{C as u,R as c,V as b,W as m,k as p,l as i,r as n}from"./chunk-R5MGBMPQ.js";var _=class l{constructor(t){this.authService=t;this.supabase=this.authService.getSupabaseClient()}supabase;logger=m(f);processResponse(t,r,e){let s=r||t.length,o=e._per_page>0?e._per_page:s,a=Math.max(1,Math.ceil(s/(o||1)));return{first:1,prev:e._page>1?e._page-1:null,next:e._page<a?e._page+1:null,last:a,pages:a,items:s,data:t}}getData(t){let{_page:r=1,_per_page:e=10}=t,s=(r-1)*e,o=s+e-1;return p(this.supabase.from("categories").select("*",{count:"exact"}).eq("is_active",!0).range(s,o)).pipe(n(({data:a,count:v,error:g})=>{if(g)throw g;return this.processResponse(a||[],v,{_page:r,_per_page:e})}),u(a=>(this.logger.error("Supabase Error:",a),i({first:1,prev:null,next:null,last:1,pages:1,items:0,data:[]}))))}getFeaturedData(){return p(this.supabase.from("categories").select("*",{count:"exact"}).eq("is_active",!0).order("name").limit(100)).pipe(n(({data:e,count:s,error:o})=>{if(o)throw o;return this.processResponse(e||[],s,{_page:1,_per_page:100})}),u(e=>(this.logger.error("Supabase Error:",e),i({first:1,prev:null,next:null,last:1,pages:1,items:0,data:[]}))))}getDataBySlug(t){return p(this.supabase.from("categories").select("*").ilike("slug",t).limit(1)).pipe(n(({data:r,error:e})=>{if(e)throw e;return this.processResponse(r||[],r?.length||0,{_page:1,_per_page:1})}),u(r=>(this.logger.error("Supabase Error:",r),i({first:1,prev:null,next:null,last:1,pages:1,items:0,data:[]}))))}getById(t){return!t||t==="null"?i(null):p(this.supabase.from("categories").select("*").eq("id",t).single()).pipe(n(({data:r,error:e})=>{if(e)throw e;return r}),u(r=>(this.logger.error("Supabase Error:",r),i(null))))}getAll(){return p(this.supabase.from("categories").select("*").eq("is_active",!0).order("name")).pipe(n(({data:t,error:r})=>{if(r)throw r;return t||[]}),u(t=>(this.logger.error("Supabase Error:",t),i([]))))}static \u0275fac=function(r){return new(r||l)(b(h))};static \u0275prov=c({token:l,factory:l.\u0275fac,providedIn:"root"})};export{_ as a};
