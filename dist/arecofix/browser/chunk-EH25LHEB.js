import{b as xe}from"./chunk-O3RPHUTG.js";import{a as me}from"./chunk-RYHOWFVU.js";import{a as _e}from"./chunk-RAN3DY4H.js";import{d as D}from"./chunk-5IR2AIZL.js";import"./chunk-FNOMVEKC.js";import{a as ie}from"./chunk-N3IIFNSI.js";import{a as be}from"./chunk-3AW4FRRM.js";import{a as ye}from"./chunk-3CSQQBNX.js";import{a as ne}from"./chunk-ZAF732JY.js";import{b as re,d as ae,e as oe,f as le,g as de,h as ce,i as se,m as ue,n as ge,s as pe}from"./chunk-LSPUXVBI.js";import"./chunk-4HXPTVC3.js";import"./chunk-773BQMTG.js";import"./chunk-NIOBXWFE.js";import{b as Y,d as Z,e as ee,i as te}from"./chunk-755N3HP6.js";import{n as W,o as X}from"./chunk-P77MY6VE.js";import{Ab as E,Bb as _,Cb as t,Db as n,E as O,Eb as s,G as L,Kb as h,L as V,N as z,Ob as g,Qb as u,Ra as A,Wa as d,Wb as U,Y as y,Yb as o,Zb as b,_b as P,ba as C,ca as v,d as Q,ib as $,jc as G,kc as J,o as N,oa as x,oc as B,pc as I,u as q,v as j,vb as p,wb as m,wc as K,yb as H,zb as k}from"./chunk-OOA6GWW3.js";import{c as F}from"./chunk-7CGTOI24.js";var Ce=()=>[1,2,3,4,5,6],ve=i=>["/productos/categoria",i],fe=(i,r)=>r.id;function he(i,r){if(i&1&&(o(0," Mostrando "),t(1,"span",55),o(2),n(),o(3," resultados ")),i&2){let e,a=u();d(2),b((e=a.productsRs.value())==null?null:e.items)}}function Pe(i,r){i&1&&o(0," Cargando cat\xE1logo... ")}function we(i,r){i&1&&s(0,"div",56)}function Se(i,r){i&1&&(t(0,"div",33),k(1,we,1,0,"div",56,H),n()),i&2&&(d(),E(G(0,Ce)))}function ke(i,r){if(i&1&&s(0,"is-error",34),i&2){let e,a=u();_("message",((e=a.productsRs.error())==null?null:e.message)||"Error al cargar categor\xEDa")}}function Ee(i,r){if(i&1){let e=h();t(0,"div",57),s(1,"i",58),t(2,"h3",59),o(3,"Sin resultados en esta categor\xEDa"),n(),t(4,"button",60),g("click",function(){C(e);let l=u(2);return l.onSearch(""),l.minPriceInput.set(null),l.maxPriceInput.set(null),v(l.applyPriceFilter())}),o(5," Ver todos los productos "),n()()}}function Me(i,r){if(i&1){let e=h();t(0,"product-card",63),g("quickView",function(l){C(e);let c=u(3);return v(c.openQuickView(l))}),n()}if(i&2){let e=r.$implicit,a=r.$index;_("product",e)("isPriority",a<2)}}function Te(i,r){if(i&1&&(t(0,"div",62),s(1,"pagination",64),n()),i&2){let e=u(3);d(),_("pages",e.paginationData().pages)("currentPage",e.paginationService.currentPage())}}function Ve(i,r){if(i&1&&(t(0,"div",33),k(1,Me,1,2,"product-card",61,fe),n(),p(3,Te,2,2,"div",62)),i&2){let e=u(2);d(),E(e.productsRs.value().data),d(2),m(e.paginationData()?3:-1)}}function Be(i,r){if(i&1&&p(0,Ee,6,0,"div",57)(1,Ve,4,1),i&2){let e,a=u();m(((e=a.productsRs.value())==null?null:e.items)===0?0:1)}}function Ie(i,r){if(i&1&&(t(0,"li")(1,"a",65),o(2),n()()),i&2){let e,a=r.$implicit,l=u(2);d(),U("active",((e=l.currentCategory())==null?null:e.id)===a.id),_("routerLink",J(4,ve,a.slug)),d(),P(" ",a.name," ")}}function De(i,r){if(i&1&&k(0,Ie,3,6,"li",null,fe),i&2){let e=u();E(e.categoriesListRs.value().data)}}function Re(i,r){i&1&&(t(0,"span",73),o(1,"Sin Stock"),n())}function Fe(i,r){if(i&1&&(t(0,"span",79),o(1),B(2,"currency"),n()),i&2){let e=u();d(),b(I(2,1,e.regular_price))}}function Qe(i,r){if(i&1){let e=h();t(0,"div",68)(1,"div",71),s(2,"img",72),p(3,Re,2,0,"span",73),n(),t(4,"div",74)(5,"div",75)(6,"h3",76),o(7),n(),t(8,"div",77)(9,"span",78),o(10),B(11,"currency"),n(),p(12,Fe,3,3,"span",79),n(),t(13,"p",80),o(14),n()(),t(15,"button",81),g("click",function(){let l=C(e),c=u(2);return v(c.addToCart(l))}),s(16,"i",82),o(17," Agregar al Carrito "),n()()()}if(i&2){let e=r;d(2),_("src",e.image_url||"assets/img/no-image.png",A)("alt",e.name),d(),m((e.stock??0)<=0?3:-1),d(4),b(e.name),d(3),b(I(11,7,e.price)),d(2),m(e.regular_price&&e.regular_price>e.price?12:-1),d(2),b(e.description||"Sin descripci\xF3n disponible.")}}function Ne(i,r){if(i&1){let e=h();t(0,"div",54)(1,"div",66)(2,"button",67),g("click",function(){C(e);let l=u();return v(l.closeQuickView())}),o(3,"\u2715"),n(),p(4,Qe,18,9,"div",68),n(),t(5,"form",69)(6,"button",70),g("click",function(){C(e);let l=u();return v(l.closeQuickView())}),o(7,"close"),n()()()}if(i&2){let e,a=u();d(4),m((e=a.quickViewProduct())?4:-1,e)}}var R=class i{route=y(Y);router=y(Z);categoryService=y(ie);productService=y(ye);paginationService=y(me);cartService=y(ne);currentCategory=x(null);minPriceInput=x(null);maxPriceInput=x(null);categoriesListRs=D({stream:()=>this.categoryService.getFeaturedData()});searchQuery=x("");searchSubject=new Q;constructor(){this.searchSubject.pipe(O(400),L()).subscribe(r=>{this.updateQueryParams({q:r||null,_page:1})})}updateQueryParams(r){this.router.navigate([],{relativeTo:this.route,queryParams:r,queryParamsHandling:"merge"})}onSearch(r){this.searchQuery.set(r),this.searchSubject.next(r)}productsRs=D({stream:()=>j([this.route.params.pipe(q(({categorySlug:r})=>r)),this.route.queryParams]).pipe(V(([r,e])=>this.categoryService.getDataBySlug(r).pipe(z(a=>{this.currentCategory.set(a.data?.[0]||null)}),V(a=>{let l=a.data?.[0]?.id;if(!l)return N({first:1,prev:null,next:null,last:1,pages:1,items:0,data:[]});let c=+e._page||1,w=e._sort,S=e._order,f=e.min_price?+e.min_price:void 0,M=e.max_price?+e.max_price:void 0,T=e.q||void 0;return this.searchQuery()!==(T||"")&&this.searchQuery.set(T||""),this.minPriceInput()===null&&f&&this.minPriceInput.set(f),this.maxPriceInput()===null&&M&&this.maxPriceInput.set(M),this.productService.getData({category_id:l,_page:c,_sort:w,_order:S,min_price:f,max_price:M,q:T})}))))});paginationData=K(()=>{let r=this.productsRs.value();if(!r)return null;let l=r,{data:e}=l;return F(l,["data"])});isMobileFiltersOpen=x(!1);isQuickViewOpen=x(!1);quickViewProduct=x(null);toggleMobileFilters(){this.isMobileFiltersOpen.update(r=>!r)}openQuickView(r){this.quickViewProduct.set(r),this.isQuickViewOpen.set(!0)}closeQuickView(){this.isQuickViewOpen.set(!1),this.quickViewProduct.set(null)}addToCart(r){this.cartService.addToCart(r),this.closeQuickView()}applyPriceFilter(){this.router.navigate([],{relativeTo:this.route,queryParams:{min_price:this.minPriceInput(),max_price:this.maxPriceInput(),_page:1},queryParamsHandling:"merge"}),this.isMobileFiltersOpen.set(!1)}setSort(r,e="asc"){this.router.navigate([],{relativeTo:this.route,queryParams:{_sort:r,_order:e,_page:1},queryParamsHandling:"merge"})}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=$({type:i,selectors:[["products-by-category-page"]],decls:90,vars:13,consts:[[1,"drawer","lg:drawer-open"],["id","cat-filters-drawer","type","checkbox",1,"drawer-toggle"],[1,"drawer-content","flex","flex-col","min-h-screen","bg-gray-50","dark:bg-gray-900","transition-colors","duration-300"],[1,"lg:hidden","sticky","top-0","z-30","bg-white/80","dark:bg-gray-900/80","backdrop-blur-md","border-b","border-gray-200","dark:border-gray-800","px-4","py-3","flex","items-center","justify-between"],[1,"font-bold","text-gray-900","dark:text-white","truncate"],["for","cat-filters-drawer",1,"btn","btn-sm","btn-ghost","lg:hidden"],[1,"fas","fa-sliders-h","mr-2"],[1,"relative","bg-gray-900","text-white","overflow-hidden","isolate"],[1,"absolute","inset-0","bg-linear-to-br","from-indigo-900","via-blue-950","to-slate-900","opacity-90"],[1,"absolute","-bottom-32","-left-32","w-96","h-96","bg-indigo-600","rounded-full","mix-blend-overlay","filter","blur-3xl","opacity-20"],[1,"absolute","top-0","right-0","w-64","h-64","bg-teal-500","rounded-full","mix-blend-overlay","filter","blur-3xl","opacity-10"],[1,"relative","container","mx-auto","px-4","py-16","lg:py-24","text-center"],[1,"text-sm","breadcrumbs","text-indigo-200","justify-center","mb-6","hidden","md:flex"],["routerLink","/"],["routerLink","/productos"],[1,"font-semibold","text-white"],[1,"text-4xl","md:text-5xl","font-black","mb-6","tracking-tight","animate-fade-in-up"],[1,"text-lg","md:text-xl","text-gray-300","max-w-2xl","mx-auto","mb-8","font-light"],[1,"flex-1","container","mx-auto","px-4","py-12"],[1,"flex","flex-col","sm:flex-row","justify-between","items-center","mb-8","pb-4","border-b","border-gray-200","dark:border-gray-800","gap-4"],[1,"text-gray-600","dark:text-gray-400","font-medium","text-sm"],[1,"flex","items-center","gap-3"],[1,"relative","hidden","md:block"],[1,"fas","fa-search","absolute","left-3","top-1/2","-translate-y-1/2","text-gray-400"],["type","text",1,"input","input-bordered","input-sm","rounded-full","pl-9","w-64","focus:ring-2","focus:ring-indigo-500","bg-white","dark:bg-gray-800",3,"ngModelChange","ngModel","placeholder"],[1,"select","select-bordered","select-sm","rounded-full","bg-white","dark:bg-gray-800","border-gray-300","dark:border-gray-700","min-w-[150px]",3,"change"],["value","created_at|desc"],["value","price|asc"],["value","price|desc"],[1,"md:hidden","mb-6"],[1,"relative"],["type","text","placeholder","Buscar en esta categor\xEDa...",1,"input","input-bordered","w-full","rounded-2xl","pl-10",3,"ngModelChange","ngModel"],[1,"min-h-[400px]"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-3","gap-6"],[3,"message"],[1,"drawer-side","z-40"],["for","cat-filters-drawer","aria-label","close sidebar",1,"drawer-overlay","backdrop-blur-sm"],[1,"menu","p-6","w-80","min-h-full","bg-white","dark:bg-gray-800","text-base-content","border-r","border-gray-200","dark:border-gray-700"],[1,"flex","justify-between","items-center","mb-8"],[1,"text-xl","font-bold","text-gray-900","dark:text-white"],["for","cat-filters-drawer",1,"btn","btn-sm","btn-circle","btn-ghost"],[1,"space-y-8"],[1,"font-bold","text-gray-900","dark:text-white","mb-4","flex","items-center","gap-2"],[1,"fas","fa-tag","text-indigo-500"],[1,"flex","flex-col","gap-3"],[1,"form-control","w-full"],[1,"label","text-xs","text-gray-500"],[1,"absolute","left-3","top-3","text-gray-400"],["type","number","placeholder","0",1,"input","input-bordered","w-full","pl-8","rounded-xl",3,"ngModelChange","ngModel"],["type","number","placeholder","Max",1,"input","input-bordered","w-full","pl-8","rounded-xl",3,"ngModelChange","ngModel"],[1,"btn","btn-primary","w-full","mt-2","rounded-xl",3,"click"],[1,"fas","fa-layer-group","text-indigo-500"],[1,"max-h-60","overflow-y-auto","custom-scrollbar"],[1,"space-y-1"],[1,"modal","modal-open","z-50","animate-fade-in"],[1,"text-gray-900","dark:text-white","font-bold"],[1,"animate-pulse","bg-gray-200","dark:bg-gray-800","rounded-3xl","h-[400px]","w-full"],[1,"text-center","py-20","bg-white","dark:bg-gray-800","rounded-3xl","shadow-sm","border","border-gray-100","dark:border-gray-700"],[1,"fas","fa-search","text-4xl","text-gray-300","mb-4"],[1,"font-bold","text-lg","text-gray-900","dark:text-white"],[1,"btn","btn-link","text-indigo-600",3,"click"],[3,"product","isPriority"],[1,"mt-12","flex","justify-center"],[3,"quickView","product","isPriority"],[3,"pages","currentPage"],[1,"block","py-2","px-3","rounded-lg","hover:bg-gray-100","dark:hover:bg-gray-700","transition","text-sm",3,"routerLink"],[1,"modal-box","relative","max-w-4xl","bg-white","dark:bg-gray-800","rounded-3xl","p-0","overflow-hidden","shadow-2xl"],[1,"btn","btn-sm","btn-circle","btn-ghost","absolute","right-4","top-4","z-10","bg-white/50","backdrop-blur-md",3,"click"],[1,"flex","flex-col","md:flex-row","h-full"],["method","dialog",1,"modal-backdrop","bg-black/50","backdrop-blur-sm"],[3,"click"],[1,"w-full","md:w-1/2","bg-gray-50","dark:bg-gray-700/30","p-8","flex","items-center","justify-center","relative"],[1,"max-h-[300px]","object-contain","drop-shadow-xl",3,"src","alt"],[1,"absolute","top-8","left-8","badge","badge-error","text-white","font-bold","p-3"],[1,"w-full","md:w-1/2","p-8","flex","flex-col"],[1,"mb-auto"],[1,"font-black","text-2xl","md:text-3xl","mb-2","text-gray-900","dark:text-white","leading-tight"],[1,"flex","items-baseline","gap-3","mb-6"],[1,"text-4xl","font-bold","text-indigo-600","dark:text-indigo-400"],[1,"text-lg","text-gray-400","line-through"],[1,"text-gray-600","dark:text-gray-300","mb-6","leading-relaxed"],[1,"btn","btn-primary","btn-lg","w-full","rounded-2xl","shadow-xl","shadow-indigo-600/30","gap-3",3,"click"],[1,"fas","fa-shopping-cart"]],template:function(e,a){if(e&1&&(t(0,"div",0),s(1,"input",1),t(2,"div",2)(3,"div",3)(4,"h2",4),o(5),n(),t(6,"label",5),s(7,"i",6),o(8," Filtros "),n()(),t(9,"header",7),s(10,"div",8)(11,"div",9)(12,"div",10),t(13,"div",11)(14,"div",12)(15,"ul")(16,"li")(17,"a",13),o(18,"Inicio"),n()(),t(19,"li")(20,"a",14),o(21,"Productos"),n()(),t(22,"li",15),o(23),n()()(),t(24,"h1",16),o(25),n(),t(26,"p",17),o(27),n()()(),t(28,"div",18)(29,"div",19)(30,"div",20),p(31,he,4,1)(32,Pe,1,0),n(),t(33,"div",21)(34,"div",22),s(35,"i",23),t(36,"input",24),g("ngModelChange",function(c){return a.onSearch(c)}),n()(),t(37,"select",25),g("change",function(c){return a.setSort(c.target.value.split("|")[0],c.target.value.split("|")[1])}),t(38,"option",26),o(39,"M\xE1s Recientes"),n(),t(40,"option",27),o(41,"Precio: Menor a Mayor"),n(),t(42,"option",28),o(43,"Precio: Mayor a Menor"),n()()()(),t(44,"div",29)(45,"div",30),s(46,"i",23),t(47,"input",31),g("ngModelChange",function(c){return a.onSearch(c)}),n()()(),t(48,"main",32),p(49,Se,3,1,"div",33)(50,ke,1,1,"is-error",34)(51,Be,2,1),n()()(),t(52,"div",35),s(53,"label",36),t(54,"aside",37)(55,"div",38)(56,"h3",39),o(57,"Filtros"),n(),t(58,"label",40),o(59,"\u2715"),n()(),t(60,"div",41)(61,"div")(62,"h4",42),s(63,"i",43),o(64," Precio "),n(),t(65,"div",44)(66,"div",45)(67,"label",46),o(68,"M\xEDnimo"),n(),t(69,"div",30)(70,"span",47),o(71,"$"),n(),t(72,"input",48),g("ngModelChange",function(c){return a.minPriceInput.set(c)}),n()()(),t(73,"div",45)(74,"label",46),o(75,"M\xE1ximo"),n(),t(76,"div",30)(77,"span",47),o(78,"$"),n(),t(79,"input",49),g("ngModelChange",function(c){return a.maxPriceInput.set(c)}),n()()(),t(80,"button",50),g("click",function(){return a.applyPriceFilter()}),o(81," Aplicar "),n()()(),t(82,"div")(83,"h4",42),s(84,"i",51),o(85," Otras Secciones "),n(),t(86,"div",52)(87,"ul",53),p(88,De,2,0),n()()()()()()(),p(89,Ne,8,1,"div",54)),e&2){let l,c,w,S,f;d(5),P(" ",((l=a.currentCategory())==null?null:l.name)||"Categor\xEDa"," "),d(18),b(((c=a.currentCategory())==null?null:c.name)||"Cargando..."),d(2),P(" ",((w=a.currentCategory())==null?null:w.name)||"Explorando Categor\xEDa"," "),d(2),P(" ",((S=a.currentCategory())==null?null:S.description)||"Encontr\xE1 los mejores productos de esta secci\xF3n con calidad garantizada."," "),d(4),m(a.productsRs.value()?31:32),d(5),_("ngModel",a.searchQuery())("placeholder","Buscar en "+(((f=a.currentCategory())==null?null:f.name)||"esta secci\xF3n")+"..."),d(11),_("ngModel",a.searchQuery()),d(2),m(a.productsRs.isLoading()?49:a.productsRs.error()?50:a.productsRs.value()?51:-1),d(23),_("ngModel",a.minPriceInput()),d(7),_("ngModel",a.maxPriceInput()),d(9),m(a.categoriesListRs.value()?88:-1),d(),m(a.isQuickViewOpen()?89:-1)}},dependencies:[X,xe,be,_e,te,ee,pe,ce,ue,ge,re,se,ae,oe,de,le,W],encapsulation:2,changeDetection:0})},at=R;export{R as ProductsByCategoryPage,at as default};
