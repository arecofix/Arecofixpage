{
  "version": 3,
  "sources": ["src/app/shared/services/favorites.service.ts"],
  "sourcesContent": ["import { Injectable, signal, effect, inject, PLATFORM_ID } from '@angular/core';\r\nimport { isPlatformBrowser } from '@angular/common';\r\nimport { Product } from '@app/shared/interfaces/product.interface'; \r\nimport { LoggerService } from '@app/core/services/logger.service';\r\nimport { ToastService } from './toast.service';\r\n\r\n@Injectable({\r\n    providedIn: 'root'\r\n})\r\nexport class FavoritesService {\r\n    private logger = inject(LoggerService);\r\n    private toastService = inject(ToastService);\r\n    private platformId = inject(PLATFORM_ID);\r\n    \r\n    // Store array of products\r\n    favorites = signal<Product[]>([]);\r\n\r\n    constructor() {\r\n        if (isPlatformBrowser(this.platformId)) {\r\n            // Load favorites from local storage\r\n            const savedFavorites = localStorage.getItem('favorites');\r\n            if (savedFavorites) {\r\n                try {\r\n                    this.favorites.set(JSON.parse(savedFavorites));\r\n                } catch (e) {\r\n                    console.error('Error parsing favorites', e);\r\n                    this.favorites.set([]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Persist to local storage\r\n        effect(() => {\r\n            const currentFavorites = this.favorites();\r\n            if (isPlatformBrowser(this.platformId)) {\r\n                localStorage.setItem('favorites', JSON.stringify(currentFavorites));\r\n            }\r\n        });\r\n    }\r\n\r\n    toggleFavorite(product: Product) {\r\n        const exists = this.isFavorite(product.id);\r\n        if (exists) {\r\n            this.removeFavorite(product.id);\r\n        } else {\r\n            this.addFavorite(product);\r\n        }\r\n    }\r\n\r\n    addFavorite(product: Product) {\r\n        this.favorites.update(items => {\r\n            if (items.some(i => i.id === product.id)) return items;\r\n            return [...items, product];\r\n        });\r\n        this.logger.debug('Product added to favorites', { productName: product.name });\r\n        this.toastService.show('Agregado a favoritos', 'success');\r\n    }\r\n\r\n    removeFavorite(productId: string) {\r\n        this.favorites.update(items => items.filter(i => i.id !== productId));\r\n        this.logger.debug('Product removed from favorites', { productId });\r\n        this.toastService.show('Eliminado de favoritos', 'info');\r\n    }\r\n\r\n    isFavorite(productId: string): boolean {\r\n        return this.favorites().some(p => p.id === productId);\r\n    }\r\n    \r\n    // Helper signal to check reactive status inside templates easily if needed, \r\n    // though calling isFavorite() in a computed or effect is common.\r\n    // For templates, we might use a method or a pipe, but signals are fine.\r\n}\r\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;AASM,IAAO,mBAAP,MAAO,kBAAgB;EACjB,SAAS,OAAO,aAAa;EAC7B,eAAe,OAAO,YAAY;EAClC,aAAa,OAAO,WAAW;;EAGvC,YAAY,OAAkB,CAAA,GAAE,GAAA,YAAA,CAAA,EAAA,WAAA,YAAA,CAAA,IAAA,CAAA,CAAA;EAEhC,cAAA;AACI,QAAI,kBAAkB,KAAK,UAAU,GAAG;AAEpC,YAAM,iBAAiB,aAAa,QAAQ,WAAW;AACvD,UAAI,gBAAgB;AAChB,YAAI;AACA,eAAK,UAAU,IAAI,KAAK,MAAM,cAAc,CAAC;QACjD,SAAS,GAAG;AACR,kBAAQ,MAAM,2BAA2B,CAAC;AAC1C,eAAK,UAAU,IAAI,CAAA,CAAE;QACzB;MACJ;IACJ;AAGA,WAAO,MAAK;AACR,YAAM,mBAAmB,KAAK,UAAS;AACvC,UAAI,kBAAkB,KAAK,UAAU,GAAG;AACpC,qBAAa,QAAQ,aAAa,KAAK,UAAU,gBAAgB,CAAC;MACtE;IACJ,CAAC;EACL;EAEA,eAAe,SAAgB;AAC3B,UAAM,SAAS,KAAK,WAAW,QAAQ,EAAE;AACzC,QAAI,QAAQ;AACR,WAAK,eAAe,QAAQ,EAAE;IAClC,OAAO;AACH,WAAK,YAAY,OAAO;IAC5B;EACJ;EAEA,YAAY,SAAgB;AACxB,SAAK,UAAU,OAAO,WAAQ;AAC1B,UAAI,MAAM,KAAK,OAAK,EAAE,OAAO,QAAQ,EAAE;AAAG,eAAO;AACjD,aAAO,CAAC,GAAG,OAAO,OAAO;IAC7B,CAAC;AACD,SAAK,OAAO,MAAM,8BAA8B,EAAE,aAAa,QAAQ,KAAI,CAAE;AAC7E,SAAK,aAAa,KAAK,wBAAwB,SAAS;EAC5D;EAEA,eAAe,WAAiB;AAC5B,SAAK,UAAU,OAAO,WAAS,MAAM,OAAO,OAAK,EAAE,OAAO,SAAS,CAAC;AACpE,SAAK,OAAO,MAAM,kCAAkC,EAAE,UAAS,CAAE;AACjE,SAAK,aAAa,KAAK,0BAA0B,MAAM;EAC3D;EAEA,WAAW,WAAiB;AACxB,WAAO,KAAK,UAAS,EAAG,KAAK,OAAK,EAAE,OAAO,SAAS;EACxD;;qCAzDS,mBAAgB;EAAA;4EAAhB,mBAAgB,SAAhB,kBAAgB,WAAA,YAFb,OAAM,CAAA;;;sEAET,kBAAgB,CAAA;UAH5B;WAAW;MACR,YAAY;KACf;;;",
  "names": []
}
