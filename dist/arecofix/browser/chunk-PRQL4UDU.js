import{a as l}from"./chunk-TZSKIM7F.js";import{a as g}from"./chunk-IP3FEPB3.js";import{u as m}from"./chunk-Q44XB7TV.js";import{R as u,W as s,ma as n,oa as p,uc as d,xa as f}from"./chunk-DX2LKEMG.js";import{a as i,b as c}from"./chunk-C6Q5SG76.js";var I=class o{logger=s(g);toastService=s(l);platformId=s(f);cartItems=n([]);constructor(){if(m(this.platformId)){let t=localStorage.getItem("cart");if(t)try{let e=JSON.parse(t);Array.isArray(e)?this.cartItems.set(e.filter(a=>a&&a.product&&a.product.id)):this.cartItems.set([])}catch{this.cartItems.set([])}}p(()=>{let t=this.cartItems();m(this.platformId)&&localStorage.setItem("cart",JSON.stringify(t))})}addToCart(t){this.cartItems.update(e=>e.find(r=>r.product.id===t.id)?e.map(r=>r.product.id===t.id?c(i({},r),{quantity:r.quantity+1}):r):[...e,{product:t,quantity:1}]),this.logger.debug("Product added to cart",{productName:t.name}),this.toastService.show("Agregaste un producto al carrito","success",()=>this.openCart())}removeFromCart(t){this.cartItems.update(e=>e.filter(a=>a.product.id!==t))}updateQuantity(t,e){if(e<=0){this.removeFromCart(t);return}this.cartItems.update(a=>a.map(r=>r.product.id===t?c(i({},r),{quantity:e}):r))}clearCart(){this.cartItems.set([])}totalItems=d(()=>this.cartItems().reduce((t,e)=>t+(e.quantity||0),0));totalPrice=d(()=>this.cartItems().reduce((t,e)=>t+(e.product?.price||0)*(e.quantity||0),0));isCartOpen=n(!1);openCart(){this.isCartOpen.set(!0)}closeCart(){this.isCartOpen.set(!1)}toggleCart(){this.isCartOpen.update(t=>!t)}static \u0275fac=function(e){return new(e||o)};static \u0275prov=u({token:o,factory:o.\u0275fac,providedIn:"root"})};export{I as a};
