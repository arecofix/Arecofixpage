import{b as N,d as x,e as D,f as T,g as L,h as I,p as B,r as q}from"./chunk-GSH74JW6.js";import{a as F}from"./chunk-ZT4MGTUK.js";import{a as P,c as W,d as A}from"./chunk-VKJMBSB6.js";import"./chunk-7QORBSNT.js";import"./chunk-QGSRP5SS.js";import{m as E}from"./chunk-KW2FFXRI.js";import{Bb as o,Cb as S,Da as r,Db as w,Fb as d,Gb as s,Hb as g,Qa as M,V as f,ab as h,bb as c,gb as C,hb as i,ib as t,jb as _,la as u,rb as b,tb as v}from"./chunk-VQO264VU.js";import{a as y}from"./chunk-VOSPIT4N.js";function k(l,m){if(l&1&&(i(0,"div",7),_(1,"i",22),i(2,"span"),o(3),t()()),l&2){let a=v();r(3),S(a.error())}}function O(l,m){l&1&&_(0,"span",21)}var R=class l{route=f(P);router=f(W);auth=f(F);id=null;form=u({first_name:"",last_name:"",email:"",phone:"",address:"",dni:""},{});loading=u(!0,{});saving=u(!1,{});error=u(null,{});async ngOnInit(){if(this.id=this.route.snapshot.paramMap.get("id"),this.id){let m=this.auth.getSupabaseClient(),{data:a,error:e}=await m.from("profiles").select("*").eq("id",this.id).single();a&&this.form.set({first_name:a.first_name||"",last_name:a.last_name||"",email:a.email||"",phone:a.phone||"",address:a.address||"",dni:a.dni||""})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let m=this.auth.getSupabaseClient(),a=y({},this.form());try{if(this.id){let{error:e}=await m.from("profiles").update(a).eq("id",this.id);if(e)throw e}else throw new Error("Creaci\xF3n de nuevos usuarios debe hacerse desde el registro.");this.router.navigate(["/admin/clients"])}catch(e){this.error.set(e.message)}finally{this.saving.set(!1)}}static \u0275fac=function(a){return new(a||l)};static \u0275cmp=M({type:l,selectors:[["app-admin-client-form-page"]],decls:41,vars:11,consts:[[1,"max-w-4xl","mx-auto","text-gray-800"],[1,"flex","items-center","gap-4","mb-6"],["routerLink","/admin/clients",1,"btn","btn-circle","btn-ghost"],[1,"fas","fa-arrow-left"],[1,"text-2xl","font-bold","text-gray-800"],[3,"ngSubmit"],[1,"admin-form-section"],[1,"alert","alert-error","mb-6"],[1,"admin-form-grid"],[1,"admin-form-label"],["type","text","name","first_name","required","",1,"admin-form-input",3,"ngModelChange","ngModel"],["type","text","name","last_name","required","",1,"admin-form-input",3,"ngModelChange","ngModel"],[1,"mt-4"],["type","email","name","email",1,"admin-form-input",3,"ngModelChange","ngModel","disabled"],[1,"admin-form-grid","mt-4"],["type","text","name","phone",1,"admin-form-input",3,"ngModelChange","ngModel"],["type","text","name","dni",1,"admin-form-input",3,"ngModelChange","ngModel"],["type","text","name","address",1,"admin-form-input",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-4","mt-6"],["routerLink","/admin/clients",1,"btn","btn-ghost"],["type","submit",1,"btn","btn-primary","px-8",3,"disabled"],[1,"loading","loading-spinner","loading-xs","mr-2"],[1,"fas","fa-exclamation-circle"]],template:function(a,e){a&1&&(i(0,"div",0)(1,"div",1)(2,"a",2),_(3,"i",3),t(),i(4,"h1",4),o(5),t()(),i(6,"form",5),b("ngSubmit",function(){return e.save()}),i(7,"div",6),h(8,k,4,1,"div",7),i(9,"div",8)(10,"div")(11,"label",9),o(12,"Nombre"),t(),i(13,"input",10),g("ngModelChange",function(n){return s(e.form().first_name,n)||(e.form().first_name=n),n}),t()(),i(14,"div")(15,"label",9),o(16,"Apellido"),t(),i(17,"input",11),g("ngModelChange",function(n){return s(e.form().last_name,n)||(e.form().last_name=n),n}),t()()(),i(18,"div",12)(19,"label",9),o(20,"Email"),t(),i(21,"input",13),g("ngModelChange",function(n){return s(e.form().email,n)||(e.form().email=n),n}),t()(),i(22,"div",14)(23,"div")(24,"label",9),o(25,"Celular"),t(),i(26,"input",15),g("ngModelChange",function(n){return s(e.form().phone,n)||(e.form().phone=n),n}),t()(),i(27,"div")(28,"label",9),o(29,"DNI"),t(),i(30,"input",16),g("ngModelChange",function(n){return s(e.form().dni,n)||(e.form().dni=n),n}),t()()(),i(31,"div",12)(32,"label",9),o(33,"Direcci\xF3n"),t(),i(34,"input",17),g("ngModelChange",function(n){return s(e.form().address,n)||(e.form().address=n),n}),t()()(),i(35,"div",18)(36,"a",19),o(37,"Cancelar"),t(),i(38,"button",20),h(39,O,1,0,"span",21),o(40," Guardar "),t()()()()),a&2&&(r(5),w("",e.id?"Editar":"Nuevo"," Cliente"),r(3),c(e.error()?8:-1),r(5),d("ngModel",e.form().first_name),r(4),d("ngModel",e.form().last_name),r(4),d("ngModel",e.form().email),C("disabled",!!e.id),r(5),d("ngModel",e.form().phone),r(4),d("ngModel",e.form().dni),r(4),d("ngModel",e.form().address),r(4),C("disabled",e.saving()),r(),c(e.saving()?39:-1))},dependencies:[E,q,I,N,x,D,B,L,T,A],encapsulation:2})};export{R as AdminClientFormPage};
