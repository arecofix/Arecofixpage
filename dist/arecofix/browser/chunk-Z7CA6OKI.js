import{a as G}from"./chunk-6JVXZ3Z3.js";import{b as $,d as q,g as z,l as B,m as K,n as R,s as H}from"./chunk-SBGT4JRR.js";import{a as Z}from"./chunk-JFUTRVJB.js";import"./chunk-VGQVHFGG.js";import"./chunk-FOCRVBU7.js";import"./chunk-NIOBXWFE.js";import{a as Q,d as U}from"./chunk-FNG3N4ES.js";import{g as V,h as O,i as T,n as L,o as j}from"./chunk-ZF2WZNXG.js";import{Ab as l,Bb as t,Cb as r,Db as c,Dc as D,Jb as N,Nb as b,Pb as _,Qa as P,Tb as F,Va as n,X as y,Xb as a,Yb as v,Zb as p,aa as x,ba as f,hb as M,jc as S,lc as w,mb as h,na as g,nc as E,oc as C,ub as I,vb as A,vc as k}from"./chunk-J6ZEXR2D.js";import"./chunk-7CGTOI24.js";var W=(o,i,e)=>({"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":o,"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/30 dark:text-yellow-400":i,"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400":e}),X=o=>["/admin/products",o];function Y(o,i){o&1&&(t(0,"div",24),c(1,"span",27),r())}function ee(o,i){if(o&1&&(t(0,"div",25),c(1,"i",28),t(2,"span"),a(3),r()()),o&2){let e=_();n(3),v(e.error())}}function te(o,i){if(o&1&&(t(0,"div",37)(1,"div",38)(2,"div",39),c(3,"img",40),r(),t(4,"div",41)(5,"div",42)(6,"div")(7,"div",43),a(8),r(),t(9,"div",44),a(10),r()(),t(11,"div",45),a(12),E(13,"currency"),r()(),t(14,"div",46)(15,"span",47),a(16),r(),t(17,"span",47),a(18),r()(),t(19,"div",48)(20,"a",49),c(21,"i",50),a(22," Editar "),r()()()()()),o&2){let e=i.$implicit;n(3),l("src",e.image_url||"assets/placeholder.png",P)("alt",e.name),n(5),v(e.name),n(2),p("SKU: ",e.sku||"N/A"),n(2),v(C(13,10,e.price)),n(3),l("ngClass",w(12,W,e.stock>10,e.stock<=10&&e.stock>0,e.stock===0)),n(),p(" ",e.stock," un. "),n(),l("ngClass",e.is_active?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"),n(),p(" ",e.is_active?"Activo":"Inactivo"," "),n(2),l("routerLink",S(16,X,e.id))}}function re(o,i){if(o&1&&(t(0,"tr",51)(1,"td",52)(2,"div",53)(3,"div",54),c(4,"img",55),r(),t(5,"div",56)(6,"div",57),a(7),r(),t(8,"div",58),a(9),r()()()(),t(10,"td",59)(11,"div",60),a(12),E(13,"currency"),r()(),t(14,"td",59)(15,"span",61),a(16),r()(),t(17,"td",59)(18,"span",61),a(19),r()(),t(20,"td",62)(21,"a",63),c(22,"i",64),r()()()),o&2){let e=i.$implicit;n(4),l("src",e.image_url||"assets/placeholder.png",P)("alt",e.name),n(3),v(e.name),n(2),p("SKU: ",e.sku||"N/A"),n(3),v(C(13,10,e.price)),n(3),l("ngClass",w(12,W,e.stock>10,e.stock<=10&&e.stock>0,e.stock===0)),n(),p(" ",e.stock," unidades "),n(2),l("ngClass",e.is_active?"bg-green-100 text-green-800 dark:bg-green-900/30 dark:text-green-400":"bg-red-100 text-red-800 dark:bg-red-900/30 dark:text-red-400"),n(),p(" ",e.is_active?"Activo":"Inactivo"," "),n(2),l("routerLink",S(16,X,e.id))}}function ie(o,i){o&1&&(t(0,"tr")(1,"td",65)(2,"div",66),c(3,"i",67),t(4,"p",68),a(5,"No se encontraron productos"),r()()()())}function ne(o,i){if(o&1&&(t(0,"div",69),c(1,"pagination",70),r()),o&2){let e=_(2);n(),l("pages",e.totalPages())("currentPage",e.currentPage())}}function ae(o,i){if(o&1&&(t(0,"div",26)(1,"div",29),h(2,te,23,18,"div",30),r(),t(3,"div",31)(4,"table",32)(5,"thead")(6,"tr",33)(7,"th"),a(8,"Producto"),r(),t(9,"th"),a(10,"Precio"),r(),t(11,"th"),a(12,"Stock"),r(),t(13,"th"),a(14,"Estado"),r(),t(15,"th"),a(16,"Acciones"),r()()(),t(17,"tbody"),h(18,re,23,18,"tr",34)(19,ie,6,0,"tr",35),r()()(),h(20,ne,2,2,"div",36),r()),o&2){let e=_();n(2),l("ngForOf",e.paginatedProducts()),n(16),l("ngForOf",e.paginatedProducts()),n(),l("ngIf",e.paginatedProducts().length===0),n(),l("ngIf",e.products().length>0)}}var J=class o{productService=y(G);cdr=y(D);route=y(Q);products=g([]);searchQuery=g("");sortOrder=g("name_asc");currentPage=g(1);itemsPerPage=g(10);loading=g(!0);error=g(null);allFilteredProducts=k(()=>{let i=this.searchQuery().toLowerCase(),e=this.products();i&&(e=e.filter(d=>d.name.toLowerCase().includes(i)||d.slug?.toLowerCase().includes(i)||d.sku?.toLowerCase().includes(i)||d.barcode?.toLowerCase().includes(i)));let s=this.sortOrder();return e.sort((d,m)=>{switch(s){case"price_asc":return d.price-m.price;case"price_desc":return m.price-d.price;case"stock_asc":return d.stock-m.stock;case"stock_desc":return m.stock-d.stock;case"name_asc":default:return d.name.localeCompare(m.name)}})});paginatedProducts=k(()=>{let i=this.allFilteredProducts(),e=this.currentPage(),s=this.itemsPerPage(),d=(e-1)*s;return i.slice(d,d+s)});totalPages=k(()=>Math.ceil(this.allFilteredProducts().length/this.itemsPerPage()));async ngOnInit(){this.route.queryParams.subscribe(i=>{let e=i._page?Number(i._page):1;this.currentPage.set(e||1)});try{let i=await this.productService.getProducts();this.products.set(i)}catch(i){this.error.set(i.message||"Error al cargar productos")}finally{this.loading.set(!1)}}async exportProducts(){try{this.loading.set(!0),await this.productService.exportProductsToCSV()}catch(i){this.error.set(i.message||"Error al exportar productos")}finally{this.loading.set(!1)}}async importProducts(i){let e=i.target.files[0];if(e)try{this.loading.set(!0);let s=await this.productService.importProductsFromCSV(e);alert(`Importaci\xF3n completada: ${s.success} productos importados/actualizados. ${s.errors} errores.`);let d=await this.productService.getProducts();this.products.set(d)}catch(s){this.error.set(s.message||"Error al importar productos")}finally{this.loading.set(!1),i.target.value=""}}updateSort(i){let e=i.target.value;this.sortOrder.set(e)}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=M({type:o,selectors:[["app-admin-products-page"]],decls:36,vars:3,consts:[["fileInput",""],[1,"flex","flex-col","md:flex-row","justify-between","items-center","mb-6","gap-4","md:gap-0"],[1,"text-2xl","font-bold","text-gray-800","dark:text-green-400","self-start","md:self-auto"],[1,"grid","grid-cols-2","gap-2","w-full","md:w-auto","md:flex"],[1,"btn","btn-outline","btn-primary","w-full","md:w-auto",3,"click"],[1,"fas","fa-file-export","mr-2"],[1,"btn","btn-outline","btn-secondary","w-full","md:w-auto",3,"click"],[1,"fas","fa-file-import","mr-2"],["type","file","accept",".csv",1,"hidden",3,"change"],["routerLink","/admin/products/new",1,"btn","btn-primary","col-span-2","w-full","md:w-auto"],[1,"fas","fa-plus","mr-2"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-6"],[1,"form-control"],[1,"input-group"],["type","text","placeholder","Buscar por nombre, SKU o c\xF3digo de barras...",1,"input","input-bordered","w-full","bg-base-100","text-base-content",3,"ngModelChange","ngModel"],[1,"btn","btn-square"],[1,"fas","fa-search"],[1,"flex","justify-end"],[1,"select","select-bordered","bg-base-100","text-base-content","max-w-xs",3,"change","ngModel"],["value","name_asc"],["value","price_asc"],["value","price_desc"],["value","stock_asc"],["value","stock_desc"],[1,"flex","justify-center","py-12"],[1,"alert","alert-error"],[1,"bg-white","rounded-lg","shadow","overflow-hidden","text-gray-800","dark:text-white","dark:bg-gray-800"],[1,"loading","loading-spinner","loading-lg"],[1,"fas","fa-exclamation-circle"],[1,"md:hidden"],["class","p-4 border-b border-gray-100 dark:border-gray-800 hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors",4,"ngFor","ngForOf"],[1,"hidden","md:block","overflow-x-auto"],[1,"table","w-full"],[1,"text-gray-800","dark:text-white"],["class","hover:bg-gray-50 dark:hover:bg-gray-800/50 transition-colors border-b border-gray-100 dark:border-gray-800",4,"ngFor","ngForOf"],[4,"ngIf"],["class","p-4 border-t border-gray-200 dark:border-gray-800 flex justify-center",4,"ngIf"],[1,"p-4","border-b","border-gray-100","dark:border-gray-800","hover:bg-gray-50","dark:hover:bg-gray-800/50","transition-colors"],[1,"flex","items-start","gap-3"],[1,"h-12","w-12","shrink-0"],[1,"h-12","w-12","rounded-lg","object-cover","border","border-gray-200","dark:border-gray-700",3,"src","alt"],[1,"flex-1","min-w-0"],[1,"flex","justify-between","items-start"],[1,"text-sm","font-medium","text-gray-900","dark:text-white","line-clamp-1"],[1,"text-xs","text-gray-500","dark:text-gray-400"],[1,"text-sm","font-bold","text-indigo-600","dark:text-indigo-400","ml-2"],[1,"mt-2","flex","flex-wrap","gap-2","items-center","text-xs"],[1,"px-2","py-0.5","rounded-full",3,"ngClass"],[1,"mt-3","flex","justify-end"],[1,"btn","btn-xs","btn-ghost","text-indigo-600","dark:text-indigo-400",3,"routerLink"],[1,"fas","fa-edit","mr-1"],[1,"hover:bg-gray-50","dark:hover:bg-gray-800/50","transition-colors","border-b","border-gray-100","dark:border-gray-800"],[1,"px-6","py-4"],[1,"flex","items-center"],[1,"h-10","w-10","shrink-0"],[1,"h-10","w-10","rounded-full","object-cover","border","border-gray-200","dark:border-gray-700",3,"src","alt"],[1,"ml-4"],[1,"text-sm","font-medium","text-gray-900","dark:text-white"],[1,"text-sm","text-gray-500","dark:text-gray-400"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","text-gray-900","dark:text-white","font-medium"],[1,"px-2","inline-flex","text-xs","leading-5","font-semibold","rounded-full",3,"ngClass"],[1,"px-6","py-4","whitespace-nowrap","text-right","text-sm","font-medium"],[1,"text-indigo-600","dark:text-indigo-400","hover:text-indigo-900","dark:hover:text-indigo-300","mr-4","transition-colors",3,"routerLink"],[1,"fas","fa-edit"],["colspan","5",1,"px-6","py-12","text-center","text-gray-500","dark:text-gray-400"],[1,"flex","flex-col","items-center","justify-center"],[1,"fas","fa-search","text-4xl","mb-4","text-gray-300","dark:text-gray-600"],[1,"text-lg"],[1,"p-4","border-t","border-gray-200","dark:border-gray-800","flex","justify-center"],[3,"pages","currentPage"]],template:function(e,s){if(e&1){let d=N();t(0,"div",1)(1,"h1",2),a(2,"Productos"),r(),t(3,"div",3)(4,"button",4),b("click",function(){return x(d),f(s.exportProducts())}),c(5,"i",5),a(6," Exportar CSV "),r(),t(7,"button",6),b("click",function(){x(d);let u=F(11);return f(u.click())}),c(8,"i",7),a(9," Importar CSV "),r(),t(10,"input",8,0),b("change",function(u){return x(d),f(s.importProducts(u))}),r(),t(12,"a",9),c(13,"i",10),a(14," Nuevo Producto "),r()()(),t(15,"div",11)(16,"div",12)(17,"div",13)(18,"input",14),b("ngModelChange",function(u){return x(d),f(s.searchQuery.set(u))}),r(),t(19,"button",15),c(20,"i",16),r()()(),t(21,"div",17)(22,"select",18),b("change",function(u){return x(d),f(s.updateSort(u))}),t(23,"option",19),a(24,"Nombre (A-Z)"),r(),t(25,"option",20),a(26,"Precio: Menor a Mayor"),r(),t(27,"option",21),a(28,"Precio: Mayor a Menor"),r(),t(29,"option",22),a(30,"Stock: Menor a Mayor"),r(),t(31,"option",23),a(32,"Stock: Mayor a Menor"),r()()()(),I(33,Y,2,0,"div",24)(34,ee,4,1,"div",25)(35,ae,21,4,"div",26)}e&2&&(n(18),l("ngModel",s.searchQuery()),n(4),l("ngModel",s.sortOrder()),n(11),A(s.loading()?33:s.error()?34:35))},dependencies:[j,V,O,T,U,H,K,R,$,B,q,z,Z,L],encapsulation:2,changeDetection:0})};export{J as AdminProductsPage};
