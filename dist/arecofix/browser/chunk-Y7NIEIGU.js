import{b as F,d as N,e as D,f as T,g as L,h as I,p as B,s as q}from"./chunk-LSPUXVBI.js";import{a as A}from"./chunk-4HXPTVC3.js";import"./chunk-773BQMTG.js";import"./chunk-NIOBXWFE.js";import{b as E,d as P,e as W}from"./chunk-755N3HP6.js";import{o as x}from"./chunk-P77MY6VE.js";import{Bb as _,Cb as n,Db as i,Eb as b,Ob as v,Qb as M,Wa as o,Y as f,Yb as r,Zb as w,_b as S,ac as s,bc as m,cc as g,ib as C,oa as p,vb as c,wb as h}from"./chunk-OOA6GWW3.js";import{a as y}from"./chunk-7CGTOI24.js";function R(l,d){if(l&1&&(n(0,"div",7),b(1,"i",22),n(2,"span"),r(3),i()()),l&2){let a=M();o(3),w(a.error())}}function O(l,d){l&1&&b(0,"span",21)}var k=class l{route=f(E);router=f(P);auth=f(A);id=null;form=p({first_name:"",last_name:"",email:"",phone:"",address:"",dni:""});loading=p(!0);saving=p(!1);error=p(null);async ngOnInit(){if(this.id=this.route.snapshot.paramMap.get("id"),this.id){let d=this.auth.getSupabaseClient(),{data:a,error:e}=await d.from("profiles").select("*").eq("id",this.id).single();a&&this.form.set({first_name:a.first_name||"",last_name:a.last_name||"",email:a.email||"",phone:a.phone||"",address:a.address||"",dni:a.dni||""})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let d=this.auth.getSupabaseClient(),a=y({},this.form());try{if(this.id){let{error:e}=await d.from("profiles").update(a).eq("id",this.id);if(e)throw e}else throw new Error("Creaci\xF3n de nuevos usuarios debe hacerse desde el registro.");this.router.navigate(["/admin/clients"])}catch(e){this.error.set(e.message)}finally{this.saving.set(!1)}}static \u0275fac=function(a){return new(a||l)};static \u0275cmp=C({type:l,selectors:[["app-admin-client-form-page"]],decls:41,vars:11,consts:[[1,"max-w-4xl","mx-auto","text-base-content"],[1,"flex","items-center","gap-4","mb-6"],["routerLink","/admin/clients",1,"btn","btn-circle","btn-ghost","text-base-content"],[1,"fas","fa-arrow-left"],[1,"text-2xl","font-bold","text-green-600"],[3,"ngSubmit"],[1,"bg-base-100","p-6","rounded-xl","shadow-sm","border","border-base-200","mb-6","text-base-content"],[1,"alert","alert-error","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-base-content","mb-1.5"],["type","text","name","first_name","required","",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],["type","text","name","last_name","required","",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],[1,"mt-4"],["type","email","name","email",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel","disabled"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mt-4"],["type","text","name","phone",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],["type","text","name","dni",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],["type","text","name","address",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-4","mt-6"],["routerLink","/admin/clients",1,"btn","btn-ghost"],["type","submit",1,"btn","btn-primary","px-8",3,"disabled"],[1,"loading","loading-spinner","loading-xs","mr-2"],[1,"fas","fa-exclamation-circle"]],template:function(a,e){a&1&&(n(0,"div",0)(1,"div",1)(2,"a",2),b(3,"i",3),i(),n(4,"h1",4),r(5),i()(),n(6,"form",5),v("ngSubmit",function(){return e.save()}),n(7,"div",6),c(8,R,4,1,"div",7),n(9,"div",8)(10,"div")(11,"label",9),r(12,"Nombre"),i(),n(13,"input",10),g("ngModelChange",function(t){return m(e.form().first_name,t)||(e.form().first_name=t),t}),i()(),n(14,"div")(15,"label",9),r(16,"Apellido"),i(),n(17,"input",11),g("ngModelChange",function(t){return m(e.form().last_name,t)||(e.form().last_name=t),t}),i()()(),n(18,"div",12)(19,"label",9),r(20,"Email"),i(),n(21,"input",13),g("ngModelChange",function(t){return m(e.form().email,t)||(e.form().email=t),t}),i()(),n(22,"div",14)(23,"div")(24,"label",9),r(25,"Celular"),i(),n(26,"input",15),g("ngModelChange",function(t){return m(e.form().phone,t)||(e.form().phone=t),t}),i()(),n(27,"div")(28,"label",9),r(29,"DNI"),i(),n(30,"input",16),g("ngModelChange",function(t){return m(e.form().dni,t)||(e.form().dni=t),t}),i()()(),n(31,"div",12)(32,"label",9),r(33,"Direcci\xF3n"),i(),n(34,"input",17),g("ngModelChange",function(t){return m(e.form().address,t)||(e.form().address=t),t}),i()()(),n(35,"div",18)(36,"a",19),r(37,"Cancelar"),i(),n(38,"button",20),c(39,O,1,0,"span",21),r(40," Guardar "),i()()()()),a&2&&(o(5),S("",e.id?"Editar":"Nuevo"," Cliente"),o(3),h(e.error()?8:-1),o(5),s("ngModel",e.form().first_name),o(4),s("ngModel",e.form().last_name),o(4),s("ngModel",e.form().email),_("disabled",!!e.id),o(5),s("ngModel",e.form().phone),o(4),s("ngModel",e.form().dni),o(4),s("ngModel",e.form().address),o(4),_("disabled",e.saving()),o(),h(e.saving()?39:-1))},dependencies:[x,q,I,F,N,D,B,L,T,W],encapsulation:2})};export{k as AdminClientFormPage};
