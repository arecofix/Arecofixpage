import{b as N,d as D,e as T,f as x,g as L,h as I,p as B,r as q}from"./chunk-67JN6MIM.js";import{a as F}from"./chunk-ETUYVYEI.js";import"./chunk-23BTM2IY.js";import{a as P,c as W,d as A}from"./chunk-ZWPO54DG.js";import"./chunk-SH266SLM.js";import"./chunk-Z5OW2DIK.js";import{p as E}from"./chunk-DTICAINP.js";import{Fa as r,Fb as o,Gb as S,Hb as w,Jb as m,Kb as s,Lb as g,Ta as b,W as f,eb as h,fb as _,kb as C,lb as n,ma as u,mb as i,nb as c,vb as M,xb as v}from"./chunk-RGAVNK56.js";import{a as y}from"./chunk-VOSPIT4N.js";function k(l,d){if(l&1&&(n(0,"div",6),c(1,"i",21),n(2,"span"),o(3),i()()),l&2){let a=v();r(3),S(a.error())}}function O(l,d){l&1&&c(0,"span",20)}var R=class l{route=f(P);router=f(W);auth=f(F);id=null;form=u({first_name:"",last_name:"",email:"",phone:"",address:"",dni:""});loading=u(!0);saving=u(!1);error=u(null);async ngOnInit(){if(this.id=this.route.snapshot.paramMap.get("id"),this.id){let d=this.auth.getSupabaseClient(),{data:a,error:e}=await d.from("profiles").select("*").eq("id",this.id).single();a&&this.form.set({first_name:a.first_name||"",last_name:a.last_name||"",email:a.email||"",phone:a.phone||"",address:a.address||"",dni:a.dni||""})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let d=this.auth.getSupabaseClient(),a=y({},this.form());try{if(this.id){let{error:e}=await d.from("profiles").update(a).eq("id",this.id);if(e)throw e}else throw new Error("Creaci\xF3n de nuevos usuarios debe hacerse desde el registro.");this.router.navigate(["/admin/clients"])}catch(e){this.error.set(e.message)}finally{this.saving.set(!1)}}static \u0275fac=function(a){return new(a||l)};static \u0275cmp=b({type:l,selectors:[["app-admin-client-form-page"]],decls:41,vars:11,consts:[[1,"max-w-2xl","mx-auto"],[1,"flex","items-center","gap-4","mb-6"],["routerLink","/admin/clients",1,"btn","btn-circle","btn-ghost"],[1,"fas","fa-arrow-left"],[1,"text-2xl","font-bold","text-gray-800"],[1,"bg-white","rounded-lg","shadow","p-6"],[1,"alert","alert-error","mb-4"],[1,"space-y-4",3,"ngSubmit"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4"],[1,"form-control"],[1,"label"],["type","text","name","first_name","required","",1,"input","input-bordered",3,"ngModelChange","ngModel"],["type","text","name","last_name","required","",1,"input","input-bordered",3,"ngModelChange","ngModel"],["type","email","name","email",1,"input","input-bordered",3,"ngModelChange","ngModel","disabled"],["type","text","name","phone",1,"input","input-bordered",3,"ngModelChange","ngModel"],["type","text","name","dni",1,"input","input-bordered",3,"ngModelChange","ngModel"],["type","text","name","address",1,"input","input-bordered",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-4","mt-6"],["routerLink","/admin/clients",1,"btn","btn-ghost"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"loading","loading-spinner"],[1,"fas","fa-exclamation-circle"]],template:function(a,e){a&1&&(n(0,"div",0)(1,"div",1)(2,"a",2),c(3,"i",3),i(),n(4,"h1",4),o(5),i()(),n(6,"div",5),h(7,k,4,1,"div",6),n(8,"form",7),M("ngSubmit",function(){return e.save()}),n(9,"div",8)(10,"div",9)(11,"label",10),o(12,"Nombre"),i(),n(13,"input",11),g("ngModelChange",function(t){return s(e.form().first_name,t)||(e.form().first_name=t),t}),i()(),n(14,"div",9)(15,"label",10),o(16,"Apellido"),i(),n(17,"input",12),g("ngModelChange",function(t){return s(e.form().last_name,t)||(e.form().last_name=t),t}),i()()(),n(18,"div",9)(19,"label",10),o(20,"Email"),i(),n(21,"input",13),g("ngModelChange",function(t){return s(e.form().email,t)||(e.form().email=t),t}),i()(),n(22,"div",8)(23,"div",9)(24,"label",10),o(25,"Celular"),i(),n(26,"input",14),g("ngModelChange",function(t){return s(e.form().phone,t)||(e.form().phone=t),t}),i()(),n(27,"div",9)(28,"label",10),o(29,"DNI"),i(),n(30,"input",15),g("ngModelChange",function(t){return s(e.form().dni,t)||(e.form().dni=t),t}),i()()(),n(31,"div",9)(32,"label",10),o(33,"Direcci\xF3n"),i(),n(34,"input",16),g("ngModelChange",function(t){return s(e.form().address,t)||(e.form().address=t),t}),i()(),n(35,"div",17)(36,"a",18),o(37,"Cancelar"),i(),n(38,"button",19),h(39,O,1,0,"span",20),o(40," Guardar "),i()()()()()),a&2&&(r(5),w("",e.id?"Editar":"Nuevo"," Cliente"),r(2),_(e.error()?7:-1),r(6),m("ngModel",e.form().first_name),r(4),m("ngModel",e.form().last_name),r(4),m("ngModel",e.form().email),C("disabled",!!e.id),r(5),m("ngModel",e.form().phone),r(4),m("ngModel",e.form().dni),r(4),m("ngModel",e.form().address),r(4),C("disabled",e.saving()),r(),_(e.saving()?39:-1))},dependencies:[E,q,I,N,D,T,B,L,x,A],encapsulation:2})};export{R as AdminClientFormPage};
