import{a as T,b as L,d as k,e as I,f as B,g as V,h as j,l as q,m as O,n as R,p as G,s as U}from"./chunk-BUQ7SEQN.js";import{a as D}from"./chunk-MSD3KBTG.js";import"./chunk-HWKWYSDO.js";import{e as F,g as W,h as N}from"./chunk-YWFIYZRP.js";import"./chunk-HLAW74BB.js";import"./chunk-T7AXESXA.js";import{r as A}from"./chunk-I5WECENP.js";import{Ab as w,Bb as h,Cb as t,Db as n,Eb as b,Ob as M,Qb as _,Wa as s,Xb as E,Y as y,Yb as o,Zb as x,_b as P,ac as m,bc as g,cc as u,ib as v,oa as c,vb as p,wb as f,zb as S}from"./chunk-4GKTJ7DD.js";import{a as C}from"./chunk-VOSPIT4N.js";var H=(r,l)=>l.id;function J(r,l){if(r&1&&(t(0,"div",7),b(1,"i",33),t(2,"span"),o(3),n()()),r&2){let a=_();s(3),x(a.error())}}function K(r,l){if(r&1&&b(0,"i",34),r&2){let a=_();E(a.form().image_url)}}function Q(r,l){r&1&&(t(0,"span",17),o(1,"N/A"),n())}function X(r,l){if(r&1&&(t(0,"option",35),o(1),n()),r&2){let a=_().$implicit;h("value",a.id),s(),x(a.name)}}function Y(r,l){if(r&1&&p(0,X,2,2,"option",35),r&2){let a=l.$implicit,e=_();f(a.id!==e.id?0:-1)}}function Z(r,l){r&1&&b(0,"span",32)}var z=class r{route=y(F);router=y(W);auth=y(D);id=null;categories=c([]);form=c({name:"",slug:"",description:"",image_url:"",type:"product",parent_id:"",is_active:!0});loading=c(!0);saving=c(!1);error=c(null);async ngOnInit(){this.id=this.route.snapshot.paramMap.get("id");let l=this.auth.getSupabaseClient(),{data:a}=await l.from("categories").select("id, name").eq("is_active",!0).order("name");if(a&&this.categories.set(a),this.id){let{data:e,error:d}=await l.from("categories").select("*").eq("id",this.id).single();e&&this.form.set({name:e.name,slug:e.slug,description:e.description||"",image_url:e.image_url||e.icon||"",type:e.type,parent_id:e.parent_id||null,is_active:e.is_active})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let l=this.auth.getSupabaseClient(),a=C({},this.form());a.slug||(a.slug=this.slugify(a.name));try{if(this.id){let{error:e}=await l.from("categories").update(a).eq("id",this.id);if(e)throw e}else{let{error:e}=await l.from("categories").insert(a);if(e)throw e}this.router.navigate(["/admin/categories"])}catch(e){this.error.set(e.message)}finally{this.saving.set(!1)}}slugify(l){return l.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-")}static \u0275fac=function(a){return new(a||r)};static \u0275cmp=v({type:r,selectors:[["app-admin-category-form-page"]],decls:62,vars:13,consts:[[1,"max-w-4xl","mx-auto","text-base-content"],[1,"flex","items-center","gap-4","mb-6"],["routerLink","/admin/categories",1,"btn","btn-circle","btn-ghost","text-base-content"],[1,"fas","fa-arrow-left"],[1,"text-2xl","font-bold","text-green-600"],[3,"ngSubmit"],[1,"bg-base-100","p-6","rounded-xl","shadow-sm","border","border-base-200","mb-6","text-base-content"],[1,"alert","alert-error","mb-6"],[1,"mb-4"],[1,"block","text-sm","font-medium","text-base-content","mb-1.5"],["type","text","name","name","required","",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],["type","text","name","slug","placeholder","Se genera autom\xE1ticamente si se deja vac\xEDo",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],["name","description","rows","4",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],[1,"flex","gap-4"],["type","text","name","image_url","placeholder","Ej: fas fa-mobile-alt",1,"flex-1","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],[1,"w-12","h-10","flex","items-center","justify-center","bg-base-200","rounded-lg","border","border-base-300"],[1,"text-xl","text-primary",3,"class"],[1,"text-xs","text-base-content/50"],[1,"text-xs","text-base-content/60","mt-1"],["name","type",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],["value","product"],["value","course"],["value","service"],["name","parent_id",1,"w-full","bg-base-100","text-base-content","border","border-base-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-base-content/40",3,"ngModelChange","ngModel"],[3,"ngValue"],[1,"mt-6"],[1,"flex","items-center","gap-3","p-3","bg-base-100","border","border-base-300","rounded-lg","hover:bg-base-200","transition-colors","cursor-pointer","w-fit"],["type","checkbox","name","is_active",1,"checkbox","checkbox-primary","h-5","w-5","rounded","border-base-300",3,"ngModelChange","ngModel"],[1,"font-medium","text-base-content"],[1,"flex","justify-end","gap-4","mt-6"],["routerLink","/admin/categories",1,"btn","btn-error","text-white"],["type","submit",1,"btn","btn-primary","px-8",3,"disabled"],[1,"loading","loading-spinner","loading-xs","mr-2"],[1,"fas","fa-exclamation-circle"],[1,"text-xl","text-primary"],[3,"value"]],template:function(a,e){a&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),b(3,"i",3),n(),t(4,"h1",4),o(5),n()(),t(6,"form",5),M("ngSubmit",function(){return e.save()}),t(7,"div",6),p(8,J,4,1,"div",7),t(9,"div",8)(10,"label",9),o(11,"Nombre"),n(),t(12,"input",10),u("ngModelChange",function(i){return g(e.form().name,i)||(e.form().name=i),i}),n()(),t(13,"div",8)(14,"label",9),o(15,"Slug (URL)"),n(),t(16,"input",11),u("ngModelChange",function(i){return g(e.form().slug,i)||(e.form().slug=i),i}),n()(),t(17,"div",8)(18,"label",9),o(19,"Descripci\xF3n"),n(),t(20,"textarea",12),u("ngModelChange",function(i){return g(e.form().description,i)||(e.form().description=i),i}),n()(),t(21,"div",8)(22,"label",9),o(23,"Icono (Font Awesome)"),n(),t(24,"div",13)(25,"input",14),u("ngModelChange",function(i){return g(e.form().image_url,i)||(e.form().image_url=i),i}),n(),t(26,"div",15),p(27,K,1,2,"i",16)(28,Q,2,0,"span",17),n()(),t(29,"p",18),o(30,"Usa clases de Font Awesome (ej: fas fa-mobile-alt, fas fa-laptop)"),n()(),t(31,"div",8)(32,"label",9),o(33,"Tipo"),n(),t(34,"select",19),u("ngModelChange",function(i){return g(e.form().type,i)||(e.form().type=i),i}),t(35,"option",20),o(36,"Producto"),n(),t(37,"option",21),o(38,"Curso"),n(),t(39,"option",22),o(40,"Servicio"),n()()(),t(41,"div",8)(42,"label",9),o(43,"Categor\xEDa Padre"),n(),t(44,"select",23),u("ngModelChange",function(i){return g(e.form().parent_id,i)||(e.form().parent_id=i),i}),t(45,"option",24),o(46,"Ninguna (Categor\xEDa Principal)"),n(),S(47,Y,1,1,null,null,H),n(),t(49,"p",18),o(50,"Selecciona una categor\xEDa padre para anidar esta categor\xEDa dentro de ella."),n()(),t(51,"div",25)(52,"label",26)(53,"input",27),u("ngModelChange",function(i){return g(e.form().is_active,i)||(e.form().is_active=i),i}),n(),t(54,"span",28),o(55,"Activo"),n()()()(),t(56,"div",29)(57,"a",30),o(58,"Cancelar"),n(),t(59,"button",31),p(60,Z,1,0,"span",32),o(61," Guardar "),n()()()()),a&2&&(s(5),P("",e.id?"Editar":"Nueva"," Categor\xEDa"),s(3),f(e.error()?8:-1),s(4),m("ngModel",e.form().name),s(4),m("ngModel",e.form().slug),s(4),m("ngModel",e.form().description),s(5),m("ngModel",e.form().image_url),s(2),f(e.form().image_url?27:28),s(7),m("ngModel",e.form().type),s(10),m("ngModel",e.form().parent_id),s(),h("ngValue",null),s(2),w(e.categories()),s(6),m("ngModel",e.form().is_active),s(6),h("disabled",e.saving()),s(),f(e.saving()?60:-1))},dependencies:[A,U,j,O,R,L,T,q,k,I,G,V,B,N],encapsulation:2})};export{z as AdminCategoryFormPage};
