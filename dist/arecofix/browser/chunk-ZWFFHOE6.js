import{a as W,b as T,d as D,e as L,f as I,g as j,h as B,i as k,o as q,p as R,r as O}from"./chunk-ENL3VNME.js";import{a as N}from"./chunk-4FNFMYN4.js";import{a as P,c as A,d as F}from"./chunk-4WX2KV2B.js";import"./chunk-QBWIJBVM.js";import"./chunk-BCXBSHNT.js";import{o as V}from"./chunk-YHPCNF66.js";import{$ as c,Fa as l,Fb as d,Gb as M,Hb as E,Jb as u,Kb as p,Lb as f,Ta as C,W as x,aa as g,eb as b,fb as h,kb as y,lb as t,ma as _,mb as n,nb as v,rb as S,vb as w,xb as m}from"./chunk-YBYZLFPG.js";import"./chunk-VOSPIT4N.js";function z(a,s){a&1&&(t(0,"div",6),v(1,"span",7),n())}function H(a,s){if(a&1&&(t(0,"div",22),v(1,"i",26),t(2,"span"),d(3),n()()),a&2){let e=m(2);l(3),M(e.error())}}function J(a,s){a&1&&v(0,"span",25)}function K(a,s){if(a&1){let e=S();t(0,"form",8),w("ngSubmit",function(){c(e);let i=m();return g(i.save())}),t(1,"div",9)(2,"label",10)(3,"span",11),d(4,"Nombre del Servicio"),n()(),t(5,"input",12),f("ngModelChange",function(i){c(e);let r=m();return p(r.form().name,i)||(r.form().name=i),g(i)}),n()(),t(6,"div",9)(7,"label",10)(8,"span",11),d(9,"Descripci\xF3n"),n()(),t(10,"textarea",13),f("ngModelChange",function(i){c(e);let r=m();return p(r.form().description,i)||(r.form().description=i),g(i)}),n()(),t(11,"div",14)(12,"div",15)(13,"label",10)(14,"span",11),d(15,"Precio"),n()(),t(16,"label",16)(17,"span"),d(18,"$"),n(),t(19,"input",17),f("ngModelChange",function(i){c(e);let r=m();return p(r.form().price,i)||(r.form().price=i),g(i)}),n()()(),t(20,"div",15)(21,"label",10)(22,"span",11),d(23,"Duraci\xF3n (minutos)"),n()(),t(24,"input",18),f("ngModelChange",function(i){c(e);let r=m();return p(r.form().duration_minutes,i)||(r.form().duration_minutes=i),g(i)}),n()()(),t(25,"div",19)(26,"label",20)(27,"span",11),d(28,"Activo"),n(),t(29,"input",21),f("ngModelChange",function(i){c(e);let r=m();return p(r.form().is_active,i)||(r.form().is_active=i),g(i)}),n()()(),b(30,H,4,1,"div",22),t(31,"div",23)(32,"a",3),d(33,"Cancelar"),n(),t(34,"button",24),b(35,J,1,0,"span",25),d(36," Guardar "),n()()()}if(a&2){let e=m();l(5),u("ngModel",e.form().name),l(5),u("ngModel",e.form().description),l(9),u("ngModel",e.form().price),l(5),u("ngModel",e.form().duration_minutes),l(5),u("ngModel",e.form().is_active),l(),h(e.error()?30:-1),l(4),y("disabled",e.saving()||!e.form().name),l(),h(e.saving()?35:-1)}}var G=class a{route=x(P);router=x(A);auth=x(N);id=null;form=_({name:"",description:"",price:0,duration_minutes:60,is_active:!0},{});loading=_(!0,{});saving=_(!1,{});error=_(null,{});async ngOnInit(){if(this.id=this.route.snapshot.paramMap.get("id"),this.id){let s=this.auth.getSupabaseClient(),{data:e,error:o}=await s.from("services").select("*").eq("id",this.id).single();e&&this.form.set({name:e.name,description:e.description||"",price:e.price||0,duration_minutes:e.duration_minutes||60,is_active:e.is_active})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let s=this.auth.getSupabaseClient(),e=this.form(),o={name:e.name,description:e.description,price:Number(e.price),duration_minutes:Number(e.duration_minutes),is_active:e.is_active};try{if(this.id){let{error:i}=await s.from("services").update(o).eq("id",this.id);if(i)throw i}else{let{error:i}=await s.from("services").insert(o);if(i)throw i}this.router.navigate(["/admin/services"])}catch(i){console.error("Error saving service:",i),this.error.set(i.message||"Error al guardar el servicio. Verifica los datos.")}finally{this.saving.set(!1)}}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=C({type:a,selectors:[["app-admin-service-form-page"]],decls:10,vars:2,consts:[[1,"max-w-2xl","mx-auto"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800"],["routerLink","/admin/services",1,"btn","btn-ghost"],[1,"fas","fa-arrow-left","mr-2"],[1,"bg-white","rounded-lg","shadow","p-6","text-gray-800"],[1,"flex","justify-center","py-8"],[1,"loading","loading-spinner","loading-lg"],[3,"ngSubmit"],[1,"form-control","mb-4"],[1,"label"],[1,"label-text","font-medium"],["type","text","name","name","required","",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],["name","description",1,"textarea","textarea-bordered","h-24","bg-white","text-gray-800",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-4","mb-4"],[1,"form-control"],[1,"input-group"],["type","number","name","price","min","0","step","0.01",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],["type","number","name","duration_minutes","min","0",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],[1,"form-control","mb-6"],[1,"label","cursor-pointer","justify-start","gap-4"],["type","checkbox","name","is_active",1,"toggle","toggle-primary",3,"ngModelChange","ngModel"],[1,"alert","alert-error","mb-6"],[1,"flex","justify-end","gap-4"],["type","submit",1,"btn","btn-primary",3,"disabled"],[1,"loading","loading-spinner","loading-xs"],[1,"fas","fa-exclamation-circle"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),d(3),n(),t(4,"a",3),v(5,"i",4),d(6," Volver "),n()(),t(7,"div",5),b(8,z,2,0,"div",6)(9,K,37,8,"form"),n()()),e&2&&(l(3),E("",o.id?"Editar":"Nuevo"," Servicio"),l(5),h(o.loading()?8:9))},dependencies:[V,O,B,T,k,W,D,L,R,q,j,I,F],encapsulation:2})};export{G as AdminServiceFormPage};
