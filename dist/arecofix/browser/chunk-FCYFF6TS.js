import{b as L,d as O,g as Y,s as z}from"./chunk-M6HENET5.js";import{a as $}from"./chunk-I4DLVUEL.js";import{l as V}from"./chunk-2IOVCKFA.js";import{$ as u,$b as R,Ab as o,Bb as g,Hb as D,Lb as p,Nb as d,Ta as l,Tb as M,Vb as c,W as N,Wb as E,Xb as x,Zb as k,_b as P,aa as h,ba as f,ca as C,fb as F,rb as y,sb as v,tb as _,ub as I,vb as S,wb as w,xb as b,yb as T,zb as a}from"./chunk-SD6TJRIO.js";function W(n,t){if(n&1&&(a(0,"div",9),c(1),o()),n&2){let e=t.$implicit;l(),x(" ",e," ")}}function B(n,t){if(n&1){let e=D();a(0,"div",12)(1,"button",14),p("click",function(){u(e);let r=d().$implicit,s=d();return h(s.selectDate(r))}),c(2),o()()}if(n&2){let e=d().$implicit,i=d();l(),M("bg-indigo-600",i.isSelectedDate(e))("text-white",i.isSelectedDate(e))("shadow-md",i.isSelectedDate(e))("bg-blue-100",i.isToday(e)&&!i.isSelectedDate(e))("text-blue-700",i.isToday(e)&&!i.isSelectedDate(e))("text-gray-400",i.isPastDate(e))("cursor-not-allowed",i.isPastDate(e))("text-gray-700",!i.isSelectedDate(e)&&!i.isPastDate(e)&&!i.isToday(e))("hover:bg-gray-100",!i.isSelectedDate(e)&&!i.isPastDate(e)),T("disabled",i.isPastDate(e)),y("aria-label","Seleccionar "+(e==null?null:e.getDate())+" de "+i.currentMonthYear),l(),x(" ",e==null?null:e.getDate()," ")}}function H(n,t){n&1&&g(0,"div",13)}function G(n,t){if(n&1&&v(0,B,3,21,"div",12)(1,H,1,0,"div",13),n&2){let e=t.$implicit;_(e?0:1)}}function J(n,t){if(n&1){let e=D();a(0,"button",18),p("click",function(){let r=u(e).$implicit,s=d(2);return h(s.selectTime(r))}),c(1),o()}if(n&2){let e=t.$implicit,i=d(2);M("bg-indigo-600",i.selectedTime===e)("text-white",i.selectedTime===e),y("aria-label","Seleccionar horario "+e),l(),x(" ",e," ")}}function Q(n,t){if(n&1&&(a(0,"div",11)(1,"h3",15),c(2,"Selecciona un horario"),o(),a(3,"div",16),w(4,J,2,6,"button",17,S),o()()),n&2){let e=d();l(4),b(e.availableHours)}}function U(n,t){n&1&&(f(),a(0,"svg",29),g(1,"circle",30)(2,"path",31),o())}function q(n,t){n&1&&(f(),a(0,"svg",32),g(1,"path",33),o(),c(2," Confirmar Reserva "))}function K(n,t){if(n&1){let e=D();a(0,"div",11)(1,"h3",19),c(2,"Completa tus datos"),o(),a(3,"div",20)(4,"div")(5,"label",21),c(6,"Nombre y Apellido"),o(),a(7,"input",22),R("ngModelChange",function(r){u(e);let s=d();return P(s.customerName,r)||(s.customerName=r),h(r)}),o()(),a(8,"div")(9,"label",21),c(10,"Tel\xE9fono"),o(),a(11,"input",23),R("ngModelChange",function(r){u(e);let s=d();return P(s.customerPhone,r)||(s.customerPhone=r),h(r)}),o()()(),a(12,"div",24)(13,"p",25),c(14,"Est\xE1s reservando para:"),o(),a(15,"p",26),c(16),o(),a(17,"p",27),c(18),o()(),a(19,"button",28),p("click",function(){u(e);let r=d();return h(r.confirmReservation())}),v(20,U,3,0,":svg:svg",29)(21,q,3,0),o()()}if(n&2){let e=d();l(7),k("ngModel",e.customerName),l(4),k("ngModel",e.customerPhone),l(5),E(e.formattedSelectedDate),l(2),x("",e.selectedTime," hs"),l(),T("disabled",e.saving||!e.customerName||!e.customerPhone),l(),_(e.saving?20:21)}}var A=class n{auth=N($);whatsappNumber="5491125960900";availableHours=["09:00","10:00","11:00","12:00","14:00","15:00","16:00","17:00"];monthNames=["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"];weekDayNames=["Dom","Lun","Mar","Mi\xE9","Jue","Vie","S\xE1b"];currentDate=new Date;selectedDate=null;selectedTime=null;showTimeSelection=!1;showConfirmation=!1;customerName="";customerPhone="";saving=!1;initializeCalendar(){this.currentDate=new Date,this.selectedDate=null,this.selectedTime=null,this.showTimeSelection=!1,this.showConfirmation=!1,this.customerName="",this.customerPhone=""}ngOnInit(){this.initializeCalendar()}prevMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()-1,1),this.resetSelection()}nextMonth(){this.currentDate=new Date(this.currentDate.getFullYear(),this.currentDate.getMonth()+1,1),this.resetSelection()}selectDate(t){this.isPastDate(t)||(this.selectedDate=t,this.selectedTime=null,this.showTimeSelection=!0,this.showConfirmation=!1)}selectTime(t){this.selectedTime=t,this.showConfirmation=!0}resetSelection(){this.selectedDate=null,this.selectedTime=null,this.showTimeSelection=!1,this.showConfirmation=!1}get daysInMonth(){let t=this.currentDate.getFullYear(),e=this.currentDate.getMonth(),i=new Date(t,e,1),r=new Date(t,e+1,0),s=[],j=i.getDay()===0?6:i.getDay()-1;for(let m=0;m<j;m++)s.push(null);for(let m=1;m<=r.getDate();m++)s.push(new Date(t,e,m));return s}isToday(t){if(!t)return!1;let e=new Date;return t.getDate()===e.getDate()&&t.getMonth()===e.getMonth()&&t.getFullYear()===e.getFullYear()}isSelectedDate(t){return!!t&&!!this.selectedDate&&t.getDate()===this.selectedDate.getDate()&&t.getMonth()===this.selectedDate.getMonth()&&t.getFullYear()===this.selectedDate.getFullYear()}isPastDate(t){let e=new Date;return e.setHours(0,0,0,0),t<e}async confirmReservation(){if(!this.selectedDate||!this.selectedTime||!this.customerName||!this.customerPhone){alert("Por favor completa todos los datos para continuar.");return}this.saving=!0;try{let t=this.auth.getSupabaseClient(),e={weekday:"long",year:"numeric",month:"long",day:"numeric"},i=this.selectedDate.toLocaleDateString("es-ES",e);await t.from("contact_messages").insert({name:this.customerName,phone:this.customerPhone,email:"reserva@web.com",subject:`Nueva Reserva: ${i} ${this.selectedTime}`,message:`Reserva solicitada para el ${i} a las ${this.selectedTime}. Tel\xE9fono: ${this.customerPhone}`,is_read:!1});let r=`\xA1Hola! Soy ${this.customerName}. Quiero confirmar mi reserva para el ${i} a las ${this.selectedTime} horas.`,s=encodeURIComponent(r);window.open(`https://wa.me/${this.whatsappNumber}?text=${s}`,"_blank"),this.resetSelection(),this.customerName="",this.customerPhone=""}catch(t){console.error("Error saving reservation:",t),this.sendWhatsAppMessage()}finally{this.saving=!1}}sendWhatsAppMessage(){if(!this.selectedDate||!this.selectedTime)return;let t={weekday:"long",year:"numeric",month:"long",day:"numeric"},i=`\xA1Hola! Quiero reservar una cita para el ${this.selectedDate.toLocaleDateString("es-ES",t)} a las ${this.selectedTime} horas.`;window.open(`https://wa.me/${this.whatsappNumber}?text=${encodeURIComponent(i)}`,"_blank")}get currentMonthYear(){return`${this.monthNames[this.currentDate.getMonth()]} ${this.currentDate.getFullYear()}`}get formattedSelectedDate(){if(!this.selectedDate)return"";let t={weekday:"long",year:"numeric",month:"long",day:"numeric"};return this.selectedDate.toLocaleDateString("es-ES",t)}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=F({type:n,selectors:[["app-reservation-calendar"]],decls:18,vars:3,consts:[[1,"max-w-md","mx-auto","bg-white","rounded-xl","shadow-md","overflow-hidden","md:max-w-2xl"],[1,"bg-indigo-600","text-white","p-4","flex","justify-between","items-center"],["aria-label","Mes anterior",1,"p-2","rounded-full","hover:bg-indigo-700","transition",3,"click"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 20 20","fill","currentColor",1,"h-5","w-5"],["fill-rule","evenodd","d","M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z","clip-rule","evenodd"],[1,"text-lg","font-semibold"],["aria-label","Mes siguiente",1,"p-2","rounded-full","hover:bg-indigo-700","transition",3,"click"],["fill-rule","evenodd","d","M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z","clip-rule","evenodd"],[1,"grid","grid-cols-7","gap-1","p-2","bg-gray-100"],[1,"text-center","text-gray-700","font-medium","text-sm","py-2"],[1,"grid","grid-cols-7","gap-2","p-4"],[1,"border-t","p-4"],[1,"flex","items-center","justify-center"],[1,"h-10","w-10"],[1,"h-10","w-10","flex","items-center","justify-center","text-sm","font-medium","rounded-full","transition-all","duration-200","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-indigo-500",3,"click","disabled"],[1,"font-semibold","text-gray-700","mb-3"],[1,"grid","grid-cols-2","sm:grid-cols-4","gap-2"],[1,"py-2","px-3","text-sm","font-medium","text-gray-700","hover:bg-indigo-100","rounded-full","transition",3,"bg-indigo-600","text-white"],[1,"py-2","px-3","text-sm","font-medium","text-gray-700","hover:bg-indigo-100","rounded-full","transition",3,"click"],[1,"font-semibold","text-gray-700","mb-4"],[1,"space-y-4","mb-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","placeholder","Ej: Juan P\xE9rez",1,"w-full","px-3","py-2","border","rounded-lg","focus:ring-2","focus:ring-indigo-500","outline-none",3,"ngModelChange","ngModel"],["type","tel","placeholder","Ej: 11 1234 5678",1,"w-full","px-3","py-2","border","rounded-lg","focus:ring-2","focus:ring-indigo-500","outline-none",3,"ngModelChange","ngModel"],[1,"bg-gray-50","p-4","rounded-lg","mb-6","border","border-gray-100"],[1,"text-sm","text-gray-500","mb-1"],[1,"text-gray-800","font-bold","text-lg","capitalize"],[1,"text-indigo-600","font-bold","text-xl"],["aria-label","Confirmar reserva y enviar mensaje por WhatsApp",1,"w-full","bg-green-600","hover:bg-green-700","disabled:bg-gray-400","text-white","font-medium","py-3","px-4","rounded-lg","transition","flex","items-center","justify-center","gap-2",3,"click","disabled"],["xmlns","http://www.w3.org/2000/svg","fill","none","viewBox","0 0 24 24",1,"animate-spin","h-5","w-5","text-white"],["cx","12","cy","12","r","10","stroke","currentColor","stroke-width","4",1,"opacity-25"],["fill","currentColor","d","M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",1,"opacity-75"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 0 24 24","fill","currentColor",1,"h-5","w-5"],["d","M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413z"]],template:function(e,i){e&1&&(a(0,"div",0)(1,"div",1)(2,"button",2),p("click",function(){return i.prevMonth()}),f(),a(3,"svg",3),g(4,"path",4),o()(),C(),a(5,"h2",5),c(6),o(),a(7,"button",6),p("click",function(){return i.nextMonth()}),f(),a(8,"svg",3),g(9,"path",7),o()()(),C(),a(10,"div",8),w(11,W,2,1,"div",9,S),o(),a(13,"div",10),w(14,G,2,1,null,null,I),o(),v(16,Q,6,0,"div",11),v(17,K,22,6,"div",11),o()),e&2&&(l(6),E(i.currentMonthYear),l(5),b(i.weekDayNames),l(3),b(i.daysInMonth),l(2),_(i.showTimeSelection?16:-1),l(),_(i.showConfirmation?17:-1))},dependencies:[V,z,L,O,Y],styles:["button[_ngcontent-%COMP%]{transition:all .2s ease}button[_ngcontent-%COMP%]:not(:disabled):hover{transform:scale(1.05)}.h-10[_ngcontent-%COMP%]{height:2.5rem}"]})};export{A as a};
