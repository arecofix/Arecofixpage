import{a as J}from"./chunk-J6NTXN47.js";import{a as K}from"./chunk-EMKRN3HQ.js";import{b as M,c as h,d as R,e as $,h as j,j as L,k as U,r as B,t as H}from"./chunk-URSEOMT7.js";import{a as A}from"./chunk-JLUYGYUQ.js";import"./chunk-4TKL6PHB.js";import"./chunk-AQQRJJTD.js";import{g as G,h as z}from"./chunk-ZP3NLRVZ.js";import"./chunk-AF237TA6.js";import"./chunk-T7AXESXA.js";import{r as O}from"./chunk-XPXWP2W5.js";import{$b as V,Ab as D,Bb as g,Cb as t,Db as e,Eb as m,Kb as y,Ob as P,Qb as _,Ra as w,Wa as a,Wb as v,Y as f,Yb as n,Zb as q,_b as T,ba as E,ca as k,ib as N,oa as F,vb as p,wb as x,zb as I}from"./chunk-D4Q5CFD4.js";import"./chunk-VOSPIT4N.js";var W=(o,l)=>l.product.id;function X(o,l){if(o&1&&(t(0,"div",2)(1,"div",4)(2,"div",5),m(3,"i",6),e(),t(4,"h2",7),n(5,"\xA1Orden Recibida!"),e(),t(6,"p",8),n(7,"Gracias por tu compra. Para procesar el env\xEDo, por favor realiza el pago:"),e(),t(8,"div",9)(9,"p",10),n(10,"Datos Bancarios:"),e(),t(11,"div",11)(12,"p",12)(13,"span"),n(14,"Alias:"),e(),t(15,"span",13),n(16,"arecofix"),e()(),t(17,"p",12)(18,"span"),n(19,"CBU:"),e(),t(20,"span",13),n(21,"ecocell"),e()()()(),t(22,"p",14),n(23," Una vez realizado el pago, env\xEDa el comprobante al: "),m(24,"br"),t(25,"strong",15),n(26,"+54 9 11 2596-0900"),e()(),t(27,"div",16)(28,"a",17),m(29,"i",18),n(30," Enviar Comprobante "),e(),t(31,"a",19),n(32,"Volver al Inicio"),e()()()()),o&2){let i,d=_();a(28),g("href","https://wa.me/5491125960900?text=Hola,%20hice%20un%20pedido%20a%20nombre%20de%20"+((i=d.checkoutForm.get("name"))==null?null:i.value)+".%20Adjunto%20comprobante.",w)}}function Y(o,l){o&1&&(t(0,"p",37),n(1,"Tu carrito est\xE1 vac\xEDo."),e(),t(2,"a",38),n(3,"Ir a comprar"),e())}function Z(o,l){if(o&1){let i=y();t(0,"div",40),m(1,"img",43),t(2,"div",44)(3,"h3",45),n(4),e(),t(5,"p",46),n(6),e()(),t(7,"div",47)(8,"span",45),n(9),e(),t(10,"button",48),P("click",function(){let s=E(i).$implicit,u=_(3);return k(u.cartService.removeFromCart(s.product.id))}),m(11,"i",49),e()()()}if(o&2){let i=l.$implicit;a(),g("src",i.product.image_url||(i.product.gallery_urls==null?null:i.product.gallery_urls[0])||"assets/img/no-image.png",w),a(3),q(i.product.name),a(2),V("$",i.product.price," x ",i.quantity),a(3),T(" $",(i.product.price*i.quantity).toFixed(2)," ")}}function ee(o,l){if(o&1&&(t(0,"div",39),I(1,Z,12,5,"div",40,W),e(),m(3,"div",41),t(4,"div",42)(5,"span"),n(6,"Total"),e(),t(7,"span"),n(8),e()()),o&2){let i=_(2);a(),D(i.cartService.cartItems()),a(7),T("$",i.cartService.totalPrice().toFixed(2))}}function te(o,l){o&1&&(t(0,"span",29),n(1,"El nombre es requerido"),e())}function ne(o,l){o&1&&(t(0,"span",29),n(1,"Email inv\xE1lido"),e())}function ie(o,l){o&1&&(t(0,"span",29),n(1,"El tel\xE9fono es requerido"),e())}function oe(o,l){o&1&&(t(0,"span",29),n(1,"La direcci\xF3n es requerida"),e())}function re(o,l){o&1&&m(0,"span",36)}function ae(o,l){if(o&1){let i=y();t(0,"div",3)(1,"div",20)(2,"div",21)(3,"h2",22),n(4,"Resumen del Carrito"),e(),p(5,Y,4,0)(6,ee,9,1),e()(),t(7,"div",23)(8,"div",21)(9,"h2",22),n(10,"Datos del Cliente"),e(),t(11,"form",24),P("ngSubmit",function(){E(i);let s=_();return k(s.placeOrder())}),t(12,"div",25)(13,"label",26)(14,"span",27),n(15,"Nombre Completo"),e()(),m(16,"input",28),p(17,te,2,0,"span",29),e(),t(18,"div",25)(19,"label",26)(20,"span",27),n(21,"Email"),e()(),m(22,"input",30),p(23,ne,2,0,"span",29),e(),t(24,"div",25)(25,"label",26)(26,"span",27),n(27,"Tel\xE9fono"),e()(),m(28,"input",31),p(29,ie,2,0,"span",29),e(),t(30,"div",25)(31,"label",26)(32,"span",27),n(33,"Direcci\xF3n de Env\xEDo"),e()(),m(34,"textarea",32),p(35,oe,2,0,"span",29),e(),t(36,"div",25)(37,"label",26)(38,"span",27),n(39,"Notas (Opcional)"),e()(),m(40,"textarea",33),e(),t(41,"div",34)(42,"button",35),p(43,re,1,0,"span",36),n(44," Finalizar Compra "),e()()()()()()}if(o&2){let i,d,s,u,c,b,C,S,r=_();a(5),x(r.cartService.cartItems().length===0?5:6),a(6),g("formGroup",r.checkoutForm),a(5),v("input-error",((i=r.checkoutForm.get("name"))==null?null:i.invalid)&&((i=r.checkoutForm.get("name"))==null?null:i.touched)),a(),x((d=r.checkoutForm.get("name"))!=null&&d.invalid&&((d=r.checkoutForm.get("name"))!=null&&d.touched)?17:-1),a(5),v("input-error",((s=r.checkoutForm.get("email"))==null?null:s.invalid)&&((s=r.checkoutForm.get("email"))==null?null:s.touched)),a(),x((u=r.checkoutForm.get("email"))!=null&&u.invalid&&((u=r.checkoutForm.get("email"))!=null&&u.touched)?23:-1),a(5),v("input-error",((c=r.checkoutForm.get("phone"))==null?null:c.invalid)&&((c=r.checkoutForm.get("phone"))==null?null:c.touched)),a(),x((b=r.checkoutForm.get("phone"))!=null&&b.invalid&&((b=r.checkoutForm.get("phone"))!=null&&b.touched)?29:-1),a(5),v("textarea-error",((C=r.checkoutForm.get("address"))==null?null:C.invalid)&&((C=r.checkoutForm.get("address"))==null?null:C.touched)),a(),x((S=r.checkoutForm.get("address"))!=null&&S.invalid&&((S=r.checkoutForm.get("address"))!=null&&S.touched)?35:-1),a(7),g("disabled",r.isProcessing()||r.cartService.cartItems().length===0),a(),x(r.isProcessing()?43:-1)}}var Q=class o{cartService=f(A);orderService=f(J);fb=f(B);router=f(G);notificationService=f(K);checkoutForm=this.fb.group({name:["",[h.required]],email:["",[h.required,h.email]],phone:["",[h.required]],address:["",[h.required]],notes:[""]});isProcessing=F(!1);orderSuccess=F(!1);async placeOrder(){if(this.checkoutForm.invalid){this.checkoutForm.markAllAsTouched(),this.notificationService.showError("Por favor, completa todos los campos requeridos.");return}this.isProcessing.set(!0);let l=this.checkoutForm.getRawValue(),i=this.cartService.cartItems(),d=this.cartService.totalPrice(),s={customer_name:l.name,customer_email:l.email,customer_phone:l.phone,customer_address:l.address,status:"pending",subtotal:d,tax:0,discount:0,total:d,notes:l.notes},u=i.map(c=>({product_name:c.product.name,product_id:c.product.id,quantity:c.quantity,unit_price:c.product.price,subtotal:c.product.price*c.quantity}));try{let{data:c,error:b}=await this.orderService.createOrder(s,u);if(b)throw b;this.orderSuccess.set(!0),this.cartService.clearCart(),this.notificationService.showSuccess("\xA1Orden creada exitosamente!")}catch(c){console.error("Checkout failed",c),this.notificationService.showError("Hubo un error al procesar tu orden. Por favor intenta nuevamente.")}finally{this.isProcessing.set(!1)}}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=N({type:o,selectors:[["app-checkout-page"]],decls:5,vars:1,consts:[[1,"container","mx-auto","px-4","py-8","max-w-4xl"],[1,"text-3xl","font-bold","mb-8","text-center","text-primary"],[1,"card","bg-base-100","shadow-xl","text-center","p-10","border","border-base-200"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-8"],[1,"card-body","items-center"],[1,"text-success","text-6xl","mb-4"],[1,"fas","fa-check-circle"],[1,"card-title","text-2xl","text-base-content","mb-2"],[1,"text-base-content/80","mb-6"],[1,"bg-base-200","p-6","rounded-xl","w-full","max-w-md","mb-6","text-left","border","border-base-300"],[1,"font-bold","text-base-content","mb-2","border-b","border-base-content/10","pb-2"],[1,"space-y-2"],[1,"text-base-content/70","flex","justify-between"],[1,"font-mono","font-bold","text-base-content","select-all","bg-base-100","px-2","rounded"],[1,"text-sm","mb-4","text-base-content/80"],[1,"text-lg","text-primary"],[1,"card-actions","flex","flex-col","gap-3","w-full","max-w-md"],["target","_blank",1,"btn","btn-success","text-white","w-full","btn-lg",3,"href"],[1,"fab","fa-whatsapp","text-xl","mr-2"],["routerLink","/",1,"btn","btn-ghost","w-full"],[1,"card","bg-base-100","shadow-xl","h-fit","border","border-base-200"],[1,"card-body"],[1,"card-title","mb-4","text-base-content"],[1,"card","bg-base-100","shadow-xl","border","border-base-200"],[1,"space-y-4",3,"ngSubmit","formGroup"],[1,"form-control","w-full"],[1,"label"],[1,"label-text","text-base-content"],["type","text","formControlName","name",1,"input","input-bordered","w-full","bg-base-100","text-base-content"],[1,"text-error","text-xs","mt-1"],["type","email","formControlName","email",1,"input","input-bordered","w-full","bg-base-100","text-base-content"],["type","tel","formControlName","phone",1,"input","input-bordered","w-full","bg-base-100","text-base-content"],["formControlName","address",1,"textarea","textarea-bordered","h-24","w-full","bg-base-100","text-base-content"],["formControlName","notes",1,"textarea","textarea-bordered","w-full","bg-base-100","text-base-content"],[1,"mt-6"],["type","submit",1,"btn","btn-primary","btn-block","btn-lg",3,"disabled"],[1,"loading","loading-spinner"],[1,"text-base-content"],["routerLink","/products/featured",1,"btn","btn-link","px-0"],[1,"space-y-4"],[1,"flex","gap-4","items-center","p-2","hover:bg-base-200","rounded-lg","transition-colors"],[1,"divider"],[1,"flex","justify-between","text-xl","font-bold","text-base-content"],[1,"w-16","h-16","object-cover","rounded-lg","border","border-base-300",3,"src"],[1,"flex-1"],[1,"font-bold","text-base-content"],[1,"text-sm","text-base-content/70"],[1,"flex","flex-col","items-end","gap-1"],["aria-label","Eliminar",1,"btn","btn-ghost","btn-xs","text-error",3,"click"],[1,"fas","fa-trash-alt"]],template:function(i,d){i&1&&(t(0,"div",0)(1,"h1",1),n(2,"Checkout"),e(),p(3,X,33,1,"div",2)(4,ae,45,16,"div",3),e()),i&2&&(a(3),x(d.orderSuccess()?3:4))},dependencies:[O,H,j,M,R,$,U,L,z],encapsulation:2})};export{Q as CheckoutPage};
