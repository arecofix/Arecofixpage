import{c as A,d as k}from"./chunk-66AOHCNE.js";import{p as g}from"./chunk-KA6MU7ME.js";import{a as x}from"./chunk-F4YL3ILH.js";import{C as D,j as E,l as _}from"./chunk-LKDB4EQ3.js";import{Ab as t,Bb as e,Cb as s,Ob as f,Ua as r,W as v,Xb as a,Yb as m,gb as y,ma as p,nc as C,oc as S,tb as h,ub as b,zb as u}from"./chunk-R5MGBMPQ.js";import"./chunk-7CGTOI24.js";var c={primary:"#4f46e5",primaryTransparent:"rgba(79, 70, 229, 0.2)",red:"#ef4444",blue:"#3b82f6",green:"#10b981",yellow:"#f59e0b",purple:"#8b5cf6",pink:"#ec4899",indigo:"#6366f1",palette:["#ef4444","#3b82f6","#10b981","#f59e0b","#8b5cf6","#6366f1","#ec4899"],paletteAlt:["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#6366f1"]};function T(o,n){o&1&&(t(0,"div",2),s(1,"span",3),e())}function w(o,n){if(o&1&&(s(0,"div",44),t(1,"div",45)(2,"div",46)(3,"span",47),s(4,"i",48),t(5,"span"),a(6,"Sesi\xF3n Actual"),e()(),t(7,"span",49),a(8),e()(),t(9,"div",46)(10,"span",47),s(11,"i",50),t(12,"span"),a(13,"Usuario"),e()(),t(14,"span",51),a(15),e()(),t(16,"a",52),s(17,"i",53),a(18," Ver Dashboard Completo "),e()()),o&2){let i=f(2);r(8),m(i.analyticsStats().sessionId?"Activa":"N/A"),r(7),m(i.analyticsStats().distinctId||"An\xF3nimo")}}function P(o,n){o&1&&(t(0,"div",43),s(1,"i",54),t(2,"span"),a(3,"PostHog no est\xE1 inicializado correctamente"),e()())}function R(o,n){if(o&1&&(t(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7),s(4,"i",8),e(),t(5,"div",9),a(6,"Usuarios"),e(),t(7,"div",10),a(8),e(),t(9,"div",11),a(10,"Registrados"),e()()(),t(11,"div",5)(12,"div",6)(13,"div",12),s(14,"i",13),e(),t(15,"div",9),a(16,"Productos"),e(),t(17,"div",14),a(18),e(),t(19,"div",11),a(20,"En cat\xE1logo"),e()()(),t(21,"div",5)(22,"div",6)(23,"div",15),s(24,"i",16),e(),t(25,"div",9),a(26,"Ventas"),e(),t(27,"div",17),a(28),e(),t(29,"div",11),a(30,"Total realizadas"),e()()(),t(31,"div",5)(32,"div",6)(33,"div",18),s(34,"i",19),e(),t(35,"div",9),a(36,"Ingresos"),e(),t(37,"div",20),a(38),C(39,"currency"),e(),t(40,"div",11),a(41,"Total facturado"),e()()()(),t(42,"div",21)(43,"div",22)(44,"div",23)(45,"h2",24),a(46,"Resumen de Ventas"),e(),t(47,"div",25),s(48,"canvas",26),e()()(),t(49,"div",27)(50,"div",23)(51,"h2",24),a(52,"Productos Top"),e(),t(53,"div",28),s(54,"canvas",26),e()()(),t(55,"div",27)(56,"div",23)(57,"h2",24),a(58,"Ventas por Categor\xEDa"),e(),t(59,"div",29),s(60,"canvas",26),e()()()(),t(61,"div",30)(62,"div",27)(63,"div",23)(64,"h2",24),a(65,"Acciones R\xE1pidas"),e(),t(66,"div",31)(67,"a",32),s(68,"i",33),a(69," Nuevo Producto "),e(),t(70,"a",34),s(71,"i",35),a(72," Nueva Venta "),e(),t(73,"a",36),s(74,"i",37),a(75," Gestionar Usuarios "),e(),t(76,"a",38),s(77,"i",39),a(78," Taller "),e()()()(),t(79,"div",27)(80,"div",23)(81,"h2",24),a(82,"Analytics & Sistema"),e(),t(83,"div",40)(84,"div",41)(85,"span"),a(86,"Base de Datos"),e(),t(87,"span",42),a(88,"Conectado"),e()(),t(89,"div",41)(90,"span"),a(91,"Analytics (PostHog)"),e(),t(92,"span",42),a(93),e()(),h(94,w,19,2)(95,P,4,0,"div",43),e()()()()),o&2){let i=f();r(8),m(i.stats().users),r(10),m(i.stats().products),r(10),m(i.stats().sales),r(10),m(S(39,15,i.stats().revenue)),r(10),u("data",i.salesChartData)("options",i.salesChartOptions)("type",i.salesChartType),r(6),u("data",i.productsChartData)("options",i.productsChartOptions)("type",i.productsChartType),r(6),u("data",i.categoryChartData)("options",i.categoryChartOptions)("type",i.categoryChartType),r(33),m(i.posthogStatus()),r(),b(i.analyticsStats().enabled?94:95)}}var I=class o{analyticsRepo=v(k);stats=p({users:0,products:0,sales:0,revenue:0});analyticsStats=p({enabled:!1,sessionId:"",distinctId:""});loading=p(!0);salesChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom"},title:{display:!0,text:"Ventas del A\xF1o"}}};salesChartType="line";salesChartData={labels:[],datasets:[{data:[],label:"Ventas ($)",borderColor:c.primary,backgroundColor:c.primaryTransparent,fill:!0}]};productsChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Productos M\xE1s Vendidos"}}};productsChartType="bar";productsChartData={labels:[],datasets:[{data:[],label:"Unidades",backgroundColor:c.palette}]};categoryChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right"},title:{display:!0,text:"Ventas por Categor\xEDa"}}};categoryChartType="doughnut";categoryChartData={labels:[],datasets:[{data:[],backgroundColor:c.paletteAlt}]};ngOnInit(){this.loadStats(),this.loadAnalyticsInfo()}loadStats(){this.loading.set(!0),this.analyticsRepo.getDashboardStats().subscribe({next:n=>{if(this.stats.set({users:n.users,products:n.products,sales:n.sales,revenue:n.revenue}),n.sales_chart&&n.sales_chart.length>0){let i=n.sales_chart.map(l=>this.formatMonth(l.period)),d=n.sales_chart.map(l=>l.total);this.salesChartData={labels:i,datasets:[{data:d,label:"Ventas ($)",borderColor:c.primary,backgroundColor:c.primaryTransparent,fill:!0}]}}if(n.products_chart&&n.products_chart.length>0){let i=n.products_chart.map(l=>l.name),d=n.products_chart.map(l=>l.quantity);this.productsChartData={labels:i,datasets:[{data:d,label:"Unidades",backgroundColor:c.palette}]}}if(n.category_chart&&n.category_chart.length>0){let i=n.category_chart.map(l=>l.name),d=n.category_chart.map(l=>l.count);this.categoryChartData={labels:i,datasets:[{data:d,backgroundColor:c.paletteAlt}]}}this.loading.set(!1)},error:n=>{console.error("Error loading dashboard stats:",n),this.loading.set(!1)}})}formatMonth(n){let[i,d]=n.split("-");return new Date(parseInt(i),parseInt(d)-1,1).toLocaleDateString("es-ES",{month:"short"})}loadAnalyticsInfo(){try{x.posthogKey&&x.posthogKey!==""&&g?this.analyticsStats.set({enabled:!0,sessionId:g.get_session_id()||"",distinctId:g.get_distinct_id()||"An\xF3nimo"}):this.analyticsStats.set({enabled:!1,sessionId:"",distinctId:""})}catch(n){console.error("Error loading analytics info:",n),this.analyticsStats.set({enabled:!1,sessionId:"",distinctId:""})}}posthogStatus(){return this.analyticsStats().enabled?"Activo":"Inactivo"}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=y({type:o,selectors:[["app-admin-dashboard-page"]],decls:5,vars:1,consts:[[1,"p-6"],[1,"text-2xl","font-bold","mb-6","text-black","dark:text-green-400"],[1,"flex","justify-center","py-12"],[1,"loading","loading-spinner","loading-lg"],[1,"grid","grid-cols-2","lg:grid-cols-4","gap-6","mb-8"],[1,"stats","shadow","bg-base-100","dark:bg-gray-800","text-base-content","dark:text-white"],[1,"stat"],[1,"stat-figure","text-primary"],[1,"fas","fa-users","text-3xl"],[1,"stat-title","dark:text-gray-400"],[1,"stat-value","text-primary"],[1,"stat-desc","dark:text-gray-500"],[1,"stat-figure","text-secondary"],[1,"fas","fa-box","text-3xl"],[1,"stat-value","text-secondary"],[1,"stat-figure","text-accent"],[1,"fas","fa-shopping-cart","text-3xl"],[1,"stat-value","text-accent"],[1,"stat-figure","text-success"],[1,"fas","fa-dollar-sign","text-3xl"],[1,"stat-value","text-success"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6","mb-8"],[1,"card","shadow","lg:col-span-2","bg-base-100","dark:bg-gray-800","text-base-content","dark:text-white"],[1,"card-body"],[1,"card-title","mb-4"],[1,"h-80","w-full"],["baseChart","",3,"data","options","type"],[1,"card","shadow","bg-base-100","dark:bg-gray-800","text-base-content","dark:text-white"],[1,"h-64","w-full"],[1,"h-64","w-full","flex","justify-center"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"grid","grid-cols-2","gap-4"],["routerLink","/admin/products/new",1,"btn","btn-outline","btn-primary"],[1,"fas","fa-plus","mr-2"],["routerLink","/admin/sales",1,"btn","btn-outline","btn-accent"],[1,"fas","fa-cash-register","mr-2"],["routerLink","/admin/users",1,"btn","btn-outline","dark:text-white","dark:border-white","dark:hover:bg-white","dark:hover:text-gray-900"],[1,"fas","fa-user-plus","mr-2"],["routerLink","/admin/repairs",1,"btn","btn-outline","btn-secondary"],[1,"fas","fa-tools","mr-2"],[1,"space-y-4"],[1,"flex","justify-between","items-center"],[1,"badge","badge-success"],[1,"alert","alert-warning","text-xs","mt-4"],[1,"divider","my-2"],[1,"space-y-3"],[1,"flex","justify-between","items-center","text-sm"],[1,"flex","items-center","gap-2"],[1,"fas","fa-eye","text-info"],[1,"font-semibold"],[1,"fas","fa-user","text-primary"],[1,"font-semibold","text-xs"],["href","https://us.posthog.com/project/253677/dashboard/791256","target","_blank",1,"btn","btn-sm","btn-outline","btn-info","w-full","mt-2"],[1,"fas","fa-chart-line","mr-2"],[1,"fas","fa-exclamation-triangle"]],template:function(i,d){i&1&&(t(0,"div",0)(1,"h1",1),a(2,"Panel de Control"),e(),h(3,T,2,0,"div",2)(4,R,96,17),e()),i&2&&(r(3),b(d.loading()?3:4))},dependencies:[_,D,A,E],encapsulation:2})};export{I as AdminDashboardPage};
