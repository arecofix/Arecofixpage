import{a as N}from"./chunk-BEDAP6MF.js";import"./chunk-FLAEXP3O.js";import"./chunk-T7ROU62R.js";import{A as T,c as A,h as I,j as k,l as D}from"./chunk-T7HZBI4H.js";import{$ as f,Ab as i,Bb as l,Hb as S,Lb as E,Nb as c,Ta as s,Vb as a,W as u,Wb as d,Xb as y,aa as x,fb as _,hc as w,lc as g,ma as m,mc as R,nc as P,sb as b,tb as h,wb as v,xb as C,yb as p,zb as t}from"./chunk-NLTFPZ75.js";import"./chunk-7CGTOI24.js";var O=r=>["/admin/repairs",r],V=(r,n)=>n.id;function $(r,n){r&1&&(t(0,"tr")(1,"td",8),a(2,"Cargando..."),i()())}function j(r,n){r&1&&(t(0,"tr")(1,"td",8),a(2,"No hay reparaciones registradas."),i()())}function B(r,n){if(r&1){let e=S();t(0,"tr",7)(1,"td"),a(2),g(3,"date"),i(),t(4,"td")(5,"div",9),a(6),i(),t(7,"div",10),a(8),i()(),t(9,"td"),a(10),i(),t(11,"td")(12,"div",11),a(13),i()(),t(14,"td"),a(15),g(16,"currency"),i(),t(17,"td")(18,"div",12)(19,"a",13),l(20,"i",14),i(),t(21,"button",15),E("click",function(){let L=f(e).$implicit,M=c(2);return x(M.deleteRepair(L.id))}),l(22,"i",16),i()()()()}if(r&2){let e=n.$implicit,o=c(2);s(2),d(P(3,8,e.received_at,"shortDate")),s(4),d(e.customer_name),s(2),d(e.customer_phone),s(2),d(e.device_model),s(2),p("ngClass",o.getStatusColor(e.status)),s(),y(" ",o.getStatusLabel(e.status)," "),s(2),d(R(16,11,e.estimated_cost)),s(4),p("routerLink",w(13,O,e.id))}}function q(r,n){if(r&1&&v(0,B,23,15,"tr",7,V),r&2){let e=c();C(e.repairs())}}var F=class r{auth=u(N);repairs=m([]);loading=m(!0);async ngOnInit(){await this.loadRepairs()}async loadRepairs(){this.loading.set(!0);let n=this.auth.getSupabaseClient(),{data:e,error:o}=await n.from("repairs").select("*").order("received_at",{ascending:!1});e&&this.repairs.set(e),this.loading.set(!1)}async deleteRepair(n){if(!confirm("\xBFEst\xE1s seguro de eliminar este registro de reparaci\xF3n?"))return;let e=this.auth.getSupabaseClient(),{error:o}=await e.from("repairs").delete().eq("id",n);o?alert("Error al eliminar la reparaci\xF3n"):await this.loadRepairs()}getStatusColor(n){switch(n){case"pending":return"badge-warning";case"in_progress":return"badge-info";case"completed":return"badge-success";case"delivered":return"badge-primary";case"cancelled":return"badge-error";default:return"badge-ghost"}}getStatusLabel(n){switch(n){case"pending":return"Pendiente";case"in_progress":return"En Progreso";case"completed":return"Completado";case"delivered":return"Entregado";case"cancelled":return"Cancelado";default:return n}}static \u0275fac=function(e){return new(e||r)};static \u0275cmp=_({type:r,selectors:[["app-admin-repairs-page"]],decls:27,vars:1,consts:[[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800","dark:text-green-400"],["routerLink","/admin/repairs/new",1,"btn","btn-primary"],[1,"fas","fa-plus","mr-2"],[1,"bg-white","rounded-lg","shadow","overflow-hidden","text-gray-800"],[1,"overflow-x-auto"],[1,"table","w-full"],[1,"text-gray-800"],["colspan","6",1,"text-center","py-4"],[1,"font-bold"],[1,"text-sm","opacity-50"],[1,"badge",3,"ngClass"],[1,"flex","gap-2"],[1,"btn","btn-sm","btn-ghost",3,"routerLink"],[1,"fas","fa-edit"],[1,"btn","btn-sm","btn-ghost","text-error",3,"click"],[1,"fas","fa-trash"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"h1",1),a(2,"Taller / Reparaciones"),i(),t(3,"a",2),l(4,"i",3),a(5," Nueva Reparaci\xF3n "),i()(),t(6,"div",4)(7,"div",5)(8,"table",6)(9,"thead")(10,"tr",7)(11,"th"),a(12,"Fecha"),i(),t(13,"th"),a(14,"Cliente"),i(),t(15,"th"),a(16,"Dispositivo"),i(),t(17,"th"),a(18,"Estado"),i(),t(19,"th"),a(20,"Costo Est."),i(),t(21,"th"),a(22,"Acciones"),i()()(),t(23,"tbody"),b(24,$,3,0,"tr")(25,j,3,0,"tr")(26,q,2,0),i()()()()),e&2&&(s(24),h(o.loading()?24:o.repairs().length===0?25:26))},dependencies:[D,A,T,k,I],encapsulation:2})};export{F as AdminRepairsPage};
