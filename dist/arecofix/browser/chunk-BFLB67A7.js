import{a as I}from"./chunk-FDEIW4RV.js";import"./chunk-KXBHGC7O.js";import"./chunk-SJUHAIWY.js";import"./chunk-2IHNZNBZ.js";import{l as w,m as P,o as A}from"./chunk-NGBKTTVY.js";import{Ca as u,Db as b,Fa as d,Fb as o,Gb as l,Hb as y,Ib as S,Ta as f,W as p,Wb as c,Xb as C,Yb as U,eb as E,fb as g,ib as v,jb as x,ma as r,ob as i,pb as t,qb as m,sb as h,xb as _}from"./chunk-CVZCBU36.js";import"./chunk-VOSPIT4N.js";var M=(a,n)=>n.id;function N(a,n){a&1&&(i(0,"tr")(1,"td",5),o(2,"Cargando..."),t()())}function R(a,n){a&1&&(i(0,"tr")(1,"td",5),o(2,"No hay usuarios registrados."),t()())}function k(a,n){if(a&1&&(i(0,"tr")(1,"td")(2,"div",6)(3,"div",7)(4,"div",8),m(5,"img",9),t()(),i(6,"div")(7,"div",10),o(8),t(),i(9,"div",11),o(10),t()()()(),i(11,"td")(12,"div",12),o(13),c(14,"uppercase"),t()(),i(15,"td"),o(16),c(17,"date"),t(),m(18,"td"),t()),a&2){let e=n.$implicit;d(5),h("src",e.avatar_url||"https://ui-avatars.com/api/?name="+e.first_name+"+"+e.last_name,u),d(3),S("",e.first_name," ",e.last_name),d(2),l(e.email),d(2),b("badge-primary",e.role==="admin")("badge-secondary",e.role==="staff")("badge-ghost",e.role==="user"),d(),y(" ",C(14,12,e.role)," "),d(3),l(U(17,14,e.created_at,"short"))}}function F(a,n){if(a&1&&v(0,k,19,17,"tr",null,M),a&2){let e=_();x(e.users())}}var D=class a{auth=p(I);users=r([]);loading=r(!0);async ngOnInit(){await this.loadUsers()}async loadUsers(){this.loading.set(!0);let n=this.auth.getSupabaseClient(),{data:e,error:s}=await n.from("profiles").select("*").order("created_at",{ascending:!1});e&&this.users.set(e),this.loading.set(!1)}async toggleRole(n){let e=n.role==="admin"?"user":"admin",s=this.auth.getSupabaseClient(),{error:T}=await s.from("profiles").update({role:e}).eq("id",n.id);T||await this.loadUsers()}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=f({type:a,selectors:[["app-admin-users-page"]],decls:20,vars:1,consts:[[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800"],[1,"bg-white","rounded-lg","shadow","overflow-hidden"],[1,"overflow-x-auto"],[1,"table","w-full"],["colspan","4",1,"text-center","py-4"],[1,"flex","items-center","gap-3"],[1,"avatar"],[1,"mask","mask-squircle","w-12","h-12"],["alt","Avatar",3,"src"],[1,"font-bold"],[1,"text-sm","opacity-50"],[1,"badge"]],template:function(e,s){e&1&&(i(0,"div",0)(1,"h1",1),o(2,"Usuarios"),t()(),i(3,"div",2)(4,"div",3)(5,"table",4)(6,"thead")(7,"tr")(8,"th"),o(9,"Usuario"),t(),i(10,"th"),o(11,"Rol"),t(),i(12,"th"),o(13,"Fecha Registro"),t(),i(14,"th"),o(15,"Acciones"),t()()(),i(16,"tbody"),E(17,N,3,0,"tr")(18,R,3,0,"tr")(19,F,2,0),t()()()()),e&2&&(d(17),g(s.loading()?17:s.users().length===0?18:19))},dependencies:[A,w,P],encapsulation:2})};export{D as AdminUsersPage};
