import{a as k}from"./chunk-J4Q5NFZK.js";import{c as A}from"./chunk-XECWOO46.js";import{a as D}from"./chunk-XIH5YEDL.js";import"./chunk-M7RWEG4P.js";import{o as _}from"./chunk-YNFFGNY6.js";import{o as C,q as E}from"./chunk-Q44XB7TV.js";import{Ab as t,Bb as e,Cb as r,Mb as h,Ua as s,Vb as a,W as g,Wb as d,gb as S,lc as x,ma as p,mc as b,p as y,tb as v,ub as f,zb as u}from"./chunk-DX2LKEMG.js";import"./chunk-C6Q5SG76.js";var c={primary:"#4f46e5",primaryTransparent:"rgba(79, 70, 229, 0.2)",red:"#ef4444",blue:"#3b82f6",green:"#10b981",yellow:"#f59e0b",purple:"#8b5cf6",pink:"#ec4899",indigo:"#6366f1",palette:["#ef4444","#3b82f6","#10b981","#f59e0b","#8b5cf6","#6366f1","#ec4899"],paletteAlt:["#3b82f6","#10b981","#f59e0b","#ef4444","#8b5cf6","#ec4899","#6366f1"]};function I(l,n){l&1&&(t(0,"div",2),r(1,"span",3),e())}function w(l,n){if(l&1&&(r(0,"div",50),t(1,"div",51)(2,"div",52)(3,"span",53),r(4,"i",54),t(5,"span"),a(6,"Sesi\xF3n Actual"),e()(),t(7,"span",55),a(8),e()(),t(9,"div",52)(10,"span",53),r(11,"i",56),t(12,"span"),a(13,"Usuario"),e()(),t(14,"span",57),a(15),e()(),t(16,"a",58),r(17,"i",59),a(18," Ver Dashboard Completo "),e()()),l&2){let i=h(2);s(8),d(i.analyticsStats().sessionId?"Activa":"N/A"),s(7),d(i.analyticsStats().distinctId||"An\xF3nimo")}}function P(l,n){l&1&&(t(0,"div",49),r(1,"i",60),t(2,"span"),a(3,"PostHog no est\xE1 inicializado correctamente"),e()())}function R(l,n){if(l&1&&(t(0,"div",4)(1,"div",5)(2,"div",6)(3,"div",7),r(4,"i",8),e(),t(5,"div",9),a(6,"Usuarios"),e(),t(7,"div",10),a(8),e(),t(9,"div",11),a(10,"Registrados"),e()()(),t(11,"div",5)(12,"div",6)(13,"div",12),r(14,"i",13),e(),t(15,"div",9),a(16,"Reparaciones (Mes)"),e(),t(17,"div",14),a(18),e(),t(19,"div",11),a(20,"Equipos ingresados"),e()()(),t(21,"div",5)(22,"div",6)(23,"div",15),r(24,"i",16),e(),t(25,"div",9),a(26,"Ganancia Taller"),e(),t(27,"div",17),a(28),x(29,"currency"),e(),t(30,"div",11),a(31,"Este mes"),e()()(),t(32,"div",5)(33,"div",6)(34,"div",18),r(35,"i",19),e(),t(36,"div",9),a(37,"Equipos Arreglados"),e(),t(38,"div",20),a(39),e(),t(40,"div",11),a(41,"Hist\xF3rico de Taller"),e()()(),t(42,"div",5)(43,"div",6)(44,"div",21),r(45,"i",22),e(),t(46,"div",9),a(47,"Ventas Tienda"),e(),t(48,"div",23),a(49),e(),t(50,"div",11),a(51,"Total realizadas"),e()()(),t(52,"div",5)(53,"div",6)(54,"div",24),r(55,"i",25),e(),t(56,"div",9),a(57,"Ingresos Tienda"),e(),t(58,"div",26),a(59),x(60,"currency"),e(),t(61,"div",11),a(62,"Total facturado"),e()()()(),t(63,"div",27)(64,"div",28)(65,"div",29)(66,"h2",30),a(67,"Resumen de Ventas"),e(),t(68,"div",31),r(69,"canvas",32),e()()(),t(70,"div",33)(71,"div",29)(72,"h2",30),a(73,"Productos Top"),e(),t(74,"div",34),r(75,"canvas",32),e()()(),t(76,"div",33)(77,"div",29)(78,"h2",30),a(79,"Ventas por Categor\xEDa"),e(),t(80,"div",35),r(81,"canvas",32),e()()()(),t(82,"div",36)(83,"div",33)(84,"div",29)(85,"h2",30),a(86,"Acciones R\xE1pidas"),e(),t(87,"div",37)(88,"a",38),r(89,"i",39),a(90," Nuevo Producto "),e(),t(91,"a",40),r(92,"i",41),a(93," Nueva Venta "),e(),t(94,"a",42),r(95,"i",43),a(96," Gestionar Usuarios "),e(),t(97,"a",44),r(98,"i",45),a(99," Taller "),e()()()(),t(100,"div",33)(101,"div",29)(102,"h2",30),a(103,"Analytics & Sistema"),e(),t(104,"div",46)(105,"div",47)(106,"span"),a(107,"Base de Datos"),e(),t(108,"span",48),a(109,"Conectado"),e()(),t(110,"div",47)(111,"span"),a(112,"Analytics (PostHog)"),e(),t(113,"span",48),a(114),e()(),v(115,w,19,2)(116,P,4,0,"div",49),e()()()()),l&2){let i=h();s(8),d(i.stats().users),s(10),d(i.stats().repairs_month),s(10),d(b(29,17,i.stats().repairs_revenue)),s(11),d(i.stats().devices_fixed),s(10),d(i.stats().sales),s(10),d(b(60,19,i.stats().revenue)),s(10),u("data",i.salesChartData)("options",i.salesChartOptions)("type",i.salesChartType),s(6),u("data",i.productsChartData)("options",i.productsChartOptions)("type",i.productsChartType),s(6),u("data",i.categoryChartData)("options",i.categoryChartOptions)("type",i.categoryChartType),s(33),d(i.posthogStatus()),s(),f(i.analyticsStats().enabled?115:116)}}var T=class l{analyticsRepo=g(k);analyticsService=g(D);stats=p({users:0,products:0,sales:0,revenue:0,repairs_month:0,repairs_revenue:0,devices_fixed:0});analyticsStats=p({enabled:!1,sessionId:"",distinctId:""});loading=p(!0);salesChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"bottom"},title:{display:!0,text:"Ventas del A\xF1o"}}};salesChartType="line";salesChartData={labels:[],datasets:[{data:[],label:"Ventas ($)",borderColor:c.primary,backgroundColor:c.primaryTransparent,fill:!0}]};productsChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},title:{display:!0,text:"Productos M\xE1s Vendidos"}}};productsChartType="bar";productsChartData={labels:[],datasets:[{data:[],label:"Unidades",backgroundColor:c.palette}]};categoryChartOptions={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!0,position:"right"},title:{display:!0,text:"Ventas por Categor\xEDa"}}};categoryChartType="doughnut";categoryChartData={labels:[],datasets:[{data:[],backgroundColor:c.paletteAlt}]};ngOnInit(){this.loadStats(),this.loadAnalyticsInfo()}async loadStats(){this.loading.set(!0);try{let n=await y(this.analyticsRepo.getDashboardStats());if(this.stats.set({users:n.users,products:n.products,sales:n.sales,revenue:n.revenue,repairs_month:n.repairs_month,repairs_revenue:n.repairs_revenue,devices_fixed:n.devices_fixed}),n.sales_chart&&n.sales_chart.length>0){let i=n.sales_chart.map(o=>this.formatMonth(o.period)),m=n.sales_chart.map(o=>o.total);this.salesChartData={labels:i,datasets:[{data:m,label:"Ventas ($)",borderColor:c.primary,backgroundColor:c.primaryTransparent,fill:!0}]}}if(n.products_chart&&n.products_chart.length>0){let i=n.products_chart.map(o=>o.name),m=n.products_chart.map(o=>o.quantity);this.productsChartData={labels:i,datasets:[{data:m,label:"Unidades",backgroundColor:c.palette}]}}if(n.category_chart&&n.category_chart.length>0){let i=n.category_chart.map(o=>o.name),m=n.category_chart.map(o=>o.count);this.categoryChartData={labels:i,datasets:[{data:m,backgroundColor:c.paletteAlt}]}}}catch(n){console.error("Error loading dashboard stats:",n)}finally{this.loading.set(!1)}}formatMonth(n){let[i,m]=n.split("-");return new Date(parseInt(i),parseInt(m)-1,1).toLocaleDateString("es-ES",{month:"short"})}async loadAnalyticsInfo(){this.analyticsStats.set({enabled:this.analyticsService.isEnabled(),sessionId:this.analyticsService.getSessionId(),distinctId:this.analyticsService.getDistinctId()})}posthogStatus(){return this.analyticsStats().enabled?"Activo":"Inactivo"}static \u0275fac=function(i){return new(i||l)};static \u0275cmp=S({type:l,selectors:[["app-admin-dashboard-page"]],decls:5,vars:1,consts:[[1,"p-6"],[1,"text-2xl","font-bold","mb-6","text-black","dark:text-green-400"],[1,"flex","justify-center","py-12"],[1,"loading","loading-spinner","loading-lg"],[1,"grid","grid-cols-2","lg:grid-cols-4","gap-6","mb-8"],[1,"stats","shadow","bg-base-100","dark:bg-gray-800","text-base-content","dark:text-white"],[1,"stat"],[1,"stat-figure","text-primary"],[1,"fas","fa-users","text-3xl"],[1,"stat-title","dark:text-gray-400"],[1,"stat-value","text-primary"],[1,"stat-desc","dark:text-gray-500"],[1,"stat-figure","text-warning"],[1,"fas","fa-tools","text-3xl"],[1,"stat-value","text-warning"],[1,"stat-figure","text-success"],[1,"fas","fa-hand-holding-usd","text-3xl"],[1,"stat-value","text-success"],[1,"stat-figure","text-info"],[1,"fas","fa-check-circle","text-3xl"],[1,"stat-value","text-info"],[1,"stat-figure","text-accent"],[1,"fas","fa-shopping-cart","text-3xl"],[1,"stat-value","text-accent"],[1,"stat-figure","text-secondary"],[1,"fas","fa-dollar-sign","text-3xl"],[1,"stat-value","text-secondary"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6","mb-8"],[1,"card","shadow","lg:col-span-2","bg-base-100","dark:bg-gray-800","text-base-content","dark:text-white"],[1,"card-body"],[1,"card-title","mb-4"],[1,"h-80","w-full"],["baseChart","",3,"data","options","type"],[1,"card","shadow","bg-base-100","dark:bg-gray-800","text-base-content","dark:text-white"],[1,"h-64","w-full"],[1,"h-64","w-full","flex","justify-center"],[1,"grid","grid-cols-1","lg:grid-cols-2","gap-6"],[1,"grid","grid-cols-2","gap-4"],["routerLink","/admin/products/new",1,"btn","btn-outline","btn-primary"],[1,"fas","fa-plus","mr-2"],["routerLink","/admin/sales",1,"btn","btn-outline","btn-accent"],[1,"fas","fa-cash-register","mr-2"],["routerLink","/admin/users",1,"btn","btn-outline","dark:text-white","dark:border-white","dark:hover:bg-white","dark:hover:text-gray-900"],[1,"fas","fa-user-plus","mr-2"],["routerLink","/admin/repairs",1,"btn","btn-outline","btn-secondary"],[1,"fas","fa-tools","mr-2"],[1,"space-y-4"],[1,"flex","justify-between","items-center"],[1,"badge","badge-success"],[1,"alert","alert-warning","text-xs","mt-4"],[1,"divider","my-2"],[1,"space-y-3"],[1,"flex","justify-between","items-center","text-sm"],[1,"flex","items-center","gap-2"],[1,"fas","fa-eye","text-info"],[1,"font-semibold"],[1,"fas","fa-user","text-primary"],[1,"font-semibold","text-xs"],["href","https://us.posthog.com/project/253677/dashboard/791256","target","_blank",1,"btn","btn-sm","btn-outline","btn-info","w-full","mt-2"],[1,"fas","fa-chart-line","mr-2"],[1,"fas","fa-exclamation-triangle"]],template:function(i,m){i&1&&(t(0,"div",0)(1,"h1",1),a(2,"Panel de Control"),e(),v(3,I,2,0,"div",2)(4,R,117,21),e()),i&2&&(s(3),f(m.loading()?3:4))},dependencies:[E,_,A,C],encapsulation:2})};export{T as AdminDashboardPage};
