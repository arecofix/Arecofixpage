import{a as T,b as L,d as k,e as I,f as B,g as V,h as j,l as q,m as O,n as R,p as G,s as U}from"./chunk-VC54SGJZ.js";import{a as D}from"./chunk-SFGK2H4E.js";import"./chunk-RLEXB5XQ.js";import{e as F,g as W,h as N}from"./chunk-UWELTD43.js";import"./chunk-KREPGFQR.js";import"./chunk-T7AXESXA.js";import{r as A}from"./chunk-IZ4CGVWK.js";import{Ab as S,Bb as h,Cb as t,Db as i,Eb as y,Ob as M,Qb as _,Wa as d,Xb as E,Y as b,Yb as r,Zb as C,_b as P,ac as m,bc as s,cc as u,ib as v,oa as c,vb as p,wb as f,zb as w}from"./chunk-IZKGPZFC.js";import{a as x}from"./chunk-VOSPIT4N.js";var H=(o,l)=>l.id;function J(o,l){if(o&1&&(t(0,"div",7),y(1,"i",33),t(2,"span"),r(3),i()()),o&2){let a=_();d(3),C(a.error())}}function K(o,l){if(o&1&&y(0,"i",34),o&2){let a=_();E(a.form().image_url)}}function Q(o,l){o&1&&(t(0,"span",17),r(1,"N/A"),i())}function X(o,l){if(o&1&&(t(0,"option",35),r(1),i()),o&2){let a=_().$implicit;h("value",a.id),d(),C(a.name)}}function Y(o,l){if(o&1&&p(0,X,2,2,"option",35),o&2){let a=l.$implicit,e=_();f(a.id!==e.id?0:-1)}}function Z(o,l){o&1&&y(0,"span",32)}var z=class o{route=b(F);router=b(W);auth=b(D);id=null;categories=c([]);form=c({name:"",slug:"",description:"",image_url:"",type:"product",parent_id:"",is_active:!0});loading=c(!0);saving=c(!1);error=c(null);async ngOnInit(){this.id=this.route.snapshot.paramMap.get("id");let l=this.auth.getSupabaseClient(),{data:a}=await l.from("categories").select("id, name").eq("is_active",!0).order("name");if(a&&this.categories.set(a),this.id){let{data:e,error:g}=await l.from("categories").select("*").eq("id",this.id).single();e&&this.form.set({name:e.name,slug:e.slug,description:e.description||"",image_url:e.image_url||e.icon||"",type:e.type,parent_id:e.parent_id||null,is_active:e.is_active})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let l=this.auth.getSupabaseClient(),a=x({},this.form());a.slug||(a.slug=this.slugify(a.name));try{if(this.id){let{error:e}=await l.from("categories").update(a).eq("id",this.id);if(e)throw e}else{let{error:e}=await l.from("categories").insert(a);if(e)throw e}this.router.navigate(["/admin/categories"])}catch(e){this.error.set(e.message)}finally{this.saving.set(!1)}}slugify(l){return l.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-")}static \u0275fac=function(a){return new(a||o)};static \u0275cmp=v({type:o,selectors:[["app-admin-category-form-page"]],decls:62,vars:13,consts:[[1,"max-w-4xl","mx-auto","text-gray-800"],[1,"flex","items-center","gap-4","mb-6"],["routerLink","/admin/categories",1,"btn","btn-circle","btn-ghost"],[1,"fas","fa-arrow-left"],[1,"text-2xl","font-bold","text-gray-800"],[3,"ngSubmit"],[1,"bg-white","p-6","rounded-xl","shadow-sm","border","border-gray-100","mb-6"],[1,"alert","alert-error","mb-6"],[1,"mb-4"],[1,"block","text-sm","font-medium","text-gray-700","mb-1.5"],["type","text","name","name","required","",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],["type","text","name","slug","placeholder","Se genera autom\xE1ticamente si se deja vac\xEDo",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],["name","description","rows","4",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],[1,"flex","gap-4"],["type","text","name","image_url","placeholder","Ej: fas fa-mobile-alt",1,"flex-1","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],[1,"w-12","h-10","flex","items-center","justify-center","bg-gray-100","rounded-lg","border","border-gray-200"],[1,"text-xl","text-gray-700",3,"class"],[1,"text-xs","text-gray-400"],[1,"text-xs","text-gray-500","mt-1"],["name","type",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],["value","product"],["value","course"],["value","service"],["name","parent_id",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],[3,"ngValue"],[1,"mt-6"],[1,"flex","items-center","gap-3","p-3","bg-white","border","border-gray-200","rounded-lg","hover:bg-gray-50","transition-colors","cursor-pointer","w-fit"],["type","checkbox","name","is_active",1,"checkbox","checkbox-primary","h-5","w-5","rounded","border-gray-300",3,"ngModelChange","ngModel"],[1,"font-medium","text-gray-700"],[1,"flex","justify-end","gap-4","mt-6"],["routerLink","/admin/categories",1,"btn","btn-ghost"],["type","submit",1,"btn","btn-primary","px-8",3,"disabled"],[1,"loading","loading-spinner","loading-xs","mr-2"],[1,"fas","fa-exclamation-circle"],[1,"text-xl","text-gray-700"],[3,"value"]],template:function(a,e){a&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),y(3,"i",3),i(),t(4,"h1",4),r(5),i()(),t(6,"form",5),M("ngSubmit",function(){return e.save()}),t(7,"div",6),p(8,J,4,1,"div",7),t(9,"div",8)(10,"label",9),r(11,"Nombre"),i(),t(12,"input",10),u("ngModelChange",function(n){return s(e.form().name,n)||(e.form().name=n),n}),i()(),t(13,"div",8)(14,"label",9),r(15,"Slug (URL)"),i(),t(16,"input",11),u("ngModelChange",function(n){return s(e.form().slug,n)||(e.form().slug=n),n}),i()(),t(17,"div",8)(18,"label",9),r(19,"Descripci\xF3n"),i(),t(20,"textarea",12),u("ngModelChange",function(n){return s(e.form().description,n)||(e.form().description=n),n}),i()(),t(21,"div",8)(22,"label",9),r(23,"Icono (Font Awesome)"),i(),t(24,"div",13)(25,"input",14),u("ngModelChange",function(n){return s(e.form().image_url,n)||(e.form().image_url=n),n}),i(),t(26,"div",15),p(27,K,1,2,"i",16)(28,Q,2,0,"span",17),i()(),t(29,"p",18),r(30,"Usa clases de Font Awesome (ej: fas fa-mobile-alt, fas fa-laptop)"),i()(),t(31,"div",8)(32,"label",9),r(33,"Tipo"),i(),t(34,"select",19),u("ngModelChange",function(n){return s(e.form().type,n)||(e.form().type=n),n}),t(35,"option",20),r(36,"Producto"),i(),t(37,"option",21),r(38,"Curso"),i(),t(39,"option",22),r(40,"Servicio"),i()()(),t(41,"div",8)(42,"label",9),r(43,"Categor\xEDa Padre"),i(),t(44,"select",23),u("ngModelChange",function(n){return s(e.form().parent_id,n)||(e.form().parent_id=n),n}),t(45,"option",24),r(46,"Ninguna (Categor\xEDa Principal)"),i(),w(47,Y,1,1,null,null,H),i(),t(49,"p",18),r(50,"Selecciona una categor\xEDa padre para anidar esta categor\xEDa dentro de ella."),i()(),t(51,"div",25)(52,"label",26)(53,"input",27),u("ngModelChange",function(n){return s(e.form().is_active,n)||(e.form().is_active=n),n}),i(),t(54,"span",28),r(55,"Activo"),i()()()(),t(56,"div",29)(57,"a",30),r(58,"Cancelar"),i(),t(59,"button",31),p(60,Z,1,0,"span",32),r(61," Guardar "),i()()()()),a&2&&(d(5),P("",e.id?"Editar":"Nueva"," Categor\xEDa"),d(3),f(e.error()?8:-1),d(4),m("ngModel",e.form().name),d(4),m("ngModel",e.form().slug),d(4),m("ngModel",e.form().description),d(5),m("ngModel",e.form().image_url),d(2),f(e.form().image_url?27:28),d(7),m("ngModel",e.form().type),d(10),m("ngModel",e.form().parent_id),d(),h("ngValue",null),d(2),S(e.categories()),d(6),m("ngModel",e.form().is_active),d(6),h("disabled",e.saving()),d(),f(e.saving()?60:-1))},dependencies:[A,U,j,O,R,L,T,q,k,I,G,V,B,N],encapsulation:2})};export{z as AdminCategoryFormPage};
