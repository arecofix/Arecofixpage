import{a as F,b as W,d as D,e as L,f as T,g as k,h as I,l as B,m as O,n as R,p as V,r as q}from"./chunk-7O7W7WR5.js";import{a as N}from"./chunk-OHJFPZOR.js";import{a as E,c as P,d as A}from"./chunk-AJRMDIKY.js";import"./chunk-RSKPTTFK.js";import"./chunk-I2U5KM5M.js";import{m as x}from"./chunk-AKNEBTX5.js";import{Cb as o,Db as M,Ea as r,Eb as w,Gb as s,Hb as d,Ib as g,Ra as C,W as p,bb as y,cb as h,hb as _,ib as t,jb as a,kb as f,ma as c,sb as b,ub as S}from"./chunk-MMCFFNKD.js";import{a as v}from"./chunk-VOSPIT4N.js";function G(m,l){if(m&1&&(t(0,"div",7),f(1,"i",25),t(2,"span"),o(3),a()()),m&2){let i=S();r(3),M(i.error())}}function U(m,l){m&1&&f(0,"span",24)}var j=class m{route=p(E);router=p(P);auth=p(N);id=null;form=c({name:"",slug:"",description:"",type:"product",is_active:!0},{});loading=c(!0,{});saving=c(!1,{});error=c(null,{});async ngOnInit(){if(this.id=this.route.snapshot.paramMap.get("id"),this.id){let l=this.auth.getSupabaseClient(),{data:i,error:e}=await l.from("categories").select("*").eq("id",this.id).single();i&&this.form.set({name:i.name,slug:i.slug,description:i.description||"",type:i.type,is_active:i.is_active})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let l=this.auth.getSupabaseClient(),i=v({},this.form());i.slug||(i.slug=this.slugify(i.name));try{if(this.id){let{error:e}=await l.from("categories").update(i).eq("id",this.id);if(e)throw e}else{let{error:e}=await l.from("categories").insert(i);if(e)throw e}this.router.navigate(["/admin/categories"])}catch(e){this.error.set(e.message)}finally{this.saving.set(!1)}}slugify(l){return l.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w\-]+/g,"").replace(/\-\-+/g,"-")}static \u0275fac=function(i){return new(i||m)};static \u0275cmp=C({type:m,selectors:[["app-admin-category-form-page"]],decls:42,vars:9,consts:[[1,"max-w-4xl","mx-auto","text-gray-800"],[1,"flex","items-center","gap-4","mb-6"],["routerLink","/admin/categories",1,"btn","btn-circle","btn-ghost"],[1,"fas","fa-arrow-left"],[1,"text-2xl","font-bold","text-gray-800"],[3,"ngSubmit"],[1,"admin-form-section"],[1,"alert","alert-error","mb-6"],[1,"mb-4"],[1,"admin-form-label"],["type","text","name","name","required","",1,"admin-form-input",3,"ngModelChange","ngModel"],["type","text","name","slug","placeholder","Se genera autom\xE1ticamente si se deja vac\xEDo",1,"admin-form-input",3,"ngModelChange","ngModel"],["name","description","rows","4",1,"admin-form-textarea",3,"ngModelChange","ngModel"],["name","type",1,"admin-form-select",3,"ngModelChange","ngModel"],["value","product"],["value","course"],["value","service"],[1,"mt-6"],[1,"admin-form-checkbox-container","w-fit"],["type","checkbox","name","is_active",1,"checkbox","checkbox-primary","admin-form-checkbox",3,"ngModelChange","ngModel"],[1,"font-medium","text-gray-700"],[1,"flex","justify-end","gap-4","mt-6"],["routerLink","/admin/categories",1,"btn","btn-ghost"],["type","submit",1,"btn","btn-primary","px-8",3,"disabled"],[1,"loading","loading-spinner","loading-xs","mr-2"],[1,"fas","fa-exclamation-circle"]],template:function(i,e){i&1&&(t(0,"div",0)(1,"div",1)(2,"a",2),f(3,"i",3),a(),t(4,"h1",4),o(5),a()(),t(6,"form",5),b("ngSubmit",function(){return e.save()}),t(7,"div",6),y(8,G,4,1,"div",7),t(9,"div",8)(10,"label",9),o(11,"Nombre"),a(),t(12,"input",10),g("ngModelChange",function(n){return d(e.form().name,n)||(e.form().name=n),n}),a()(),t(13,"div",8)(14,"label",9),o(15,"Slug (URL)"),a(),t(16,"input",11),g("ngModelChange",function(n){return d(e.form().slug,n)||(e.form().slug=n),n}),a()(),t(17,"div",8)(18,"label",9),o(19,"Descripci\xF3n"),a(),t(20,"textarea",12),g("ngModelChange",function(n){return d(e.form().description,n)||(e.form().description=n),n}),a()(),t(21,"div",8)(22,"label",9),o(23,"Tipo"),a(),t(24,"select",13),g("ngModelChange",function(n){return d(e.form().type,n)||(e.form().type=n),n}),t(25,"option",14),o(26,"Producto"),a(),t(27,"option",15),o(28,"Curso"),a(),t(29,"option",16),o(30,"Servicio"),a()()(),t(31,"div",17)(32,"label",18)(33,"input",19),g("ngModelChange",function(n){return d(e.form().is_active,n)||(e.form().is_active=n),n}),a(),t(34,"span",20),o(35,"Activo"),a()()()(),t(36,"div",21)(37,"a",22),o(38,"Cancelar"),a(),t(39,"button",23),y(40,U,1,0,"span",24),o(41," Guardar "),a()()()()),i&2&&(r(5),w("",e.id?"Editar":"Nueva"," Categor\xEDa"),r(3),h(e.error()?8:-1),r(4),s("ngModel",e.form().name),r(4),s("ngModel",e.form().slug),r(4),s("ngModel",e.form().description),r(4),s("ngModel",e.form().type),r(9),s("ngModel",e.form().is_active),r(6),_("disabled",e.saving()),r(),h(e.saving()?40:-1))},dependencies:[x,q,I,O,R,W,F,B,D,L,V,k,T,A],encapsulation:2})};export{j as AdminCategoryFormPage};
