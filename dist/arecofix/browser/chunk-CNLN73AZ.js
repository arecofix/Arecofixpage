import{a as ie}from"./chunk-ZRFETJ5L.js";import"./chunk-YSO73UTU.js";import{b as j,d as O,g as q,i as G,l as H,m as $,n as J,o as K,s as Q}from"./chunk-JC43VCPH.js";import{a as te}from"./chunk-JN7L6HD4.js";import{a as U,b as X}from"./chunk-PHYG3LA5.js";import{a as ee}from"./chunk-Z4MDNPYS.js";import"./chunk-H35YZ3UA.js";import"./chunk-FNOMVEKC.js";import{a as z}from"./chunk-DPJR5SBS.js";import{a as Y,c as Z}from"./chunk-Q3ZQP6TG.js";import"./chunk-CPI2BPDE.js";import{d as V}from"./chunk-6KV2MRTQ.js";import"./chunk-NR3BVOML.js";import{e as A,g as W}from"./chunk-Z245BGFQ.js";import"./chunk-IIPDUD2U.js";import{a as B}from"./chunk-T7AXESXA.js";import{r as L}from"./chunk-L5RZOCV7.js";import{Ab as C,Bb as S,Cb as n,Db as o,Eb as p,Kb as D,Ob as m,Qb as c,Wa as d,Wb as E,Y as g,Yb as a,Zb as R,_b as N,ac as b,ba as T,bc as _,ca as I,cc as y,ib as F,oa as u,q as w,vb as f,vc as M,wb as x,zb as v}from"./chunk-SISNN44B.js";import{a as h,c as k}from"./chunk-VOSPIT4N.js";var P=(r,t)=>t.id;function oe(r,t){if(r&1){let i=D();n(0,"li")(1,"button",20),m("click",function(){let l=T(i).$implicit,s=c();return s.filterState.category=l.id,I(s.applyFilters())}),a(2),o()()}if(r&2){let i=t.$implicit,e=c();d(),E("text-blue-600",e.filterState.category===i.id)("font-semibold",e.filterState.category===i.id)("bg-blue-50",e.filterState.category===i.id),d(),N(" ",i.name," ")}}function re(r,t){if(r&1&&(n(0,"option",23),a(1),o()),r&2){let i=t.$implicit;S("value",i.id),d(),R(i.name)}}function ae(r,t){if(r&1&&(a(0," Mostrando "),n(1,"span",45),a(2),o(),a(3," resultados ")),r&2){let i=c();d(2),R(i.productsRs.value().items)}}function le(r,t){r&1&&a(0," Cargando... ")}function se(r,t){r&1&&p(0,"is-loading")}function de(r,t){if(r&1&&(n(0,"div",35)(1,"span"),a(2),o()()),r&2){let i=c();d(2),R(i.initError()||"Error al cargar productos.")}}function pe(r,t){r&1&&p(0,"is-empty")}function ce(r,t){if(r&1&&p(0,"product-card",47),r&2){let i=t.$implicit,e=t.$index;S("product",i)("isPriority",e<2)}}function ge(r,t){if(r&1&&(n(0,"div",48),p(1,"pagination",49),o()),r&2){let i=c(3);d(),S("pages",i.productsRs.value().pages)("currentPage",i.paginationService.currentPage())}}function ue(r,t){if(r&1&&(n(0,"div",46),v(1,ce,1,2,"product-card",47,P),o(),f(3,ge,2,2,"div",48)),r&2){let i=c(2);d(),C(i.productsRs.value().data),d(2),x(i.paginationData()?3:-1)}}function me(r,t){if(r&1&&f(0,pe,1,0,"is-empty")(1,ue,4,1),r&2){let i=c();x(i.productsRs.value().data.length===0?0:1)}}var ne=class r{whatsappNumber=B.contact.whatsappNumber;router=g(W);route=g(A);categoryService=g(z);productService=g(ee);brandRepo=g(ie);paginationService=g(U);categories=u([]);brands=u([]);repuestosRootId=u(null);visibleCategories=M(()=>{let t=this.repuestosRootId();return t?this.categories().filter(i=>i.parent_id===t):[]});filterState={search:"",category:"all",category_ids:[],brand:"all",maxPrice:null,sort:"relevance"};isInitialized=u(!1);initError=u(null);activeFilter=u(h({},this.filterState));productsRs=V({stream:()=>{if(!this.isInitialized())return w({data:[],items:0,pages:0,first:1,last:1,prev:void 0,next:void 0});let t=this.activeFilter(),e={_page:this.paginationService.currentPage()||1,_per_page:12};if(t.search&&(e.name=t.search),t.category!=="all"){let l=this.getAllChildIds(t.category,this.categories());e.category_ids=l}else if(t.category_ids.length>0)e.category_ids=t.category_ids;else return w({data:[],items:0,pages:0,first:1,last:1,prev:void 0,next:void 0});return t.brand!=="all"&&(e.brand_id=t.brand),t.maxPrice&&(e.price=t.maxPrice),this.productService.getData(e)}});paginationData=M(()=>{let t=this.productsRs.value();if(!t)return null;let l=t,{data:i}=l;return k(l,["data"])});async ngOnInit(){await this.loadCategories(),await this.loadBrands()}async loadCategories(){this.categoryService.getData({_page:1,_per_page:500}).subscribe(t=>{let i=t.data;this.categories.set(i),console.log(`RepuestosPage: Loaded ${i.length} categories.`);let e=i.find(l=>l.slug.toLowerCase()==="repuestos"||l.name.toLowerCase()==="repuestos"||l.slug.toLowerCase().includes("repuesto"));e?(console.log("RepuestosPage: Found Repuestos in list:",e),this.initializeRepuestosFilter(e,i)):(console.warn('RepuestosPage: "Repuestos" not found in initial list. Trying slug fetch...'),this.categoryService.getDataBySlug("repuestos").subscribe(l=>{l.data&&l.data.length>0?(e=l.data[0],this.initializeRepuestosFilter(e,i)):(console.error("RepuestosPage: FATAL - Could not find Repuestos category even by slug!"),this.initError.set("No se pudo encontrar la categor\xEDa Repuestos."),this.isInitialized.set(!0))}))})}initializeRepuestosFilter(t,i){this.repuestosRootId.set(t.id);let e=this.getAllChildIds(t.id,i);console.log(`RepuestosPage: Generated ${e.length} recursive IDs for filter:`,e),this.filterState.category="all",this.filterState.category_ids=e,this.activeFilter.set(h({},this.filterState)),this.isInitialized.set(!0)}getAllChildIds(t,i){let e=[t];return i.filter(s=>s.parent_id===t).forEach(s=>{e=[...e,...this.getAllChildIds(s.id,i)]}),e}async loadBrands(){try{let t=await this.brandRepo.findAll({column:"name",ascending:!0});this.brands.set(t)}catch(t){console.error("Error loading brands",t)}}applyFilters(){this.activeFilter.set(h({},this.filterState)),this.router.navigate([],{relativeTo:this.route,queryParams:{_page:1},queryParamsHandling:"merge"})}goToHome(){this.router.navigate(["/"])}static \u0275fac=function(i){return new(i||r)};static \u0275cmp=F({type:r,selectors:[["app-repuestos"]],decls:95,vars:12,consts:[[1,"relative","bg-gray-900","text-white","py-12","mb-8","overflow-hidden"],[1,"absolute","inset-0","opacity-20","bg-linear-to-r","from-blue-900","to-indigo-900"],[1,"absolute","top-0","right-0","-mr-20","-mt-20","w-64","h-64","rounded-full","bg-blue-500","opacity-10","blur-3xl"],[1,"absolute","bottom-0","left-0","-ml-20","-mb-20","w-64","h-64","rounded-full","bg-indigo-500","opacity-10","blur-3xl"],[1,"relative","container","mx-auto","px-4"],[1,"max-w-3xl"],[1,"text-sm","breadcrumbs","text-gray-300","mb-4"],["routerLink","/"],["routerLink","/products"],[1,"font-semibold","text-white"],[1,"text-4xl","md:text-5xl","font-bold","mb-4","tracking-tight"],[1,"text-lg","text-gray-300","max-w-2xl","leading-relaxed"],[1,"container","mx-auto","px-4","pb-16"],[1,"flex","flex-col","lg:flex-row","gap-8"],[1,"hidden","lg:block","w-64","shrink-0"],[1,"sticky","top-24","space-y-8"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-sm","border","border-gray-100","dark:border-gray-700","p-6"],[1,"font-bold","text-gray-900","dark:text-white","mb-4","text-lg"],["type","text","placeholder","Ej: Pantalla iPhone 12",1,"w-full","rounded-lg","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-600",3,"ngModelChange","ngModel"],[1,"space-y-2"],[1,"w-full","text-left","block","px-3","py-2","rounded-lg","text-gray-600","dark:text-gray-300","hover:bg-gray-50","dark:hover:bg-gray-700","hover:text-blue-600","transition-colors",3,"click"],[1,"w-full","rounded-lg","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-600",3,"ngModelChange","ngModel"],["value","all"],[3,"value"],[1,"space-y-4"],["type","number","min","0","placeholder","Ej: 20000",1,"w-full","rounded-lg","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-600",3,"ngModelChange","ngModel"],[1,"flex-1"],[1,"flex","flex-wrap","items-center","justify-between","mb-6","bg-white","dark:bg-gray-800","p-4","rounded-xl","shadow-sm","border","border-gray-100","dark:border-gray-700"],[1,"text-gray-600","dark:text-gray-300"],[1,"flex","items-center","gap-4"],[1,"select","select-bordered","select-sm","w-full","max-w-xs","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","border-gray-300","dark:border-gray-600",3,"ngModelChange","ngModel"],["value","relevance"],["value","price-asc"],["value","price-desc"],["value","rating-desc"],[1,"alert","alert-error"],[1,"py-16","bg-indigo-900","text-white","mt-8"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-8","text-center"],[1,"fas","fa-shipping-fast","text-5xl","mb-4","text-indigo-300"],[1,"text-xl","font-bold","mb-2"],[1,"text-indigo-200"],[1,"fas","fa-shield-check","text-5xl","mb-4","text-indigo-300"],[1,"fas","fa-tags","text-5xl","mb-4","text-indigo-300"],[1,"fas","fa-headset","text-5xl","mb-4","text-indigo-300"],[1,"font-semibold","text-gray-900","dark:text-white"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6"],[3,"product","isPriority"],[1,"mt-12","flex","justify-center"],[3,"pages","currentPage"]],template:function(i,e){i&1&&(n(0,"div",0),p(1,"div",1)(2,"div",2)(3,"div",3),n(4,"div",4)(5,"div",5)(6,"div",6)(7,"ul")(8,"li")(9,"a",7),a(10,"Inicio"),o()(),n(11,"li")(12,"a",8),a(13,"Productos"),o()(),n(14,"li",9),a(15,"Repuestos"),o()()(),n(16,"h1",10),a(17," Repuestos para Celulares "),o(),n(18,"p",11),a(19," Los mejores repuestos originales y compatibles para tu dispositivo. "),o()()()(),n(20,"div",12)(21,"div",13)(22,"aside",14)(23,"div",15)(24,"div",16)(25,"h3",17),a(26,"Buscar"),o(),n(27,"input",18),y("ngModelChange",function(s){return _(e.filterState.search,s)||(e.filterState.search=s),s}),m("ngModelChange",function(){return e.applyFilters()}),o()(),n(28,"div",16)(29,"h3",17),a(30,"Categor\xEDas"),o(),n(31,"ul",19)(32,"li")(33,"button",20),m("click",function(){return e.filterState.category="all",e.applyFilters()}),a(34," Todas "),o()(),v(35,oe,3,7,"li",null,P),o()(),n(37,"div",16)(38,"h3",17),a(39,"Marcas"),o(),n(40,"select",21),y("ngModelChange",function(s){return _(e.filterState.brand,s)||(e.filterState.brand=s),s}),m("ngModelChange",function(){return e.applyFilters()}),n(41,"option",22),a(42,"Todas"),o(),v(43,re,2,2,"option",23,P),o()(),n(45,"div",16)(46,"h3",17),a(47,"Precio M\xE1ximo"),o(),n(48,"div",24)(49,"input",25),y("ngModelChange",function(s){return _(e.filterState.maxPrice,s)||(e.filterState.maxPrice=s),s}),m("ngModelChange",function(){return e.applyFilters()}),o()()()()(),n(50,"main",26)(51,"div",27)(52,"div",28),f(53,ae,4,1)(54,le,1,0),o(),n(55,"div",29)(56,"select",30),y("ngModelChange",function(s){return _(e.filterState.sort,s)||(e.filterState.sort=s),s}),m("ngModelChange",function(){return e.applyFilters()}),n(57,"option",31),a(58,"Relevancia"),o(),n(59,"option",32),a(60,"Precio: menor a mayor"),o(),n(61,"option",33),a(62,"Precio: mayor a menor"),o(),n(63,"option",34),a(64,"Mejor valoraci\xF3n"),o()()()(),f(65,se,1,0,"is-loading")(66,de,3,1,"div",35)(67,me,2,1),o()()(),n(68,"section",36)(69,"div",37)(70,"div",38)(71,"div"),p(72,"i",39),n(73,"h3",40),a(74,"Env\xEDo R\xE1pido"),o(),n(75,"p",41),a(76,"Entregas en 24-48 horas"),o()(),n(77,"div"),p(78,"i",42),n(79,"h3",40),a(80,"Garant\xEDa"),o(),n(81,"p",41),a(82,"Todos los repuestos con garant\xEDa"),o()(),n(83,"div"),p(84,"i",43),n(85,"h3",40),a(86,"Mejores Precios"),o(),n(87,"p",41),a(88,"Precios mayoristas disponibles"),o()(),n(89,"div"),p(90,"i",44),n(91,"h3",40),a(92,"Asesoramiento"),o(),n(93,"p",41),a(94,"Soporte t\xE9cnico incluido"),o()()()()()),i&2&&(d(27),b("ngModel",e.filterState.search),d(6),E("text-blue-600",e.filterState.category==="all")("font-semibold",e.filterState.category==="all")("bg-blue-50",e.filterState.category==="all"),d(2),C(e.visibleCategories()),d(5),b("ngModel",e.filterState.brand),d(3),C(e.brands()),d(6),b("ngModel",e.filterState.maxPrice),d(4),x(e.productsRs.hasValue()?53:54),d(3),b("ngModel",e.filterState.sort),d(9),x(!e.isInitialized()||e.productsRs.isLoading()?65:e.productsRs.error()||e.initError()?66:e.productsRs.hasValue()?67:-1))},dependencies:[L,Q,$,J,j,G,H,O,K,q,Y,Z,te,X],encapsulation:2})};export{ne as RepuestosComponent};
