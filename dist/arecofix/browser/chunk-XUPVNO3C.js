import{a as j}from"./chunk-JZSLHTBV.js";import"./chunk-BYXBJQAS.js";import"./chunk-FBYEXMDY.js";import"./chunk-ECZXGVFH.js";import{b as G,d as U,g as V,m as F,n as B,o as q,t as Y}from"./chunk-63CMMPDH.js";import"./chunk-P2JKZEUE.js";import"./chunk-XIH5YEDL.js";import"./chunk-M7RWEG4P.js";import{o as O}from"./chunk-YNFFGNY6.js";import{j as P,m as L,o as M,q as k}from"./chunk-Q44XB7TV.js";import{$ as _,Ab as e,Bb as i,Cb as l,Gb as S,Kb as b,Mb as g,Ua as s,Vb as n,W as C,Wb as u,Xb as x,aa as h,gb as R,hc as D,lc as v,ma as p,nc as I,pc as T,tb as y,ub as E,uc as w,xb as A,yb as N,zb as m}from"./chunk-DX2LKEMG.js";import"./chunk-C6Q5SG76.js";var f=class{static getStatusUI(a){return{1:{label:"PENDIENTE DE DIAGN\xD3STICO",class:"bg-amber-100 text-amber-800 border-amber-200",description:"El equipo ha sido recibido y espera ser revisado por un t\xE9cnico."},2:{label:"GESTI\xD3N DE REPUESTOS",class:"bg-cyan-100 text-cyan-800 border-cyan-200",description:"Estamos localizando o esperando los repuestos necesarios."},3:{label:"EN REPARACI\xD3N",class:"bg-blue-100 text-blue-800 border-blue-200",description:"Un t\xE9cnico est\xE1 trabajando actualmente en su equipo."},4:{label:"CONTROL DE CALIDAD",class:"bg-indigo-100 text-indigo-800 border-indigo-200",description:"La reparaci\xF3n ha finalizado y estamos testeando todas las funciones."},5:{label:"LISTO PARA RETIRAR",class:"bg-green-100 text-green-800 border-green-200",description:"\xA1Buenas noticias! Puede pasar a retirar su equipo."},6:{label:"ENTREGADO",class:"bg-slate-100 text-slate-800 border-slate-200",description:"El equipo ha sido entregado al cliente conforme."},7:{label:"CANCELADO",class:"bg-rose-100 text-rose-800 border-rose-200",description:"La reparaci\xF3n ha sido cancelada o fue rechazada."}}[a]||{label:"DESCONOCIDO",class:"bg-slate-100 text-slate-700",description:"Estado no identificado."}}static getAdminBadgeClass(a){switch(a){case 1:return"badge-warning";case 2:return"badge-info";case 3:return"badge-primary";case 4:return"badge-accent";case 5:return"badge-success";case 6:return"badge-ghost opacity-70";case 7:return"badge-error";default:return"badge-ghost"}}};var W=o=>["/admin/repairs",o],$=(o,a)=>a.id;function K(o,a){if(o&1){let t=S();e(0,"div",16),l(1,"i",24),e(2,"span"),n(3),i(),e(4,"button",25),b("click",function(){_(t);let d=g();return h(d.loadRepairs())}),n(5,"Reintentar"),i()()}if(o&2){let t=g();s(3),u(t.error())}}function Q(o,a){o&1&&(e(0,"tr")(1,"td",26),l(2,"span",27),e(3,"p",28),n(4,"Cargando taller..."),i()()())}function H(o,a){o&1&&(e(0,"tr")(1,"td",29)(2,"div",30),l(3,"i",31),i(),e(4,"p",32),n(5,"No hay reparaciones que coincidan con la b\xFAsqueda."),i()()())}function J(o,a){if(o&1){let t=S();e(0,"tr",33)(1,"td",34)(2,"div",35),n(3),v(4,"date"),i(),e(5,"span",36),n(6),i()(),e(7,"td")(8,"div",37),n(9),i(),e(10,"div",38),l(11,"i",39),n(12),i(),e(13,"div",40),n(14),i()(),e(15,"td")(16,"div",41),n(17),i()(),e(18,"td")(19,"div",42),n(20),i()(),e(21,"td",43),n(22),v(23,"currency"),i(),e(24,"td",22)(25,"div",44)(26,"a",45),l(27,"i",46),i(),e(28,"button",47),b("click",function(){let d=_(t).$implicit,c=g(2);return h(c.deleteRepair(d.id))}),l(29,"i",48),i()()()()}if(o&2){let t=a.$implicit,r=g(2);s(3),u(I(4,11,t.received_at||t.created_at,"dd/MM/yyyy")),s(2),m("ngClass",r.getWarrantyStatus(t.received_at||t.created_at).class),s(),x(" ",r.getWarrantyStatus(t.received_at||t.created_at).label," "),s(3),u(t.customer_name),s(3),x(" ",t.customer_phone),s(2),u(t.tracking_code),s(3),u(t.device_model),s(2),m("ngClass",r.getStatusBadgeClass(t.current_status_id)),s(),x(" ",r.getStatusLabel(t.current_status_id)," "),s(2),x(" ",T(23,14,t.estimated_cost,"ARS","symbol-narrow","1.0-0")," "),s(4),m("routerLink",D(19,W,t.id))}}function X(o,a){if(o&1&&A(0,J,30,21,"tr",33,$),o&2){let t=g();N(t.filteredRepairs())}}var z=class o{repairService=C(j);repairs=p([]);loading=p(!0);error=p(null);searchTerm=p("");filterType=p("all");filteredRepairs=w(()=>{let a=this.searchTerm().toLowerCase(),t=this.filterType();return this.repairs().filter(r=>{let d=r.customer_name?.toLowerCase().includes(a)||r.customer_phone?.toLowerCase().includes(a)||r.device_model?.toLowerCase().includes(a)||r.tracking_code?.toLowerCase().includes(a),c=t==="all"||r.device_model?.toLowerCase().includes(t.toLowerCase());return d&&c})});date=new Date;async ngOnInit(){await this.loadRepairs()}async loadRepairs(){this.loading.set(!0),this.error.set(null);try{let a=await this.repairService.getAdminList();this.repairs.set(a)}catch(a){this.error.set("Error al cargar las reparaciones: "+a.message)}finally{this.loading.set(!1)}}async deleteRepair(a){if(confirm("\xBFEst\xE1s seguro de eliminar este registro de reparaci\xF3n?"))try{this.loading.set(!0),await this.repairService.delete(a),await this.loadRepairs()}catch(t){alert("Error al eliminar la reparaci\xF3n: "+t.message),this.loading.set(!1)}}getWarrantyStatus(a){if(!a)return{label:"N/A",class:"badge-ghost opacity-50"};let t=new Date(a),r=Math.abs(this.date.getTime()-t.getTime());return Math.ceil(r/(1e3*60*60*24))<=30?{label:"EN GARANT\xCDA",class:"badge-success"}:{label:"VENCIDA",class:"badge-ghost opacity-50"}}getStatusBadgeClass(a){return f.getAdminBadgeClass(a)}getStatusLabel(a){return f.getStatusUI(a).label}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=R({type:o,selectors:[["app-admin-repairs-page"]],decls:46,vars:4,consts:[[1,"flex","flex-col","md:flex-row","justify-between","items-center","mb-6","gap-4"],[1,"text-2xl","font-bold","text-gray-800","dark:text-green-400"],[1,"flex","gap-4","w-full","md:w-auto"],[1,"relative","grow"],[1,"absolute","inset-y-0","left-0","pl-3","flex","items-center","text-gray-400"],[1,"fas","fa-search"],["type","text","placeholder","Buscar cliente, tel o c\xF3digo...",1,"input","input-bordered","pl-10","w-full","rounded-xl",3,"ngModelChange","ngModel"],[1,"select","select-bordered","text-gray-700","rounded-xl",3,"ngModelChange","ngModel"],["value","all"],["value","smartphone"],["value","pc"],["value","notebook"],["value","console"],["value","tablet"],["routerLink","/admin/repairs/new",1,"btn","btn-primary","rounded-xl"],[1,"fas","fa-plus"],[1,"alert","alert-error","mb-6","rounded-2xl","shadow-lg","border-none","text-white","font-medium"],[1,"bg-white","rounded-2xl","shadow-xl","border","border-gray-100","overflow-hidden","text-gray-800"],[1,"overflow-x-auto"],[1,"table","w-full"],[1,"text-gray-400","bg-gray-50/50","uppercase","text-[10px]","tracking-widest","font-black"],[1,"py-5"],[1,"text-right"],[1,"divide-y","divide-gray-50"],[1,"fas","fa-exclamation-triangle"],[1,"btn","btn-sm","btn-ghost","border-white/20","hover:bg-white/10","uppercase","text-[10px]",3,"click"],["colspan","6",1,"text-center","py-12"],[1,"loading","loading-spinner","loading-lg","text-primary"],[1,"mt-2","text-gray-500","text-sm","italic"],["colspan","6",1,"text-center","py-20"],[1,"text-gray-200","mb-4"],[1,"fas","fa-toolbox","text-6xl"],[1,"text-gray-400","font-medium","italic"],[1,"hover:bg-primary/2","transition-colors","group"],[1,"py-4"],[1,"font-bold","text-gray-700"],[1,"badge","badge-xs","text-[9px]","font-black","tracking-tighter","uppercase","p-2","mt-1",3,"ngClass"],[1,"font-black","text-primary","tracking-tight","leading-tight"],[1,"text-[10px]","text-gray-500","font-medium","mb-1"],[1,"fas","fa-phone-alt","mr-1","text-gray-300"],[1,"badge","badge-ghost","badge-sm","text-[9px]","font-mono","opacity-50","px-1","pt-0.5","rounded","uppercase"],[1,"font-bold","text-gray-600","text-sm"],[1,"badge","border-none","font-black","text-[10px]","py-3.5","px-4","tracking-tight","uppercase",3,"ngClass"],[1,"font-black","text-gray-800","tabular-nums"],[1,"flex","gap-1","justify-end","opacity-0","group-hover:opacity-100","transition-opacity"],["data-tip","Editar Detalle",1,"btn","btn-square","btn-sm","btn-ghost","hover:bg-primary/10","hover:text-primary","tooltip",3,"routerLink"],[1,"fas","fa-edit"],["data-tip","Borrar Registro",1,"btn","btn-square","btn-sm","btn-ghost","hover:bg-error/10","text-error","tooltip",3,"click"],[1,"fas","fa-trash"]],template:function(t,r){t&1&&(e(0,"div",0)(1,"h1",1),n(2,"Taller / Reparaciones"),i(),e(3,"div",2)(4,"div",3)(5,"span",4),l(6,"i",5),i(),e(7,"input",6),b("ngModelChange",function(c){return r.searchTerm.set(c)}),i()(),e(8,"select",7),b("ngModelChange",function(c){return r.filterType.set(c)}),e(9,"option",8),n(10,"Ver Todos"),i(),e(11,"option",9),n(12,"Celulares"),i(),e(13,"option",10),n(14,"PC / Desktop"),i(),e(15,"option",11),n(16,"Notebook / Netbook"),i(),e(17,"option",12),n(18,"Consolas"),i(),e(19,"option",13),n(20,"Tablets"),i()(),e(21,"a",14),l(22,"i",15),n(23," Nueva "),i()()(),y(24,K,6,1,"div",16),e(25,"div",17)(26,"div",18)(27,"table",19)(28,"thead")(29,"tr",20)(30,"th",21),n(31,"Ingreso / Garant\xEDa"),i(),e(32,"th"),n(33,"Cliente / C\xF3digo"),i(),e(34,"th"),n(35,"Dispositivo"),i(),e(36,"th"),n(37,"Estado de Reparaci\xF3n"),i(),e(38,"th"),n(39,"Costo Est."),i(),e(40,"th",22),n(41,"Acciones"),i()()(),e(42,"tbody",23),y(43,Q,5,0,"tr")(44,H,6,0,"tr")(45,X,2,0),i()()()()),t&2&&(s(7),m("ngModel",r.searchTerm()),s(),m("ngModel",r.filterType()),s(16),E(r.error()?24:-1),s(19),E(r.loading()?43:r.filteredRepairs().length===0?44:45))},dependencies:[k,P,O,Y,B,q,G,F,U,V,M,L],encapsulation:2})};export{z as AdminRepairsPage};
