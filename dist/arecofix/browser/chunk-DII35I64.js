import{a as I}from"./chunk-SFGK2H4E.js";import"./chunk-RLEXB5XQ.js";import"./chunk-UWELTD43.js";import"./chunk-KREPGFQR.js";import"./chunk-T7AXESXA.js";import{n as P,o as w,r as A}from"./chunk-IZ4CGVWK.js";import{$b as S,Ab as v,Fb as i,Gb as t,Hb as m,Lb as h,Qb as _,Ra as u,Wa as d,Wb as b,Y as p,Yb as o,Zb as l,_b as y,ib as f,nc as c,oa as s,oc as U,pc as C,vb as g,wb as E,zb as x}from"./chunk-IZKGPZFC.js";import"./chunk-VOSPIT4N.js";var M=(a,n)=>n.id;function N(a,n){a&1&&(i(0,"tr")(1,"td",6),o(2,"Cargando..."),t()())}function R(a,n){a&1&&(i(0,"tr")(1,"td",6),o(2,"No hay usuarios registrados."),t()())}function k(a,n){if(a&1&&(i(0,"tr")(1,"td")(2,"div",7)(3,"div",8)(4,"div",9),m(5,"img",10),t()(),i(6,"div")(7,"div",11),o(8),t(),i(9,"div",12),o(10),t()()()(),i(11,"td")(12,"div",13),o(13),c(14,"uppercase"),t()(),i(15,"td"),o(16),c(17,"date"),t(),m(18,"td"),t()),a&2){let e=n.$implicit;d(5),h("src",e.avatar_url||"https://ui-avatars.com/api/?name="+e.first_name+"+"+e.last_name,u),d(3),S("",e.first_name," ",e.last_name),d(2),l(e.email),d(2),b("badge-primary",e.role==="admin")("badge-secondary",e.role==="staff")("badge-ghost",e.role==="user"),d(),y(" ",U(14,12,e.role)," "),d(3),l(C(17,14,e.created_at,"short"))}}function F(a,n){if(a&1&&x(0,k,19,17,"tr",null,M),a&2){let e=_();v(e.users())}}var D=class a{auth=p(I);users=s([]);loading=s(!0);async ngOnInit(){await this.loadUsers()}async loadUsers(){this.loading.set(!0);let n=this.auth.getSupabaseClient(),{data:e,error:r}=await n.from("profiles").select("*").order("created_at",{ascending:!1});e&&this.users.set(e),this.loading.set(!1)}async toggleRole(n){let e=n.role==="admin"?"user":"admin",r=this.auth.getSupabaseClient(),{error:T}=await r.from("profiles").update({role:e}).eq("id",n.id);T||await this.loadUsers()}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=f({type:a,selectors:[["app-admin-users-page"]],decls:20,vars:1,consts:[[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800"],[1,"bg-white","rounded-lg","shadow","overflow-hidden","text-gray-800"],[1,"overflow-x-auto"],[1,"table","w-full"],[1,"text-gray-800"],["colspan","4",1,"text-center","py-4"],[1,"flex","items-center","gap-3"],[1,"avatar"],[1,"mask","mask-squircle","w-12","h-12"],["alt","Avatar",3,"src"],[1,"font-bold"],[1,"text-sm","opacity-50"],[1,"badge"]],template:function(e,r){e&1&&(i(0,"div",0)(1,"h1",1),o(2,"Usuarios"),t()(),i(3,"div",2)(4,"div",3)(5,"table",4)(6,"thead")(7,"tr",5)(8,"th"),o(9,"Usuario"),t(),i(10,"th"),o(11,"Rol"),t(),i(12,"th"),o(13,"Fecha Registro"),t(),i(14,"th"),o(15,"Acciones"),t()()(),i(16,"tbody"),g(17,N,3,0,"tr")(18,R,3,0,"tr")(19,F,2,0),t()()()()),e&2&&(d(17),E(r.loading()?17:r.users().length===0?18:19))},dependencies:[A,P,w],encapsulation:2})};export{D as AdminUsersPage};
