import{b as F,d as N,e as D,f as T,g as L,h as I,p as B,s as q}from"./chunk-ROKQGBVC.js";import{a as A}from"./chunk-MI7WHUK7.js";import"./chunk-XFT2X3PC.js";import{a as E,c as P,d as W}from"./chunk-CYIQDGHK.js";import"./chunk-BVKNO7TK.js";import"./chunk-RZVF5N6E.js";import"./chunk-T7AXESXA.js";import{p as x}from"./chunk-BKULT56L.js";import{Cb as w,Eb as v,La as r,Mb as o,Nb as M,Ob as S,Qb as m,Rb as s,Sb as g,Y as f,Za as C,jb as y,kb as c,oa as p,pb as b,qb as n,rb as i,sb as h}from"./chunk-YATSW66L.js";import{a as _}from"./chunk-VOSPIT4N.js";function R(l,d){if(l&1&&(n(0,"div",7),h(1,"i",22),n(2,"span"),o(3),i()()),l&2){let a=v();r(3),M(a.error())}}function O(l,d){l&1&&h(0,"span",21)}var k=class l{route=f(E);router=f(P);auth=f(A);id=null;form=p({first_name:"",last_name:"",email:"",phone:"",address:"",dni:""});loading=p(!0);saving=p(!1);error=p(null);async ngOnInit(){if(this.id=this.route.snapshot.paramMap.get("id"),this.id){let d=this.auth.getSupabaseClient(),{data:a,error:e}=await d.from("profiles").select("*").eq("id",this.id).single();a&&this.form.set({first_name:a.first_name||"",last_name:a.last_name||"",email:a.email||"",phone:a.phone||"",address:a.address||"",dni:a.dni||""})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let d=this.auth.getSupabaseClient(),a=_({},this.form());try{if(this.id){let{error:e}=await d.from("profiles").update(a).eq("id",this.id);if(e)throw e}else throw new Error("Creaci\xF3n de nuevos usuarios debe hacerse desde el registro.");this.router.navigate(["/admin/clients"])}catch(e){this.error.set(e.message)}finally{this.saving.set(!1)}}static \u0275fac=function(a){return new(a||l)};static \u0275cmp=C({type:l,selectors:[["app-admin-client-form-page"]],decls:41,vars:11,consts:[[1,"max-w-4xl","mx-auto","text-gray-800"],[1,"flex","items-center","gap-4","mb-6"],["routerLink","/admin/clients",1,"btn","btn-circle","btn-ghost"],[1,"fas","fa-arrow-left"],[1,"text-2xl","font-bold","text-gray-800"],[3,"ngSubmit"],[1,"bg-white","p-6","rounded-xl","shadow-sm","border","border-gray-100","mb-6"],[1,"alert","alert-error","mb-6"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"block","text-sm","font-medium","text-gray-700","mb-1.5"],["type","text","name","first_name","required","",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],["type","text","name","last_name","required","",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],[1,"mt-4"],["type","email","name","email",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel","disabled"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mt-4"],["type","text","name","phone",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],["type","text","name","dni",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],["type","text","name","address",1,"w-full","bg-white","text-gray-900","border","border-gray-300","rounded-lg","px-4","py-2","focus:outline-none","focus:ring-2","transition-all","duration-200","ease-in-out","shadow-sm","hover:border-gray-400",3,"ngModelChange","ngModel"],[1,"flex","justify-end","gap-4","mt-6"],["routerLink","/admin/clients",1,"btn","btn-ghost"],["type","submit",1,"btn","btn-primary","px-8",3,"disabled"],[1,"loading","loading-spinner","loading-xs","mr-2"],[1,"fas","fa-exclamation-circle"]],template:function(a,e){a&1&&(n(0,"div",0)(1,"div",1)(2,"a",2),h(3,"i",3),i(),n(4,"h1",4),o(5),i()(),n(6,"form",5),w("ngSubmit",function(){return e.save()}),n(7,"div",6),y(8,R,4,1,"div",7),n(9,"div",8)(10,"div")(11,"label",9),o(12,"Nombre"),i(),n(13,"input",10),g("ngModelChange",function(t){return s(e.form().first_name,t)||(e.form().first_name=t),t}),i()(),n(14,"div")(15,"label",9),o(16,"Apellido"),i(),n(17,"input",11),g("ngModelChange",function(t){return s(e.form().last_name,t)||(e.form().last_name=t),t}),i()()(),n(18,"div",12)(19,"label",9),o(20,"Email"),i(),n(21,"input",13),g("ngModelChange",function(t){return s(e.form().email,t)||(e.form().email=t),t}),i()(),n(22,"div",14)(23,"div")(24,"label",9),o(25,"Celular"),i(),n(26,"input",15),g("ngModelChange",function(t){return s(e.form().phone,t)||(e.form().phone=t),t}),i()(),n(27,"div")(28,"label",9),o(29,"DNI"),i(),n(30,"input",16),g("ngModelChange",function(t){return s(e.form().dni,t)||(e.form().dni=t),t}),i()()(),n(31,"div",12)(32,"label",9),o(33,"Direcci\xF3n"),i(),n(34,"input",17),g("ngModelChange",function(t){return s(e.form().address,t)||(e.form().address=t),t}),i()()(),n(35,"div",18)(36,"a",19),o(37,"Cancelar"),i(),n(38,"button",20),y(39,O,1,0,"span",21),o(40," Guardar "),i()()()()),a&2&&(r(5),S("",e.id?"Editar":"Nuevo"," Cliente"),r(3),c(e.error()?8:-1),r(5),m("ngModel",e.form().first_name),r(4),m("ngModel",e.form().last_name),r(4),m("ngModel",e.form().email),b("disabled",!!e.id),r(5),m("ngModel",e.form().phone),r(4),m("ngModel",e.form().dni),r(4),m("ngModel",e.form().address),r(4),b("disabled",e.saving()),r(),c(e.saving()?39:-1))},dependencies:[x,q,I,F,N,D,B,L,T,W],encapsulation:2})};export{k as AdminClientFormPage};
