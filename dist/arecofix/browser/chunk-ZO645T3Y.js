import{a as W,b as D,d as T,e as L,f as I,g as j,h as k,i as B,o as q,p as R,s as O}from"./chunk-JC43VCPH.js";import{a as N}from"./chunk-CPI2BPDE.js";import"./chunk-NR3BVOML.js";import{e as P,g as A,h as F}from"./chunk-Z245BGFQ.js";import"./chunk-IIPDUD2U.js";import"./chunk-T7AXESXA.js";import{r as E}from"./chunk-L5RZOCV7.js";import{Bb as y,Cb as t,Db as n,Eb as c,Kb as h,Ob as w,Qb as m,Wa as l,Y as x,Yb as s,Zb as M,_b as V,ac as u,ba as g,bc as f,ca as p,cc as _,ib as S,oa as v,vb as b,wb as C}from"./chunk-SISNN44B.js";import"./chunk-VOSPIT4N.js";function z(a,d){a&1&&(t(0,"div",7),c(1,"span",9),n())}function H(a,d){if(a&1&&(t(0,"div",25),c(1,"i",29),t(2,"span"),s(3),n()()),a&2){let e=m(2);l(3),M(e.error())}}function J(a,d){a&1&&c(0,"span",28)}function K(a,d){if(a&1){let e=h();t(0,"form",10),w("ngSubmit",function(){g(e);let i=m();return p(i.save())}),t(1,"div",11)(2,"label",12)(3,"span",13),s(4,"Nombre del Servicio"),n()(),t(5,"label",14),c(6,"i",15),t(7,"input",16),_("ngModelChange",function(i){g(e);let r=m();return f(r.form().name,i)||(r.form().name=i),p(i)}),n()()(),t(8,"div",11)(9,"label",12)(10,"span",13),s(11,"Descripci\xF3n"),n()(),t(12,"textarea",17),_("ngModelChange",function(i){g(e);let r=m();return f(r.form().description,i)||(r.form().description=i),p(i)}),n()(),t(13,"div",18)(14,"div",11)(15,"label",12)(16,"span",13),s(17,"Precio"),n()(),t(18,"label",14),c(19,"i",19),t(20,"input",20),_("ngModelChange",function(i){g(e);let r=m();return f(r.form().price,i)||(r.form().price=i),p(i)}),n()()(),t(21,"div",11)(22,"label",12)(23,"span",13),s(24,"Duraci\xF3n (minutos)"),n()(),t(25,"label",14),c(26,"i",21),t(27,"input",22),_("ngModelChange",function(i){g(e);let r=m();return f(r.form().duration_minutes,i)||(r.form().duration_minutes=i),p(i)}),n()()()(),t(28,"div",11)(29,"label",23)(30,"span",13),s(31,"Activo"),n(),t(32,"input",24),_("ngModelChange",function(i){g(e);let r=m();return f(r.form().is_active,i)||(r.form().is_active=i),p(i)}),n()()(),b(33,H,4,1,"div",25),t(34,"div",26)(35,"a",3),s(36,"Cancelar"),n(),t(37,"button",27),b(38,J,1,0,"span",28),s(39," Guardar "),n()()()}if(a&2){let e=m();l(7),u("ngModel",e.form().name),l(5),u("ngModel",e.form().description),l(8),u("ngModel",e.form().price),l(7),u("ngModel",e.form().duration_minutes),l(5),u("ngModel",e.form().is_active),l(),C(e.error()?33:-1),l(4),y("disabled",e.saving()||!e.form().name),l(),C(e.saving()?38:-1)}}var G=class a{route=x(P);router=x(A);auth=x(N);id=null;form=v({name:"",description:"",price:0,duration_minutes:60,is_active:!0});loading=v(!0);saving=v(!1);error=v(null);async ngOnInit(){if(this.id=this.route.snapshot.paramMap.get("id"),this.id){let d=this.auth.getSupabaseClient(),{data:e,error:o}=await d.from("services").select("*").eq("id",this.id).single();e&&this.form.set({name:e.name,description:e.description||"",price:e.price||0,duration_minutes:e.duration_minutes||60,is_active:e.is_active})}this.loading.set(!1)}async save(){this.saving.set(!0),this.error.set(null);let d=this.auth.getSupabaseClient(),e=this.form(),o={name:e.name,description:e.description,price:Number(e.price),duration_minutes:Number(e.duration_minutes),is_active:e.is_active};try{if(this.id){let{error:i}=await d.from("services").update(o).eq("id",this.id);if(i)throw i}else{let{error:i}=await d.from("services").insert(o);if(i)throw i}this.router.navigate(["/admin/services"])}catch(i){console.error("Error saving service:",i),this.error.set(i.message||"Error al guardar el servicio. Verifica los datos.")}finally{this.saving.set(!1)}}static \u0275fac=function(e){return new(e||a)};static \u0275cmp=S({type:a,selectors:[["app-admin-service-form-page"]],decls:11,vars:2,consts:[[1,"max-w-2xl","mx-auto"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-green-600"],["routerLink","/admin/services",1,"btn","btn-ghost"],[1,"fas","fa-arrow-left","mr-2"],[1,"card","bg-base-100","shadow-lg"],[1,"card-body","p-6"],[1,"flex","justify-center","py-12"],[1,"space-y-6"],[1,"loading","loading-spinner","loading-lg","text-primary"],[1,"space-y-6",3,"ngSubmit"],[1,"form-control"],[1,"label"],[1,"label-text","font-medium"],[1,"input","input-bordered","flex","items-center","gap-2"],[1,"fas","fa-tag","text-gray-400"],["type","text","name","name","required","",1,"grow",3,"ngModelChange","ngModel"],["name","description","placeholder","Describe los detalles del servicio...",1,"textarea","textarea-bordered","h-32","leading-relaxed",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6"],[1,"fas","fa-dollar-sign","text-gray-400"],["type","number","name","price","min","0","step","0.01",1,"grow",3,"ngModelChange","ngModel"],[1,"fas","fa-clock","text-gray-400"],["type","number","name","duration_minutes","min","0",1,"grow",3,"ngModelChange","ngModel"],[1,"label","cursor-pointer","justify-start","gap-4","p-0"],["type","checkbox","name","is_active",1,"toggle","toggle-primary",3,"ngModelChange","ngModel"],[1,"alert","alert-error","mb-6","shadow-sm"],[1,"flex","justify-end","gap-4","pt-6","border-t","border-base-200"],["type","submit",1,"btn","btn-primary","px-8",3,"disabled"],[1,"loading","loading-spinner","loading-xs"],[1,"fas","fa-exclamation-circle"]],template:function(e,o){e&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),s(3),n(),t(4,"a",3),c(5,"i",4),s(6," Volver "),n()(),t(7,"div",5)(8,"div",6),b(9,z,2,0,"div",7)(10,K,40,8,"form",8),n()()()),e&2&&(l(3),V("",o.id?"Editar":"Nuevo"," Servicio"),l(6),C(o.loading()?9:10))},dependencies:[E,O,k,D,B,W,T,L,R,q,j,I,F],encapsulation:2})};export{G as AdminServiceFormPage};
