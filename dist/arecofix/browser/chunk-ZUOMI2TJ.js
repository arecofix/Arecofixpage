import{a as G}from"./chunk-IIAGRJKX.js";import"./chunk-GBGIQ7VE.js";import{b as F,c as y,d as k,e as A,h as I,k as D,l as N,s as T,u as V}from"./chunk-63CMMPDH.js";import"./chunk-IP3FEPB3.js";import"./chunk-SFLZ64DJ.js";import"./chunk-FEKWCP2W.js";import{l as C,n as S,o as P}from"./chunk-YNFFGNY6.js";import"./chunk-Q44XB7TV.js";import{$ as h,Ab as t,Bb as e,Cb as l,Ec as E,Gb as x,Kb as f,Mb as c,Pa as _,Ua as d,Vb as o,W as s,Wb as v,aa as b,gb as w,tb as u,ub as g,zb as p}from"./chunk-DX2LKEMG.js";import"./chunk-C6Q5SG76.js";function R(n,i){n&1&&(l(0,"div",9),o(1," Guardando... "))}function q(n,i){n&1&&(l(0,"i",10),o(1," Guardar "))}function O(n,i){n&1&&(t(0,"div",7),l(1,"div",11),e())}function B(n,i){if(n&1){let r=x();t(0,"div",29),l(1,"img",31),t(2,"div",32)(3,"button",33),f("click",function(){h(r);let m=c(2);return m.imagePreview=null,b(m.form.patchValue({image:""}))}),l(4,"i",34),e()()()}if(n&2){let r=c(2);d(),p("src",r.imagePreview,_)}}function L(n,i){if(n&1){let r=x();t(0,"div",30)(1,"div",35),l(2,"i",36),e(),t(3,"div",37)(4,"label",38)(5,"span"),o(6,"Subir un archivo"),e(),t(7,"input",39),f("change",function(m){h(r);let j=c(2);return b(j.onFileSelected(m))}),e()(),t(8,"p",40),o(9,"o arrastrar y soltar"),e()(),t(10,"p",41),o(11,"PNG, JPG, GIF hasta 5MB"),e()()}}function z(n,i){if(n&1&&(t(0,"form",8)(1,"div",12)(2,"div",13)(3,"h3",14),o(4,"Contenido"),e(),t(5,"div",15)(6,"div")(7,"label",16),o(8,"T\xEDtulo"),e(),l(9,"input",17),e(),t(10,"div")(11,"label",18),o(12,"Slug (URL)"),e(),t(13,"div",19)(14,"span",20),o(15," /posts/ "),e(),l(16,"input",21),e()(),t(17,"div")(18,"label",22),o(19,"Cuerpo"),e(),l(20,"textarea",23),e()()(),t(21,"div",13)(22,"h3",14),o(23,"SEO (Optimizaci\xF3n para buscadores)"),e(),t(24,"div",15)(25,"div")(26,"label",24),o(27,"Meta T\xEDtulo"),e(),l(28,"input",25),t(29,"p",26),o(30,"T\xEDtulo que aparecer\xE1 en Google."),e()(),t(31,"div")(32,"label",27),o(33,"Meta Descripci\xF3n"),e(),l(34,"textarea",28),t(35,"p",26),o(36,"Breve descripci\xF3n para los resultados de b\xFAsqueda."),e()()()()(),t(37,"div",0)(38,"div",13)(39,"h3",14),o(40,"Imagen Destacada"),e(),t(41,"div",15),u(42,B,5,1,"div",29)(43,L,12,0,"div",30),e()()()()),n&2){let r=c();p("formGroup",r.form),d(42),g(r.imagePreview?42:43)}}var M=class n{fb=s(T);postService=s(G);route=s(C);router=s(S);cdr=s(E);form;loading=!1;submitting=!1;isEdit=!1;postId=null;imagePreview=null;constructor(){this.form=this.fb.group({title:["",[y.required]],slug:["",[y.required]],content:[""],published:[!1],meta_title:[""],meta_description:[""],image:[""]})}async ngOnInit(){this.postId=this.route.snapshot.paramMap.get("id"),this.postId&&(this.isEdit=!0,await this.loadPost(this.postId)),this.form.get("title")?.valueChanges.subscribe(i=>{!this.isEdit&&i&&!this.form.get("slug")?.dirty&&this.form.patchValue({slug:this.postService.slugify(i)})})}async loadPost(i){try{this.loading=!0;let r=await this.postService.getPost(i);this.form.patchValue(r),this.imagePreview=r.image||null}catch(r){console.error("Error loading post",r),alert("Error al cargar la entrada"),this.router.navigate(["/admin/posts"])}finally{this.loading=!1,this.cdr.markForCheck()}}async onFileSelected(i){let r=i.target.files?.[0];if(r)try{this.loading=!0;let a=await this.postService.uploadImage(r);this.form.patchValue({image:a}),this.imagePreview=a}catch(a){console.error("Error uploading image",a),alert("Error al subir imagen")}finally{this.loading=!1,this.cdr.markForCheck()}}async onSubmit(){if(!this.form.invalid)try{this.submitting=!0;let i=this.form.value;this.isEdit&&this.postId?await this.postService.updatePost(this.postId,i):await this.postService.createPost(i),this.router.navigate(["/admin/posts"])}catch(i){console.error("Error saving post",i),alert("Error al guardar: "+(i.message||i))}finally{this.submitting=!1,this.cdr.markForCheck()}}static \u0275fac=function(r){return new(r||n)};static \u0275cmp=w({type:n,selectors:[["app-admin-post-form-page"]],decls:15,vars:5,consts:[[1,"space-y-6"],[1,"flex","flex-col","sm:flex-row","justify-between","items-start","sm:items-center","gap-4"],[1,"text-2xl","font-bold","text-gray-900","dark:text-green-400"],[1,"text-gray-500","mt-1"],[1,"flex","gap-3"],["routerLink","/admin/posts",1,"px-4","py-2","border","border-gray-300","text-gray-700","bg-white","hover:bg-gray-50","font-medium","rounded-lg","transition-colors"],[1,"px-4","py-2","bg-indigo-600","hover:bg-indigo-700","text-white","font-medium","rounded-lg","transition-colors","shadow-sm","disabled:opacity-50","disabled:cursor-not-allowed","flex","items-center",3,"click","disabled"],[1,"flex","justify-center","p-12"],[1,"grid","grid-cols-1","lg:grid-cols-3","gap-6",3,"formGroup"],[1,"animate-spin","rounded-full","h-4","w-4","border-b-2","border-white","mr-2"],[1,"fas","fa-save","mr-2"],[1,"animate-spin","rounded-full","h-10","w-10","border-b-2","border-indigo-600"],[1,"lg:col-span-2","space-y-6"],[1,"bg-white","rounded-xl","shadow-sm","border","border-gray-200","p-6"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"space-y-4"],["for","title",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","title","formControlName","title","placeholder","Ej: Servicio t\xE9cnico de celulares",1,"w-full","rounded-lg","border-gray-300","bg-white","text-gray-900","focus:border-indigo-500","focus:ring-indigo-500","shadow-sm","transition-colors"],["for","slug",1,"block","text-sm","font-medium","text-gray-700","mb-1"],[1,"flex","rounded-md","shadow-sm"],[1,"inline-flex","items-center","px-3","rounded-l-md","border","border-r-0","border-gray-300","bg-gray-50","text-gray-500","text-sm"],["type","text","id","slug","formControlName","slug","placeholder","servicio-tecnico",1,"flex-1","block","w-full","rounded-none","rounded-r-md","border-gray-300","bg-white","text-gray-900","focus:border-indigo-500","focus:ring-indigo-500","sm:text-sm"],["for","content",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","content","formControlName","content","rows","15","placeholder","Escribe el contenido de tu entrada aqu\xED...",1,"w-full","rounded-lg","border-gray-300","bg-white","text-gray-900","focus:border-indigo-500","focus:ring-indigo-500","shadow-sm","font-mono","text-sm"],["for","meta_title",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["type","text","id","meta_title","formControlName","meta_title",1,"w-full","rounded-lg","border-gray-300","bg-white","text-gray-900","focus:border-indigo-500","focus:ring-indigo-500","shadow-sm"],[1,"mt-1","text-xs","text-gray-500"],["for","meta_description",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","meta_description","formControlName","meta_description","rows","3",1,"w-full","rounded-lg","border-gray-300","bg-white","text-gray-900","focus:border-indigo-500","focus:ring-indigo-500","shadow-sm"],[1,"relative","group","rounded-lg","overflow-hidden","border","border-gray-200","aspect-video","bg-gray-100"],[1,"border-2","border-dashed","border-gray-300","rounded-lg","p-6","text-center","hover:border-indigo-500","transition-colors","bg-gray-50"],["alt","Preview",1,"w-full","h-full","object-cover",3,"src"],[1,"absolute","inset-0","bg-black/50","flex","items-center","justify-center","opacity-0","group-hover:opacity-100","transition-opacity"],["type","button",1,"p-2","bg-red-600","text-white","rounded-full","hover:bg-red-700","transition-colors",3,"click"],[1,"fas","fa-trash"],[1,"mx-auto","h-12","w-12","text-gray-400","mb-3"],[1,"fas","fa-image","text-3xl"],[1,"text-sm","text-gray-600"],["for","file-upload",1,"relative","cursor-pointer","bg-white","rounded-md","font-medium","text-indigo-600","hover:text-indigo-500","focus-within:outline-none","focus-within:ring-2","focus-within:ring-offset-2","focus-within:ring-indigo-500"],["id","file-upload","name","file-upload","type","file","accept","image/*",1,"sr-only",3,"change"],[1,"pl-1"],[1,"text-xs","text-gray-500","mt-2"]],template:function(r,a){r&1&&(t(0,"div",0)(1,"div",1)(2,"div")(3,"h1",2),o(4),e(),t(5,"p",3),o(6),e()(),t(7,"div",4)(8,"a",5),o(9," Cancelar "),e(),t(10,"button",6),f("click",function(){return a.onSubmit()}),u(11,R,2,0)(12,q,2,0),e()()(),u(13,O,2,0,"div",7)(14,z,44,2,"form",8),e()),r&2&&(d(4),v(a.isEdit?"Editar Entrada":"Nueva Entrada"),d(2),v(a.isEdit?"Modifica los detalles de la entrada":"Crea una nueva entrada para el blog"),d(4),p("disabled",a.form.invalid||a.submitting),d(),g(a.submitting?11:12),d(2),g(a.loading?13:14))},dependencies:[V,I,F,k,A,N,D,P],encapsulation:2,changeDetection:0})};export{M as AdminPostFormPage};
