import{a as j,b as q,d as X,e as U,f as z,g as G,h as H,i as Y,l as J,m as Q,n as Z,o as K,p as $,r as ee}from"./chunk-GSH74JW6.js";import{a as B}from"./chunk-ZT4MGTUK.js";import{a as N,c as L,d as O}from"./chunk-VKJMBSB6.js";import"./chunk-7QORBSNT.js";import"./chunk-QGSRP5SS.js";import{k as T,m as D}from"./chunk-KW2FFXRI.js";import{$ as s,Aa as R,Bb as n,Cb as x,Da as l,Db as f,Fb as p,Gb as g,Hb as u,Qa as W,Sb as V,Ub as I,V as C,_ as m,ab as y,bb as w,gb as S,hb as e,ib as t,jb as h,la as b,nb as M,rb as v,tb as d}from"./chunk-VQO264VU.js";import{a as E,b as F}from"./chunk-VOSPIT4N.js";function ie(c,_){c&1&&(e(0,"div",6),h(1,"span",46),t())}function ne(c,_){if(c&1&&(e(0,"div",81),h(1,"i",89),e(2,"span"),n(3),t()()),c&2){let i=d(2);l(3),x(i.error())}}function ae(c,_){if(c&1){let i=M();e(0,"button",90),v("click",function(){m(i);let a=d(2);return s(a.shareWhatsApp())}),h(1,"i",91),n(2," Compartir por WhatsApp "),t()}}function re(c,_){c&1&&h(0,"span",88)}function oe(c,_){if(c&1){let i=M();e(0,"form",47),v("ngSubmit",function(){m(i);let a=d();return s(a.save())}),e(1,"div",48)(2,"div",49)(3,"label",50)(4,"span",51),n(5,"Nombre del Cliente"),t()(),e(6,"input",52),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().customer_name,a)||(o.form().customer_name=a),s(a)}),t()(),e(7,"div",49)(8,"label",50)(9,"span",51),n(10,"Tel\xE9fono"),t()(),e(11,"input",53),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().customer_phone,a)||(o.form().customer_phone=a),s(a)}),t()()(),e(12,"div",54)(13,"label",50)(14,"span",51),n(15,"Modelo del Dispositivo"),t()(),e(16,"input",55),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().device_model,a)||(o.form().device_model=a),s(a)}),t()(),e(17,"div",54)(18,"label",50)(19,"span",51),n(20,"Descripci\xF3n del Problema"),t()(),e(21,"textarea",56),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().issue_description,a)||(o.form().issue_description=a),s(a)}),t()(),e(22,"div",57),n(23,"Detalles del Equipo"),t(),e(24,"div",54)(25,"label",50)(26,"span",51),n(27,"Accesorios Recibidos"),t()(),e(28,"div",58)(29,"label",59)(30,"span",60),n(31,"Cargador"),t(),e(32,"input",61),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().checklist.charger,a)||(o.form().checklist.charger=a),s(a)}),t()(),e(33,"label",59)(34,"span",60),n(35,"Bater\xEDa"),t(),e(36,"input",62),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().checklist.battery,a)||(o.form().checklist.battery=a),s(a)}),t()(),e(37,"label",59)(38,"span",60),n(39,"Chip"),t(),e(40,"input",63),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().checklist.chip,a)||(o.form().checklist.chip=a),s(a)}),t()(),e(41,"label",59)(42,"span",60),n(43,"Tarjeta SD"),t(),e(44,"input",64),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().checklist.sd,a)||(o.form().checklist.sd=a),s(a)}),t()(),e(45,"label",59)(46,"span",60),n(47,"Funda"),t(),e(48,"input",65),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().checklist.case,a)||(o.form().checklist.case=a),s(a)}),t()()()(),e(49,"div",48)(50,"div",49)(51,"label",50)(52,"span",51),n(53,"PIN / Contrase\xF1a"),t()(),e(54,"input",66),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().security_pin,a)||(o.form().security_pin=a),s(a)}),t()(),e(55,"div",49)(56,"label",50)(57,"span",51),n(58,"Patr\xF3n de Desbloqueo"),t()(),e(59,"input",67),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().security_pattern,a)||(o.form().security_pattern=a),s(a)}),t()()(),e(60,"div",57),n(61,"Estado y Costos"),t(),e(62,"div",68)(63,"div",49)(64,"label",50)(65,"span",51),n(66,"Estado"),t()(),e(67,"select",69),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().status,a)||(o.form().status=a),s(a)}),e(68,"option",70),n(69,"Pendiente"),t(),e(70,"option",71),n(71,"En Progreso"),t(),e(72,"option",72),n(73,"Completado"),t(),e(74,"option",73),n(75,"Entregado"),t(),e(76,"option",74),n(77,"Cancelado"),t()()(),e(78,"div",49)(79,"label",50)(80,"span",51),n(81,"Costo Estimado"),t()(),e(82,"label",75)(83,"span"),n(84,"$"),t(),e(85,"input",76),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().estimated_cost,a)||(o.form().estimated_cost=a),s(a)}),t()()(),e(86,"div",49)(87,"label",50)(88,"span",51),n(89,"Se\xF1a / Adelanto"),t()(),e(90,"label",75)(91,"span"),n(92,"$"),t(),e(93,"input",77),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().deposit_amount,a)||(o.form().deposit_amount=a),s(a)}),t()()(),e(94,"div",49)(95,"label",50)(96,"span",51),n(97,"Costo Final"),t()(),e(98,"label",75)(99,"span"),n(100,"$"),t(),e(101,"input",78),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().final_cost,a)||(o.form().final_cost=a),s(a)}),t()()()(),e(102,"div",79)(103,"label",50)(104,"span",51),n(105,"Notas del T\xE9cnico (Interno)"),t()(),e(106,"textarea",80),u("ngModelChange",function(a){m(i);let o=d();return g(o.form().technician_notes,a)||(o.form().technician_notes=a),s(a)}),t()(),y(107,ne,4,1,"div",81),e(108,"div",82),y(109,ae,3,0,"button",83),e(110,"button",84),v("click",function(){m(i);let a=d();return s(a.printOrder())}),h(111,"i",85),n(112," Imprimir Orden "),t(),e(113,"a",86),n(114,"Cancelar"),t(),e(115,"button",87),y(116,re,1,0,"span",88),n(117," Guardar Reparaci\xF3n "),t()()()}if(c&2){let i=d();l(6),p("ngModel",i.form().customer_name),l(5),p("ngModel",i.form().customer_phone),l(5),p("ngModel",i.form().device_model),l(5),p("ngModel",i.form().issue_description),l(11),p("ngModel",i.form().checklist.charger),l(4),p("ngModel",i.form().checklist.battery),l(4),p("ngModel",i.form().checklist.chip),l(4),p("ngModel",i.form().checklist.sd),l(4),p("ngModel",i.form().checklist.case),l(6),p("ngModel",i.form().security_pin),l(5),p("ngModel",i.form().security_pattern),l(8),p("ngModel",i.form().status),l(18),p("ngModel",i.form().estimated_cost),l(8),p("ngModel",i.form().deposit_amount),l(8),p("ngModel",i.form().final_cost),l(5),p("ngModel",i.form().technician_notes),l(),w(i.error()?107:-1),l(2),w(i.id&&i.form().tracking_code?109:-1),l(),S("disabled",i.saving()),l(5),S("disabled",i.saving()||!i.form().customer_name||!i.form().device_model),l(),w(i.saving()?116:-1)}}function le(c,_){if(c&1&&h(0,"img",12),c&2){let i=d();S("src",i.company().logo_url,R)}}var te=class c{route=C(N);router=C(L);auth=C(B);id=null;date=new Date;form=b({customer_name:"",customer_phone:"",device_model:"",issue_description:"",status:"pending",estimated_cost:0,final_cost:0,technician_notes:"",checklist:{charger:!1,battery:!1,chip:!1,sd:!1,case:!1},security_pin:"",security_pattern:"",deposit_amount:0,tracking_code:""},{});loading=b(!0,{});saving=b(!1,{});error=b(null,{});company=b(null,{});async ngOnInit(){this.id=this.route.snapshot.paramMap.get("id"),await this.loadCompanySettings(),this.id&&await this.loadRepair(),this.loading.set(!1)}async loadCompanySettings(){let _=this.auth.getSupabaseClient(),{data:i}=await _.from("company_settings").select("*").maybeSingle();i&&this.company.set(i)}async loadRepair(){let _=this.auth.getSupabaseClient(),{data:i,error:r}=await _.from("repairs").select("*").eq("id",this.id).single();i&&this.form.set({customer_name:i.customer_name,customer_phone:i.customer_phone||"",device_model:i.device_model,issue_description:i.issue_description||"",status:i.status,estimated_cost:i.estimated_cost||0,final_cost:i.final_cost||0,technician_notes:i.technician_notes||"",checklist:i.checklist||{charger:!1,battery:!1,chip:!1,sd:!1,case:!1},security_pin:i.security_pin||"",security_pattern:i.security_pattern||"",deposit_amount:i.deposit_amount||0,tracking_code:i.tracking_code||""})}generateTrackingCode(){return Math.random().toString(36).substring(2,15)+Math.random().toString(36).substring(2,15)}async save(){this.saving.set(!0),this.error.set(null);let _=this.auth.getSupabaseClient(),i=E({},this.form());i.tracking_code||(i.tracking_code=this.generateTrackingCode(),this.form.update(r=>F(E({},r),{tracking_code:i.tracking_code}))),["completed","delivered"].includes(i.status)&&(i.completed_at=new Date().toISOString());try{if(this.id){let{error:r}=await _.from("repairs").update(i).eq("id",this.id);if(r)throw r}else{let{error:r}=await _.from("repairs").insert(i);if(r)throw r}this.router.navigate(["/admin/repairs"])}catch(r){this.error.set(r.message)}finally{this.saving.set(!1)}}printOrder(){document.body.classList.add("printing-repair-order"),setTimeout(()=>{window.print(),document.body.classList.remove("printing-repair-order")},100)}shareWhatsApp(){if(!this.form().tracking_code)return;let _=this.form().customer_name,i=this.form().device_model,r=`${window.location.origin}/#/tracking/${this.form().tracking_code}`,a=`Hola ${_}, tu ${i} est\xE1 en reparaci\xF3n. Pod\xE9s seguir el estado en tiempo real aqu\xED: ${r}`,o=`https://wa.me/${this.form().customer_phone}?text=${encodeURIComponent(a)}`;window.open(o,"_blank")}static \u0275fac=function(i){return new(i||c)};static \u0275cmp=W({type:c,selectors:[["app-admin-repair-form-page"]],decls:147,vars:25,consts:[[1,"max-w-3xl","mx-auto","no-print"],[1,"flex","justify-between","items-center","mb-6"],[1,"text-2xl","font-bold","text-gray-800"],["routerLink","/admin/repairs",1,"btn","btn-ghost"],[1,"fas","fa-arrow-left","mr-2"],[1,"bg-white","rounded-lg","shadow","p-6","text-gray-800"],[1,"flex","justify-center","py-8"],[1,"hidden","print:block","print-container","font-sans","text-sm"],[1,"flex","justify-between","items-start","mb-2","border-b","pb-1"],[1,"text-xl","font-bold","uppercase","underline","mb-1"],[1,"text-xs"],[1,"text-right"],["alt","Logo",1,"h-10","mb-1","object-contain","ml-auto",3,"src"],[1,"font-bold","text-lg","text-green-700","uppercase"],[1,"text-xs","text-gray-600"],[1,"mb-2"],[1,"flex","mb-1"],[1,"w-32","font-bold","text-xs"],[1,"border-b","border-gray-400","flex-1","text-xs"],[1,"mb-2","text-center"],[1,"font-bold","underline","mb-1","text-[10px]"],[1,"flex","justify-center","gap-3","text-[10px]"],[1,"flex","items-center"],[1,"mr-1"],[1,"w-3","h-3","border","border-black","flex","items-center","justify-center"],[1,"flex","items-center","gap-4","mb-1"],[1,"font-bold","text-xs"],[1,"grid","grid-cols-3","gap-1","w-12"],[1,"w-2","h-2","rounded-full","border","border-black"],[1,"text-xs","ml-2"],[1,"flex","items-end"],[1,"font-bold","text-xs","mr-2"],[1,"mb-2","text-xs"],[1,"w-40","font-bold"],[1,"border-b","border-gray-400","flex-1"],[1,"mb-2","text-[7px]","leading-tight","text-justify"],[1,"font-bold","underline","text-center","mb-1"],[1,"flex","justify-between","items-end","mt-4","text-[9px]"],[1,"w-2/3","pr-2"],[1,"flex","items-end","gap-2"],[1,"text-center","flex-1"],[1,"border-t","border-black","pt-1"],[1,"flex-1"],[1,"flex","justify-between","mb-1"],[1,"flex","justify-between"],[1,"text-center","w-1/3"],[1,"loading","loading-spinner","loading-lg"],[3,"ngSubmit"],[1,"grid","grid-cols-1","md:grid-cols-2","gap-6","mb-6"],[1,"form-control"],[1,"label"],[1,"label-text","font-medium"],["type","text","name","customer_name","required","",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],["type","tel","name","customer_phone",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],[1,"form-control","mb-4"],["type","text","name","device_model","required","","placeholder","Ej: iPhone 11, Samsung A52, Laptop HP...",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],["name","issue_description","placeholder","Describe la falla reportada por el cliente...",1,"textarea","textarea-bordered","h-24","bg-white","text-gray-800",3,"ngModelChange","ngModel"],[1,"divider"],[1,"flex","flex-wrap","gap-4"],[1,"cursor-pointer","label"],[1,"label-text","mr-2"],["type","checkbox","name","check_charger",1,"checkbox",3,"ngModelChange","ngModel"],["type","checkbox","name","check_battery",1,"checkbox",3,"ngModelChange","ngModel"],["type","checkbox","name","check_chip",1,"checkbox",3,"ngModelChange","ngModel"],["type","checkbox","name","check_sd",1,"checkbox",3,"ngModelChange","ngModel"],["type","checkbox","name","check_case",1,"checkbox",3,"ngModelChange","ngModel"],["type","text","name","security_pin","placeholder","1234",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],["type","text","name","security_pattern","placeholder","Descripci\xF3n del patr\xF3n (ej: Z, L, etc)",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-6","mb-6"],["name","status",1,"select","select-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],["value","pending"],["value","in_progress"],["value","completed"],["value","delivered"],["value","cancelled"],[1,"input-group"],["type","number","name","estimated_cost","min","0",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],["type","number","name","deposit_amount","min","0",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],["type","number","name","final_cost","min","0",1,"input","input-bordered","w-full","bg-white","text-gray-800",3,"ngModelChange","ngModel"],[1,"form-control","mb-6"],["name","technician_notes","placeholder","Detalles de la reparaci\xF3n realizada...",1,"textarea","textarea-bordered","h-24","bg-white","text-gray-800",3,"ngModelChange","ngModel"],[1,"alert","alert-error","mb-6"],[1,"flex","flex-col","sm:flex-row","justify-end","gap-4"],["type","button",1,"btn","bg-green-600","hover:bg-green-700","text-white","border-none","w-full","sm:w-auto"],["type","button",1,"btn","btn-outline","w-full","sm:w-auto",3,"click","disabled"],[1,"fas","fa-print","mr-2"],["routerLink","/admin/repairs",1,"btn","btn-ghost","w-full","sm:w-auto"],["type","submit",1,"btn","btn-primary","w-full","sm:w-auto",3,"disabled"],[1,"loading","loading-spinner","loading-xs"],[1,"fas","fa-exclamation-circle"],["type","button",1,"btn","bg-green-600","hover:bg-green-700","text-white","border-none","w-full","sm:w-auto",3,"click"],[1,"fab","fa-whatsapp","mr-2"]],template:function(i,r){if(i&1&&(e(0,"div",0)(1,"div",1)(2,"h1",2),n(3),t(),e(4,"a",3),h(5,"i",4),n(6," Volver "),t()(),e(7,"div",5),y(8,ie,2,0,"div",6)(9,oe,118,21,"form"),t()(),e(10,"div",7)(11,"div",8)(12,"div")(13,"h1",9),n(14,"Solicitud de Reparaci\xF3n"),t(),e(15,"div",10)(16,"p")(17,"strong"),n(18,"Fecha:"),t(),n(19),V(20,"date"),t(),e(21,"p"),n(22),t(),e(23,"p"),n(24),t()()(),e(25,"div",11),y(26,le,1,1,"img",12),e(27,"h2",13),n(28),t(),e(29,"div",14)(30,"p"),n(31),t()()()(),e(32,"div",15)(33,"div",16)(34,"span",17),n(35,"NOMBRE Y APELLIDO:"),t(),e(36,"span",18),n(37),t()(),e(38,"div",16)(39,"span",17),n(40,"TEL\xC9FONO:"),t(),e(41,"span",18),n(42),t()()(),e(43,"div",15)(44,"div",16)(45,"span",17),n(46,"MARCA Y MODELO:"),t(),e(47,"span",18),n(48),t()(),e(49,"div",16)(50,"span",17),n(51,"OBSERVACIONES:"),t(),e(52,"span",18),n(53),t()()(),e(54,"div",19)(55,"h3",20),n(56,"ACCESORIOS"),t(),e(57,"div",21)(58,"div",22)(59,"span",23),n(60,"CARGADOR"),t(),e(61,"div",24),n(62),t()(),e(63,"div",22)(64,"span",23),n(65,"BATERIA"),t(),e(66,"div",24),n(67),t()(),e(68,"div",22)(69,"span",23),n(70,"CHIP"),t(),e(71,"div",24),n(72),t()(),e(73,"div",22)(74,"span",23),n(75,"TARJETA SD"),t(),e(76,"div",24),n(77),t()(),e(78,"div",22)(79,"span",23),n(80,"FUNDA"),t(),e(81,"div",24),n(82),t()()()(),e(83,"div",15)(84,"div",25)(85,"span",26),n(86,"PATR\xD3N DE DESBLOQUEO:"),t(),e(87,"div",27),h(88,"div",28)(89,"div",28)(90,"div",28)(91,"div",28)(92,"div",28)(93,"div",28)(94,"div",28)(95,"div",28)(96,"div",28),t(),e(97,"span",29),n(98),t()(),e(99,"div",30)(100,"span",31),n(101,"PIN:"),t(),e(102,"span",18),n(103),t()()(),e(104,"div",32)(105,"div",16)(106,"span",33),n(107,"Diagn\xF3stico de reparaci\xF3n:"),t(),e(108,"span",34),n(109),t()(),e(110,"div",16)(111,"span",33),n(112,"Presupuesto:"),t(),e(113,"span",34),n(114),t()(),e(115,"div",16)(116,"span",33),n(117,"Se\xF1a:"),t(),e(118,"span",34),n(119),t()()(),e(120,"div",35)(121,"h4",36),n(122,"CONDICIONES DEL SERVICIO"),t(),e(123,"p"),n(124,"Se garantiza confidencialidad de datos. No nos responsabilizamos por p\xE9rdida de informaci\xF3n software."),t(),e(125,"p"),n(126,"Si el equipo no se retira en 30 d\xEDas, se considera abandonado (Art 2524/5 CC)."),t(),e(127,"p"),n(128,"La reparaci\xF3n demora 24-72hs para control de calidad."),t(),e(129,"p"),n(130,"El cliente declara conocer el estado est\xE9tico del equipo al entregarlo."),t()(),e(131,"div",37)(132,"div",38)(133,"div",39)(134,"div",40)(135,"div",41),n(136,"FIRMA CLIENTE"),t()(),e(137,"div",42)(138,"div",43)(139,"span"),n(140,"ACLARACI\xD3N: ........................"),t()(),e(141,"div",44)(142,"span"),n(143,"DNI: ........................"),t()()()()(),e(144,"div",45)(145,"div",41),n(146,"FIRMA T\xC9CNICO"),t()()()()),i&2){let a,o,k,A,P;l(3),f("",r.id?"Editar":"Nueva"," Reparaci\xF3n"),l(5),w(r.loading()?8:9),l(11),f(" ",I(20,22,r.date,"dd/MM/yyyy")),l(3),f("Tel: ",(a=r.company())==null?null:a.phone),l(2),x((o=r.company())==null?null:o.email),l(2),w((k=r.company())!=null&&k.logo_url?26:-1),l(2),x(((A=r.company())==null?null:A.name)||"ARECOFIX"),l(3),x((P=r.company())==null?null:P.address),l(6),x(r.form().customer_name),l(5),x(r.form().customer_phone),l(6),x(r.form().device_model),l(5),x(r.form().issue_description),l(9),f(" ",r.form().checklist.charger?"X":""," "),l(5),f(" ",r.form().checklist.battery?"X":""," "),l(5),f(" ",r.form().checklist.chip?"X":""," "),l(5),f(" ",r.form().checklist.sd?"X":""," "),l(5),f(" ",r.form().checklist.case?"X":""," "),l(16),x(r.form().security_pattern),l(5),x(r.form().security_pin),l(6),x(r.form().technician_notes),l(5),f("$ ",r.form().estimated_cost),l(5),f("$ ",r.form().deposit_amount)}},dependencies:[D,ee,H,Q,Z,q,Y,j,J,X,U,$,K,G,z,O,T],encapsulation:2})};export{te as AdminRepairFormPage};
