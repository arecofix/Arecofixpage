import{k as f,l as v}from"./chunk-GBGIQ7VE.js";import{a as h}from"./chunk-IP3FEPB3.js";import{C as g,R as m,V as b,W as l,k as o,l as i,r as p}from"./chunk-DX2LKEMG.js";var _=class u{constructor(r){this.authService=r;this.supabase=this.authService.getSupabaseClient()}supabase;logger=l(h);tenantService=l(f);processResponse(r,t,e){let a=t||r.length,n=e._per_page>0?e._per_page:a,s=Math.max(1,Math.ceil(a/(n||1)));return{first:1,prev:e._page>1?e._page-1:null,next:e._page<s?e._page+1:null,last:s,pages:s,items:a,data:r}}getData(r){let{_page:t=1,_per_page:e=10}=r,a=(t-1)*e,n=a+e-1;return o(this.supabase.from("categories").select("*",{count:"exact"}).eq("tenant_id",this.tenantService.getTenantId()).eq("is_active",!0).range(a,n)).pipe(p(({data:s,count:S,error:c})=>{if(c)throw c;return this.processResponse(s||[],S,{_page:t,_per_page:e})}),g(s=>(this.logger.error("Supabase Error:",s),i({first:1,prev:null,next:null,last:1,pages:1,items:0,data:[]}))))}getFeaturedData(){return o(this.supabase.from("categories").select("*",{count:"exact"}).eq("tenant_id",this.tenantService.getTenantId()).eq("is_active",!0).order("name").limit(100)).pipe(p(({data:e,count:a,error:n})=>{if(n)throw n;return this.processResponse(e||[],a,{_page:1,_per_page:100})}),g(e=>(this.logger.error("Supabase Error:",e),i({first:1,prev:null,next:null,last:1,pages:1,items:0,data:[]}))))}getDataBySlug(r){return o(this.supabase.from("categories").select("*").eq("tenant_id",this.tenantService.getTenantId()).ilike("slug",r).limit(1)).pipe(p(({data:t,error:e})=>{if(e)throw e;return this.processResponse(t||[],t?.length||0,{_page:1,_per_page:1})}),g(t=>(this.logger.error("Supabase Error:",t),i({first:1,prev:null,next:null,last:1,pages:1,items:0,data:[]}))))}getById(r){return!r||r==="null"||r==="0"?i(null):o(this.supabase.from("categories").select("*").eq("tenant_id",this.tenantService.getTenantId()).eq("id",r).single()).pipe(p(({data:t,error:e})=>{if(e)throw e;return t}),g(t=>(this.logger.error("Supabase Error:",t),i(null))))}getAll(){return o(this.supabase.from("categories").select("*").eq("tenant_id",this.tenantService.getTenantId()).eq("is_active",!0).order("name")).pipe(p(({data:r,error:t})=>{if(t)throw t;return r||[]}),g(r=>(this.logger.error("Supabase Error:",r),i([]))))}static \u0275fac=function(t){return new(t||u)(b(v))};static \u0275prov=m({token:u,factory:u.\u0275fac,providedIn:"root"})};export{_ as a};
