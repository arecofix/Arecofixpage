{
  "version": 3,
  "sources": ["src/app/admin/sales/admin-invoice-detail-page.ts", "src/app/admin/sales/admin-invoice-detail-page.html"],
  "sourcesContent": ["import { Component, inject, OnInit, signal } from '@angular/core';\r\nimport { CommonModule } from '@angular/common';\r\nimport { ActivatedRoute, RouterLink } from '@angular/router';\r\nimport { AuthService } from '@app/core/services/auth.service';\r\n\r\n@Component({\r\n    selector: 'app-admin-invoice-detail-page',\r\n    standalone: true,\r\n    imports: [CommonModule, RouterLink],\r\n    templateUrl: './admin-invoice-detail-page.html',\r\n})\r\nexport class AdminInvoiceDetailPage implements OnInit {\r\n    private route = inject(ActivatedRoute);\r\n    private auth = inject(AuthService);\r\n\r\n    invoice = signal<any>(null);\r\n    items = signal<any[]>([]);\r\n    company = signal<any>(null);\r\n    loading = signal(true);\r\n\r\n    error = signal('');\r\n    \r\n    async ngOnInit() {\r\n        const id = this.route.snapshot.paramMap.get('id');\r\n        const supabase = this.auth.getSupabaseClient();\r\n        \r\n        try {\r\n            // Fetch company settings\r\n            const { data: companyData } = await supabase.from('company_settings').select('*').maybeSingle();\r\n            if (companyData) {\r\n                this.company.set(companyData);\r\n            }\r\n\r\n            if (id) {\r\n                // Fetch invoice\r\n                const { data: invoice, error: invoiceError } = await supabase\r\n                    .from('invoices')\r\n                    .select('*, sales(*)')\r\n                    .eq('id', id)\r\n                    .single();\r\n\r\n                if (invoiceError) throw invoiceError;\r\n\r\n                if (invoice) {\r\n                    this.invoice.set(invoice);\r\n\r\n                    // Fetch items\r\n                    if (invoice.sales?.id) {\r\n                        const { data: items, error: itemsError } = await supabase\r\n                            .from('sale_items')\r\n                            .select('*, products(name)')\r\n                            .eq('sale_id', invoice.sales.id);\r\n                        \r\n                        if (itemsError) {\r\n                            console.error('Error fetching items:', itemsError);\r\n                            // Don't block page render on items error\r\n                        } else if (items) {\r\n                            this.items.set(items);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } catch (e: any) {\r\n            console.error('Error loading invoice:', e);\r\n            this.error.set(e.message || 'Error al cargar la factura');\r\n        } finally {\r\n            this.loading.set(false);\r\n        }\r\n    }\r\n\r\n    print() {\r\n        window.print();\r\n    }\r\n}\r\n", "<div class=\"print-container max-w-3xl mx-auto bg-white shadow-lg rounded-lg overflow-hidden my-8 print:shadow-none print:max-w-none print:w-full print:m-0 print:rounded-none text-gray-800\">\r\n    @if (loading()) {\r\n    <div class=\"p-8 text-center\">Cargando...</div>\r\n    } @else if (invoice()) {\r\n    <div class=\"p-8\">\r\n        <!-- Header -->\r\n        <div class=\"flex justify-between items-start mb-8\">\r\n            <div>\r\n                <h1 class=\"text-3xl font-bold text-gray-800\">Factura</h1>\r\n                <p class=\"text-gray-500 mt-1\">#{{ invoice().invoice_number || 'Borrador' }}</p>\r\n            </div>\r\n            <div class=\"text-right\">\r\n                @if (company()?.logo_url) {\r\n                <img [src]=\"company().logo_url\" alt=\"Logo\" class=\"h-16 mb-2 ml-auto object-contain\">\r\n                }\r\n                <div class=\"font-bold text-xl text-indigo-600\">{{ company()?.name || 'Arecofix' }}</div>\r\n                <p class=\"text-sm text-gray-500\">{{ company()?.location || 'Servicios Integrales' }}</p>\r\n                <p class=\"text-sm text-gray-500\">{{ company()?.address }}</p>\r\n                <p class=\"text-sm text-gray-500\">{{ company()?.phone }}</p>\r\n                <p class=\"text-sm text-gray-500\">{{ company()?.email }}</p>\r\n                @if (company()?.ruc) {\r\n                <p class=\"text-sm text-gray-500\">CUIT: {{ company()?.ruc }}</p>\r\n                }\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Info -->\r\n        <div class=\"grid grid-cols-2 gap-8 mb-8\">\r\n            <div>\r\n                <h3 class=\"font-bold text-gray-700 mb-2\">Facturar a:</h3>\r\n                <p>{{ invoice().customer_name || 'Consumidor Final' }}</p>\r\n                <p class=\"text-sm text-gray-500\">{{ invoice().customer_address }}</p>\r\n                <p class=\"text-sm text-gray-500\">{{ invoice().customer_dni_cuit }}</p>\r\n            </div>\r\n            <div class=\"text-right\">\r\n                <h3 class=\"font-bold text-gray-700 mb-2\">Detalles:</h3>\r\n                <p>Fecha: {{ invoice().issued_at | date:'shortDate' }}</p>\r\n                <p>Tipo: {{ invoice().type }}</p>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Items -->\r\n        <table class=\"w-full mb-8\">\r\n            <thead>\r\n                <tr class=\"border-b-2 border-gray-200 text-gray-800\">\r\n                    <th class=\"text-left py-3\">Descripci√≥n</th>\r\n                    <th class=\"text-center py-3\">Cant.</th>\r\n                    <th class=\"text-right py-3\">Precio Unit.</th>\r\n                    <th class=\"text-right py-3\">Subtotal</th>\r\n                </tr>\r\n            </thead>\r\n            <tbody>\r\n                @for (item of items(); track item.id) {\r\n                <tr class=\"border-b border-gray-100\">\r\n                    <td class=\"py-3\">{{ item.products?.name || 'Producto eliminado' }}</td>\r\n                    <td class=\"text-center py-3\">{{ item.quantity }}</td>\r\n                    <td class=\"text-right py-3\">${{ item.unit_price }}</td>\r\n                    <td class=\"text-right py-3\">${{ item.subtotal }}</td>\r\n                </tr>\r\n                }\r\n            </tbody>\r\n            <tfoot>\r\n                <tr>\r\n                    <td colspan=\"3\" class=\"text-right py-4 font-bold\">Total</td>\r\n                    <td class=\"text-right py-4 font-bold text-xl\">${{ invoice().total_amount }}</td>\r\n                </tr>\r\n            </tfoot>\r\n        </table>\r\n\r\n        <!-- Actions -->\r\n        <div class=\"flex justify-end gap-4 print:hidden\">\r\n            <a routerLink=\"/admin/invoices\" class=\"btn btn-ghost\">Volver</a>\r\n            <button (click)=\"print()\" class=\"btn btn-primary\">\r\n                <i class=\"fas fa-print mr-2\"></i> Imprimir\r\n            </button>\r\n        </div>\r\n    </div>\r\n    } @else {\r\n    <div class=\"p-8 text-center\">Factura no encontrada</div>\r\n    }\r\n</div>"],
  "mappings": "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",
  "names": []
}
