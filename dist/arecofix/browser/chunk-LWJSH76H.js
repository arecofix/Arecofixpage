import{a as re}from"./chunk-PFCMIZL2.js";import"./chunk-YSO73UTU.js";import{b as H,d as q,g as G,i as $,l as J,m as K,n as Q,o as U,s as X}from"./chunk-OLX46BM6.js";import{a as Y}from"./chunk-IP4OBPF4.js";import{a as Z}from"./chunk-BUXARFD3.js";import{a as ne}from"./chunk-DCQKJI4U.js";import{a as ee,c as te}from"./chunk-G24LN6BT.js";import{d as O}from"./chunk-LJXF2LKV.js";import{a as ie}from"./chunk-YDRYCRWB.js";import"./chunk-XABE7YIC.js";import"./chunk-FNOMVEKC.js";import{a as V}from"./chunk-UMKSLB7V.js";import"./chunk-WKJZXT3A.js";import"./chunk-6C55BXVK.js";import{a as j}from"./chunk-T7AXESXA.js";import{e as z,g as B}from"./chunk-CFVR47WG.js";import"./chunk-BPBGA3ZM.js";import{r as W}from"./chunk-E6PREHEQ.js";import{$b as A,Ab as S,Bb as w,Cb as E,Db as n,Eb as r,Fb as p,Lb as L,Pb as b,Rb as g,Xa as d,Xb as M,Z as u,Zb as a,_b as R,bc as y,ca as D,cc as h,da as F,dc as v,jb as N,pa as f,q as T,wb as x,xb as _,xc as P}from"./chunk-25C2KVON.js";import{a as C,c as I}from"./chunk-VOSPIT4N.js";var k=(o,e)=>e.id;function le(o,e){if(o&1){let i=L();n(0,"li")(1,"button",20),b("click",function(){let l=D(i).$implicit,s=g();return s.filterState.category=l.id,F(s.applyFilters())}),a(2),r()()}if(o&2){let i=e.$implicit,t=g();d(),M("text-blue-600",t.filterState.category===i.id)("font-semibold",t.filterState.category===i.id)("bg-blue-50",t.filterState.category===i.id),d(),A(" ",i.name," ")}}function se(o,e){if(o&1&&(n(0,"option",23),a(1),r()),o&2){let i=e.$implicit;E("value",i.id),d(),R(i.name)}}function de(o,e){if(o&1&&(a(0," Mostrando "),n(1,"span",45),a(2),r(),a(3," resultados ")),o&2){let i=g();d(2),R(i.productsRs.value().items)}}function pe(o,e){o&1&&a(0," Cargando... ")}function ce(o,e){o&1&&p(0,"is-loading")}function ge(o,e){if(o&1&&(n(0,"div",35)(1,"span"),a(2),r()()),o&2){let i=g();d(2),R(i.initError()||"Error al cargar productos.")}}function me(o,e){o&1&&p(0,"is-empty")}function ue(o,e){if(o&1&&p(0,"product-card",47),o&2){let i=e.$implicit,t=e.$index;E("product",i)("isPriority",t<12)}}function fe(o,e){if(o&1&&(n(0,"div",48),p(1,"pagination",49),r()),o&2){let i=g(3);d(),E("pages",i.productsRs.value().pages)("currentPage",i.paginationService.currentPage())}}function be(o,e){if(o&1&&(n(0,"div",46),S(1,ue,1,2,"product-card",47,k),r(),x(3,fe,2,2,"div",48)),o&2){let i=g(2);d(),w(i.productsRs.value().data),d(2),_(i.paginationData()?3:-1)}}function xe(o,e){if(o&1&&x(0,me,1,0,"is-empty")(1,be,4,1),o&2){let i=g();_(i.productsRs.value().data.length===0?0:1)}}var oe=class o{whatsappNumber=j.contact.whatsappNumber;router=u(B);route=u(z);categoryService=u(V);productService=u(ie);brandRepo=u(re);paginationService=u(Y);categories=f([]);brands=f([]);repuestosRootId=f(null);visibleCategories=P(()=>{let e=this.repuestosRootId();return e?this.categories().filter(i=>i.parent_id===e):[]});filterState={search:"",category:"all",category_ids:[],brand:"all",maxPrice:null,sort:"relevance"};isInitialized=f(!1);initError=f(null);activeFilter=f(C({},this.filterState));productsRs=O({stream:()=>{let e=this.activeFilter(),i=this.isInitialized(),t=this.paginationService.currentPage()||1;if(!i||e.category==="all"&&(!e.category_ids||e.category_ids.length===0))return T({data:[],items:0,pages:0,first:1,last:1,prev:void 0,next:void 0});let l={_page:t,_per_page:12};if(e.search&&(l.name=e.search),e.category!=="all"){let s=this.getAllChildIds(e.category,this.categories());l.category_ids=s}else l.category_ids=e.category_ids;return e.brand!=="all"&&(l.brand_id=e.brand),e.maxPrice&&(l.price=e.maxPrice),this.productService.getData(l)}});paginationData=P(()=>{let e=this.productsRs.value();if(!e)return null;let l=e,{data:i}=l;return I(l,["data"])});async ngOnInit(){await this.loadCategories(),await this.loadBrands()}async loadCategories(){this.categoryService.getData({_page:1,_per_page:500}).subscribe(e=>{let i=e.data;this.categories.set(i),console.log(`RepuestosPage: Loaded ${i.length} categories.`);let t=["repuesto","modulo","m\xF3dulo","bateria","bater\xEDa","display","screen","pantalla","glass","tapa","flex","pin","carga","auricular","microfono","micr\xF3fono","camara","c\xE1mara","lente","touch","vidrio","bandeja","sim","buzzer","speaker","altavoz","parlante","vibrador","sensor","boton","tecla","home","volumen","power"],l=i.filter(c=>t.some(m=>c.name.toLowerCase().includes(m)||c.slug.toLowerCase().includes(m))),s=i.find(c=>c.slug.toLowerCase()==="repuestos");if(!s&&l.length>0&&(s=l[0]),l.length>0){console.log(`RepuestosPage: Heuristic found ${l.length} relevant categories:`,l.map(m=>m.name));let c=new Set;l.forEach(m=>{c.add(m.id),this.getAllChildIds(m.id,i).forEach(ae=>c.add(ae))}),this.repuestosRootId.set(s?.id||null),this.filterState.category="all",this.filterState.category_ids=Array.from(c),this.activeFilter.set(C({},this.filterState)),this.isInitialized.set(!0),this.productsRs.reload()}else console.error("RepuestosPage: FATAL - No repuestos-related categories found via keywords!"),this.initError.set("No se encontraron categor\xEDas de repuestos."),this.isInitialized.set(!0)})}getAllChildIds(e,i){let t=[e];return i.filter(s=>s.parent_id===e).forEach(s=>{t=[...t,...this.getAllChildIds(s.id,i)]}),t}async loadBrands(){try{let e=await this.brandRepo.findAll({column:"name",ascending:!0});this.brands.set(e)}catch(e){console.error("Error loading brands",e)}}applyFilters(){this.activeFilter.set(C({},this.filterState)),this.router.navigate([],{relativeTo:this.route,queryParams:{_page:1},queryParamsHandling:"merge"})}goToHome(){this.router.navigate(["/"])}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=N({type:o,selectors:[["app-repuestos"]],decls:95,vars:12,consts:[[1,"relative","bg-gray-900","text-white","py-12","mb-8","overflow-hidden"],[1,"absolute","inset-0","opacity-20","bg-linear-to-r","from-blue-900","to-indigo-900"],[1,"absolute","top-0","right-0","-mr-20","-mt-20","w-64","h-64","rounded-full","bg-blue-500","opacity-10","blur-3xl"],[1,"absolute","bottom-0","left-0","-ml-20","-mb-20","w-64","h-64","rounded-full","bg-indigo-500","opacity-10","blur-3xl"],[1,"relative","container","mx-auto","px-4"],[1,"max-w-3xl"],[1,"text-sm","breadcrumbs","text-gray-300","mb-4"],["routerLink","/"],["routerLink","/products"],[1,"font-semibold","text-white"],[1,"text-4xl","md:text-5xl","font-bold","mb-4","tracking-tight"],[1,"text-lg","text-gray-300","max-w-2xl","leading-relaxed"],[1,"container","mx-auto","px-4","pb-16"],[1,"flex","flex-col","lg:flex-row","gap-8"],[1,"hidden","lg:block","w-64","shrink-0"],[1,"sticky","top-24","space-y-8"],[1,"bg-white","dark:bg-gray-800","rounded-xl","shadow-sm","border","border-gray-100","dark:border-gray-700","p-6"],[1,"font-bold","text-gray-900","dark:text-white","mb-4","text-lg"],["type","text","placeholder","Ej: Pantalla iPhone 12",1,"w-full","rounded-lg","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-600",3,"ngModelChange","ngModel"],[1,"space-y-2"],[1,"w-full","text-left","block","px-3","py-2","rounded-lg","text-gray-600","dark:text-gray-300","hover:bg-gray-50","dark:hover:bg-gray-700","hover:text-blue-600","transition-colors",3,"click"],[1,"w-full","rounded-lg","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-600",3,"ngModelChange","ngModel"],["value","all"],[3,"value"],[1,"space-y-4"],["type","number","min","0","placeholder","Ej: 20000",1,"w-full","rounded-lg","border","border-gray-300","dark:border-gray-600","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","px-3","py-2","focus:outline-none","focus:ring-2","focus:ring-blue-600",3,"ngModelChange","ngModel"],[1,"flex-1"],[1,"flex","flex-wrap","items-center","justify-between","mb-6","bg-white","dark:bg-gray-800","p-4","rounded-xl","shadow-sm","border","border-gray-100","dark:border-gray-700"],[1,"text-gray-600","dark:text-gray-300"],[1,"flex","items-center","gap-4"],[1,"select","select-bordered","select-sm","w-full","max-w-xs","bg-white","dark:bg-gray-700","text-gray-900","dark:text-white","border-gray-300","dark:border-gray-600",3,"ngModelChange","ngModel"],["value","relevance"],["value","price-asc"],["value","price-desc"],["value","rating-desc"],[1,"alert","alert-error"],[1,"py-16","bg-indigo-900","text-white","mt-8"],[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-8","text-center"],[1,"fas","fa-shipping-fast","text-5xl","mb-4","text-indigo-300"],[1,"text-xl","font-bold","mb-2"],[1,"text-indigo-200"],[1,"fas","fa-shield-check","text-5xl","mb-4","text-indigo-300"],[1,"fas","fa-tags","text-5xl","mb-4","text-indigo-300"],[1,"fas","fa-headset","text-5xl","mb-4","text-indigo-300"],[1,"font-semibold","text-gray-900","dark:text-white"],[1,"grid","grid-cols-1","sm:grid-cols-2","lg:grid-cols-3","xl:grid-cols-4","gap-6"],[3,"product","isPriority"],[1,"mt-12","flex","justify-center"],[3,"pages","currentPage"]],template:function(i,t){i&1&&(n(0,"div",0),p(1,"div",1)(2,"div",2)(3,"div",3),n(4,"div",4)(5,"div",5)(6,"div",6)(7,"ul")(8,"li")(9,"a",7),a(10,"Inicio"),r()(),n(11,"li")(12,"a",8),a(13,"Productos"),r()(),n(14,"li",9),a(15,"Repuestos"),r()()(),n(16,"h1",10),a(17," Repuestos para Celulares "),r(),n(18,"p",11),a(19," Los mejores repuestos originales y compatibles para tu dispositivo. "),r()()()(),n(20,"div",12)(21,"div",13)(22,"aside",14)(23,"div",15)(24,"div",16)(25,"h3",17),a(26,"Buscar"),r(),n(27,"input",18),v("ngModelChange",function(s){return h(t.filterState.search,s)||(t.filterState.search=s),s}),b("ngModelChange",function(){return t.applyFilters()}),r()(),n(28,"div",16)(29,"h3",17),a(30,"Categor\xEDas"),r(),n(31,"ul",19)(32,"li")(33,"button",20),b("click",function(){return t.filterState.category="all",t.applyFilters()}),a(34," Todas "),r()(),S(35,le,3,7,"li",null,k),r()(),n(37,"div",16)(38,"h3",17),a(39,"Marcas"),r(),n(40,"select",21),v("ngModelChange",function(s){return h(t.filterState.brand,s)||(t.filterState.brand=s),s}),b("ngModelChange",function(){return t.applyFilters()}),n(41,"option",22),a(42,"Todas"),r(),S(43,se,2,2,"option",23,k),r()(),n(45,"div",16)(46,"h3",17),a(47,"Precio M\xE1ximo"),r(),n(48,"div",24)(49,"input",25),v("ngModelChange",function(s){return h(t.filterState.maxPrice,s)||(t.filterState.maxPrice=s),s}),b("ngModelChange",function(){return t.applyFilters()}),r()()()()(),n(50,"main",26)(51,"div",27)(52,"div",28),x(53,de,4,1)(54,pe,1,0),r(),n(55,"div",29)(56,"select",30),v("ngModelChange",function(s){return h(t.filterState.sort,s)||(t.filterState.sort=s),s}),b("ngModelChange",function(){return t.applyFilters()}),n(57,"option",31),a(58,"Relevancia"),r(),n(59,"option",32),a(60,"Precio: menor a mayor"),r(),n(61,"option",33),a(62,"Precio: mayor a menor"),r(),n(63,"option",34),a(64,"Mejor valoraci\xF3n"),r()()()(),x(65,ce,1,0,"is-loading")(66,ge,3,1,"div",35)(67,xe,2,1),r()()(),n(68,"section",36)(69,"div",37)(70,"div",38)(71,"div"),p(72,"i",39),n(73,"h3",40),a(74,"Env\xEDo R\xE1pido"),r(),n(75,"p",41),a(76,"Entregas en 24-48 horas"),r()(),n(77,"div"),p(78,"i",42),n(79,"h3",40),a(80,"Garant\xEDa"),r(),n(81,"p",41),a(82,"Todos los repuestos con garant\xEDa"),r()(),n(83,"div"),p(84,"i",43),n(85,"h3",40),a(86,"Mejores Precios"),r(),n(87,"p",41),a(88,"Precios mayoristas disponibles"),r()(),n(89,"div"),p(90,"i",44),n(91,"h3",40),a(92,"Asesoramiento"),r(),n(93,"p",41),a(94,"Soporte t\xE9cnico incluido"),r()()()()()),i&2&&(d(27),y("ngModel",t.filterState.search),d(6),M("text-blue-600",t.filterState.category==="all")("font-semibold",t.filterState.category==="all")("bg-blue-50",t.filterState.category==="all"),d(2),w(t.visibleCategories()),d(5),y("ngModel",t.filterState.brand),d(3),w(t.brands()),d(6),y("ngModel",t.filterState.maxPrice),d(4),_(t.productsRs.hasValue()?53:54),d(3),y("ngModel",t.filterState.sort),d(9),_(!t.isInitialized()||t.productsRs.isLoading()?65:t.productsRs.error()||t.initError()?66:t.productsRs.hasValue()?67:-1))},dependencies:[W,X,K,Q,H,$,J,q,U,G,ee,te,ne,Z],encapsulation:2})};export{oe as RepuestosComponent};
