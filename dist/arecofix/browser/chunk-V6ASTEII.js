import{a as m}from"./chunk-5GJFSCEY.js";import{S as n,X as l}from"./chunk-JAGY3XSL.js";import{a as r,b as o}from"./chunk-VOSPIT4N.js";var c=class i{auth=l(m);supabase=this.auth.getSupabaseClient();async getPosts(){let{data:a,error:e}=await this.supabase.from("blog_posts").select("*").order("created_at",{ascending:!1});if(e)throw e;return(a||[]).map(t=>o(r({},t),{image:t.featured_image||t.image||t.image_url}))}async getPost(a){let{data:e,error:t}=await this.supabase.from("blog_posts").select("*").eq("id",a).single();if(t)throw t;return o(r({},e),{image:e.featured_image||e.image||e.image_url})}async createPost(a){let e=r({},a);e.image&&(e.featured_image=e.image,delete e.image),delete e.meta_title,delete e.meta_description,delete e.published;let{error:t}=await this.supabase.from("blog_posts").insert(e);if(t)throw t}async updatePost(a,e){let t=r({},e);t.image&&(t.featured_image=t.image,delete t.image),delete t.meta_title,delete t.meta_description,delete t.published;let{error:s}=await this.supabase.from("blog_posts").update(t).eq("id",a);if(s)throw s}async deletePost(a){let{error:e}=await this.supabase.from("blog_posts").delete().eq("id",a);if(e)throw e}async uploadImage(a){let e=`posts/${Date.now()}-${a.name}`,{data:t,error:s}=await this.supabase.storage.from("public-assets").upload(e,a);if(s)throw s;let{data:d}=this.supabase.storage.from("public-assets").getPublicUrl(t.path);return d.publicUrl}slugify(a){return a.toString().toLowerCase().trim().replace(/\s+/g,"-").replace(/&/g,"-and-").replace(/[^a-z0-9-]/g,"").replace(/-+/g,"-")}static \u0275fac=function(e){return new(e||i)};static \u0275prov=n({token:i,factory:i.\u0275fac,providedIn:"root"})};export{c as a};
